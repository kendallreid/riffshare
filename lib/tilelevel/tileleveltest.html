<!DOCTYPE html>
<html lang="en">
	<head>
		<title>tileleveltest</title>
		<meta charset="utf-8">
		<script src="tilelevelinit.js"></script>
		<script src="tilelevelinput.js"></script>
		<script src="tilelevellazy.js"></script>
		<script src="tilelevellayout.js"></script>
		<script src="tilelevelspot.js"></script>
		<script src="tilelevelrender.js"></script>
		<style>
			
		</style>
	</head>
	<body>
		<h1>Test</h1>
		<svg id="contentSVG" width="800" height="400">
			<circle cx="1000" cy="1000" r="1000" stroke="black" stroke-width="3" fill="red" />
			<circle cx="400" cy="200" r="350" stroke="black" stroke-width="3" fill="green" />
			<circle cx="400" cy="200" r="200" stroke="black" stroke-width="3" fill="blue" />
			<circle cx="400" cy="200" r="20" stroke="black" stroke-width="3" fill="silver" />
			<g id='cntnt'></g>
			
			
			
			
			
			
			<g
     id="g1876"
     transform="matrix(1.010278,0,0,1.010278,-24.38602,-0.986803)">
    <path
       sodipodi:nodetypes="cssssssssscsssssssssc"
       id="path1947"
       d="M 39.708934,63.678683 C 39.317094,65.77065 41.499606,70.115061 45.890584,70.256984 C 51.19892,70.428558 54.590321,66.367906 53.010333,59.740875 L 45.086538,23.171517 C 44.143281,18.81826 44.851281,16.457097 45.354941,15.049945 C 46.698676,11.295749 50.055822,9.7473042 50.873134,10.949208 C 51.339763,11.635413 52.468042,14.844006 49.256275,20.590821 C 46.751378,25.072835 35.096985,30.950138 34.2417,41.468011 C 33.501282,50.614249 43.075689,57.369301 51.339266,54.71374 C 56.825686,52.950639 59.653965,44.62402 56.258057,40.328987 C 47.29624,28.994371 32.923702,46.341263 46.846564,51.0935 C 45.332604,49.90238 44.300646,48.980054 44.1085,47.852721 C 42.237755,36.876941 58.741182,39.774741 54.294493,50.18735 C 52.466001,54.469045 45.080341,55.297323 40.874269,51.477433 C 37.350853,48.277521 35.787387,42.113231 39.708327,37.687888 C 45.018831,31.694223 51.288782,26.31366 52.954064,18.108736 C 54.923313,8.4061491 48.493821,0.84188926 44.429027,10.385835 C 43.065093,13.588288 42.557016,16.803074 43.863006,22.963534 L 51.780549,60.311215 C 52.347386,62.985028 51.967911,66.664419 49.472374,68.355474 C 48.236187,69.193154 43.861784,69.769668 42.791575,67.770092"
       style="fill:black;fill-opacity:1;fill-rule:nonzero;stroke:black;stroke-width:0.1;stroke-linecap:butt;stroke-linejoin:miter;stroke-miterlimit:4;stroke-dasharray:none;stroke-opacity:1" />
    <path
       transform="matrix(-1.08512,-2.036848e-2,2.036848e-2,-1.08512,90.68868,135.0572)"
       d="M 48.24903 64.584198 A 3.439605 3.4987047 0 1 1  41.36982,64.584198 A 3.439605 3.4987047 0 1 1  48.24903 64.584198 z"
       sodipodi:ry="3.4987047"
       sodipodi:rx="3.439605"
       sodipodi:cy="64.584198"
       sodipodi:cx="44.809425"
       id="path4608"
       style="fill:black;fill-opacity:1;stroke:black;stroke-width:0.09213948;stroke-miterlimit:4;stroke-dasharray:none;stroke-opacity:1"
       sodipodi:type="arc" />
  </g>
		<g>
 
  <path fill="#ff0000" d="m110.9375,51.9375l0,74.0625c-1.8746,-2.54288 -9.75858,-4.19761 -16.5625,0.15625c-6.80392,4.35387 -10.88851,11.63438 -8.53125,15.9375c2.69075,4.91189 11.63561,7.54103 18.75,2.4375c5.14477,-3.69062 7.6185,-8.43281 8.40625,-9.84375l0,-44.65625c19.07989,11.65776 29.43114,14.99129 19.8125,41.3125c18.37612,-28.07754 -4.53773,-31.76748 -19.8125,-59.3125l0,-2.09375c25.86683,13.11825 20.67706,25.39142 23,32.125c6.43454,-26.9607 -16.65994,-29.68673 -23,-48.8125l0,-1.15625l-2.0625,-0.15625z" id="path2991"/>
 </g>	
	
    <path2
       d="m 113.13433,900.47269 0,83.14019"
       id="path3821"
       style="fill:none;stroke:#000000;stroke-width:1.95333612px;stroke-linecap:butt;stroke-linejoin:miter;stroke-opacity:1" />
    <path
       d="m 153.03812,108.7706 a 11.237947,7.3223042 0 1 1 -0.33175,-1.76601"
       transform="matrix(1.2477873,-0.63522684,0.59622185,1.3694102,-142.33379,929.29558)"
       id="path3827"
       style="fill-opacity:1;stroke:#000000;stroke-width:0;stroke-miterlimit:4;stroke-opacity:0.26666667;stroke-dasharray:none" />
			
			
			
			
			
			
			
			
			
		</svg>
		<p>Another</p>
		<svg id="SVG2" width="90%" height="300px">
			<circle cx="0" cy="0" r="340" stroke="black" stroke-width="3" fill="green" />
			<circle cx="2000" cy="0" r="490" stroke="black" stroke-width="3" fill="blue" />
			<circle cx="2000" cy="2000" r="140" stroke="black" stroke-width="3" fill="red" />
			<circle cx="0" cy="2000" r="240" stroke="black" stroke-width="3" fill="brown" />
			<circle cx="500" cy="500" r="70" stroke="black" stroke-width="3" fill="silver" />
			<g id='anothr'></g>
		</svg>
		<script>
			console.log('start');
			var a1=new TileLevel("contentSVG",'cntnt');
			var scnd=new TileLevel("SVG2",'anothr');
			
			a1.resetInnerSize(4000,3000);
			scnd.resetInnerSize(2000,2000);
			
			var bg=a1.addLayer();
			var mdl=a1.addLayer();
			var fg=a1.addLayer();
			a1.addZoomLevel(5,function(left, top, width, height){
				console.log('render',5);
				var x = a1.tapSize * 7;
				var y = a1.tapSize * 3;
				var w = a1.tapSize * 40;
				var h = a1.tapSize * 10;
				var g = a1.rakeGroup(x, y, w, h, 'tstre', bg, left, top, width, height);
				if (g) {
					a1.tileRectangle(g, x, y, w, h, '#f96');
				}
			});
			a1.addZoomLevel(50,function(left, top, width, height){
				console.log('render',50);
				var x = a1.tapSize * 7;
				var y = a1.tapSize * 3;
				var w = a1.tapSize * 40;
				var h = a1.tapSize * 10;
				var g = a1.rakeGroup(x, y, w, h, 'tstre', bg, left, top, width, height);
				if (g) {
					a1.tileRectangle(g, x, y, w, h, '#ff6');
					a1.addSpot('b50', x, y, w, h, function () {
						console.log('spot b50');
						a1.startSlideTo(x,y,13);
					},false,false);
				}
			});
			a1.addZoomLevel(12,function(left, top, width, height){
				console.log('render',12);
				var x = a1.tapSize * 7;
				var y = a1.tapSize * 3;
				var w = a1.tapSize * 40;
				var h = a1.tapSize * 10;
				var g = a1.rakeGroup(x, y, w, h, 'tstre', bg, left, top, width, height);
				if (g) {
					a1.tileRectangle(g, x, y, w, h, '#f9f');
					
				}
				
			});
			//console.log(a1.renderers);
			var sng = scnd.addLayer();
			var loVer = scnd.addLayer(true);
			var loHor = scnd.addLayer(false, true);
			function addGclef(tl,g,x,y,size,color){
				var r=size*tl.tapSize/90;
				tl.tilePath(g, x-55*r,y-865*r,r
					, "M 104.549,964.001 C 101.96,964.846 99.8204,966.272 98.13,968.28 96.4394,970.287 95.4093,972.48 95.0395,974.857 94.6697,977.234 94.9735,979.585 95.9508,981.909 96.9281,984.234 98.7639,986.109 101.458,987.536 102.092,987.536 102.488,987.8 102.647,988.328 102.805,988.856 102.567,989.12 101.934,989.12 99.345,988.592 97.0734,987.509 95.1188,985.872 91.4736,982.86 89.4662,978.978 89.0964,974.223 88.8851,971.846 89.1096,969.548 89.77,967.329 90.4303,965.11 91.3416,963.076 92.5038,961.227 93.9301,959.273 95.6206,957.582 97.5753,956.156 97.6809,956.05 97.9847,955.813 98.4865,955.443 98.9884,955.073 99.477,954.73 99.9525,954.413 100.428,954.096 101.141,953.594 102.092,952.907 L 99.1601,938.802 C 96.5715,940.968 94.0094,943.358 91.4737,945.973 88.9379,948.588 86.6399,951.349 84.5796,954.254 82.5194,957.16 80.8685,960.237 79.627,963.486 78.3856,966.735 77.7649,970.155 77.7649,973.748 77.7649,977.076 78.4648,980.206 79.8648,983.138 81.2647,986.07 83.1269,988.619 85.4513,990.784 87.7757,992.95 90.4567,994.654 93.4943,995.896 96.5319,997.137 99.6091,997.758 102.726,997.758 102.832,997.758 103.32,997.705 104.192,997.599 105.064,997.494 105.988,997.362 106.965,997.203 107.943,997.045 108.841,996.873 109.66,996.688 110.478,996.503 110.888,996.305 110.888,996.094 L 110.412,993.875 C 108.352,983.468 106.397,973.51 104.549,964.001 z M 107.322,963.684 113.82,995.143 C 117.571,993.716 120.106,991.273 121.427,987.813 122.748,984.353 123.051,980.84 122.338,977.274 121.625,973.708 119.948,970.551 117.306,967.804 114.665,965.057 111.337,963.684 107.322,963.684 z M 99.0016,921.29 C 100.639,920.444 102.158,919.177 103.558,917.486 104.958,915.796 106.252,913.986 107.441,912.058 108.629,910.13 109.66,908.162 110.531,906.154 111.403,904.147 112.103,902.325 112.631,900.687 113.212,898.944 113.608,896.989 113.82,894.823 114.031,892.657 113.688,890.835 112.79,889.355 112.156,888.035 111.324,887.269 110.294,887.057 109.263,886.846 108.233,886.925 107.203,887.295 106.173,887.665 105.196,888.259 104.271,889.078 103.347,889.897 102.673,890.623 102.251,891.257 101.088,893.317 100.071,895.615 99.1997,898.151 98.328,900.687 97.7337,903.315 97.4168,906.036 97.0998,908.756 97.0602,911.371 97.2979,913.881 97.5356,916.39 98.1035,918.86 99.0016,921.29 z M 96.6244,923.746 C 95.7263,920.26 94.9339,916.839 94.2471,913.484 93.5603,910.13 93.217,906.683 93.217,903.143 93.217,900.555 93.4019,897.715 93.7717,894.625 94.1414,891.535 94.815,888.523 95.7923,885.591 96.7696,882.659 98.1167,880.031 99.8336,877.707 101.551,875.382 103.835,873.692 106.688,872.635 106.952,872.53 107.216,872.477 107.48,872.477 107.85,872.477 108.286,872.688 108.788,873.111 109.29,873.533 109.818,874.154 110.373,874.973 110.927,875.792 111.416,876.637 111.839,877.509 112.261,878.38 112.578,878.975 112.79,879.292 114.216,881.986 115.259,884.852 115.92,887.889 116.58,890.927 116.963,893.951 117.069,896.962 117.28,901.506 117.029,905.996 116.316,910.434 115.603,914.871 114.163,919.203 111.997,923.429 111.258,924.697 110.505,925.978 109.739,927.272 108.973,928.567 108.062,929.821 107.005,931.036 106.794,931.248 106.411,931.631 105.856,932.185 105.301,932.74 104.733,933.308 104.152,933.889 103.571,934.47 103.056,935.012 102.607,935.513 102.158,936.015 101.934,936.319 101.934,936.425 L 105.182,952.273 C 105.203,952.377 106.807,952.273 106.807,952.273 109.907,952.312 113.189,952.814 116.039,953.937 118.786,955.205 121.15,956.948 123.131,959.167 125.112,961.386 126.696,963.882 127.885,966.655 129.074,969.429 129.668,972.242 129.668,975.095 129.668,977.947 129.245,980.853 128.4,983.811 126.234,989.411 122.774,993.558 118.02,996.252 117.491,996.569 116.738,996.926 115.761,997.322 114.784,997.718 114.401,998.339 114.612,999.184 115.88,1004.94 116.738,1008.9 117.188,1011.07 117.637,1013.24 117.967,1016.04 118.178,1019.47 118.389,1022.75 117.821,1025.7 116.474,1028.34 115.127,1030.99 113.318,1033.14 111.046,1034.8 108.775,1036.47 106.701,1037.44 104.826,1037.74 102.95,1038.03 101.669,1038.17 100.983,1038.17 98.6054,1038.17 96.281,1037.72 94.0094,1036.82 91.2095,1035.77 88.8587,1034.16 86.9569,1031.99 85.0551,1029.82 84.1042,1027.18 84.1042,1024.07 84.1042,1022.11 84.6721,1020.1 85.8079,1018.04 86.9437,1015.98 88.4361,1014.5 90.285,1013.61 92.3453,1012.55 94.2075,1012.26 95.8716,1012.73 97.5356,1013.21 98.9091,1014.11 99.9921,1015.43 101.075,1016.75 101.828,1018.35 102.251,1020.22 102.673,1022.1 102.647,1023.85 102.171,1025.49 101.696,1027.13 100.732,1028.52 99.279,1029.65 97.8262,1030.79 95.8055,1031.3 93.217,1031.2 94.2735,1033.1 95.7527,1034.3 97.6545,1034.8 99.5563,1035.31 101.511,1035.34 103.518,1034.92 105.526,1034.5 107.414,1033.72 109.184,1032.58 110.954,1031.45 112.341,1030.22 113.344,1028.9 113.978,1027.95 114.454,1026.71 114.771,1025.18 115.088,1023.64 115.273,1022.05 115.325,1020.38 115.378,1018.72 115.325,1017.42 115.167,1016.5 115.008,1015.57 114.744,1014.13 114.374,1012.18 112.79,1005.79 111.786,1001.77 111.363,1000.13 111.152,999.607 110.584,999.435 109.66,999.62 108.735,999.805 107.956,999.977 107.322,1000.13 102.779,1000.72 98.9752,1000.45 95.9112,999.343 91.1567,998.075 86.9701,995.816 83.3514,992.567 79.7327,989.319 76.8272,985.383 74.6348,980.76 72.4425,976.138 71.3463,972.625 71.3463,970.221 71.3463,967.818 71.3463,966.299 71.3463,965.665 71.3463,961.386 72.0859,957.371 73.5651,953.62 76.3649,947.756 79.6799,942.368 83.5099,937.455 87.3399,932.542 91.7114,927.972 96.6244,923.746 z"
					,color);//,'#0ff',0.2);
				//tl.tilePath(g, x-size*tl.tapSize * 0.905,y-size*tl.tapSize * 0.165,size*tl.tapSize * 0.03
				//	, "M 48.24903 64.584198 A 3.439605 3.4987047 0 1 1  41.36982,64.584198 A 3.439605 3.4987047 0 1 1  48.24903 64.584198 z"
				//	,color);//,'#0ff',0.2);
			}
			function addFclef(tl,g,x,y,size,color){
				var r=size*tl.tapSize/90;
				tl.tilePath(g, x-55*r,y-35*r,r
					, "M 62.511677,127.84048 c 0,-0.83977 4.041963,-4.29526 8.982141,-7.67885 10.621365,-7.27471 18.291956,-15.2339 22.753427,-23.609504 10.231245,-19.207279 6.990215,-39.234197 -6.645392,-41.063116 -7.541825,-1.01157 -17.090176,4.491435 -17.090176,9.84959 0,1.98778 0.508501,2.147884 6.037438,1.900912 6.764925,-0.302182 11.341654,6.282702 7.680759,11.050886 -5.784567,7.53419 -19.718197,3.205925 -19.718197,-6.12515 0,-8.178104 4.976735,-14.686661 13.736031,-17.963933 18.744999,-7.013402 36.588252,5.915889 35.025872,25.379878 -1.28058,15.953347 -15.170703,30.852697 -42.135847,45.197347 -6.39814,3.40362 -8.626056,4.19445 -8.626056,3.06194 z"
					,color);//,'#0ff',0.2);
			}
			var loBoth = scnd.addLayer(true, true);
			scnd.addZoomLevel(14, function (left, top, width, height) {
				console.log('render2-14', left, top, width, height,scnd.innerWidth);
				var g = scnd.rakeGroup(0, 0, scnd.innerWidth, scnd.innerHeight, 'bg2r', sng, left, top, width, height);
				if (g) {
					scnd.tileRectangle(g, 0, 0, scnd.innerWidth, scnd.innerHeight, '#222');
					scnd.tileRectangle(g, scnd.tapSize * 13, scnd.tapSize * 0.5, scnd.tapSize * 6, scnd.tapSize * 12, '#369');
					addFclef(scnd,g,scnd.tapSize * 13, scnd.tapSize * 0.5,6,'#f0f');
				}
				var x = scnd.tapSize * 7;
				var y = scnd.tapSize * 3;
				var w = scnd.tapSize * 5;
				var h = scnd.tapSize * 9;
				g = scnd.rakeGroup(x, y, w, h, 't2s', sng, left, top, width, height);
				if (g) {
					scnd.tileRectangle(g, x, y, w, h, '#096');
				}
				scnd.addSpot('plybt', x, y, w, h, function () {
					console.log('spot click');
				},false,false,1.4);
				g = scnd.rakeGroup(scnd.tapSize * 2, scnd.tapSize * 1, scnd.tapSize * 2, scnd.tapSize * 1, 'verlo', loVer, left, top, width, height);
				if (g) {
					scnd.tileRectangle(g, scnd.tapSize * 2, scnd.tapSize * 1, scnd.tapSize * 2, scnd.tapSize * 1, '#f00');
				}
				g = scnd.rakeGroup(scnd.tapSize * 5, scnd.tapSize * 2, scnd.tapSize * 1, scnd.tapSize * 2, 'horlo', loHor, left, top, width, height);
				if (g) {
					scnd.tileRectangle(g, scnd.tapSize * 5, scnd.tapSize * 2, scnd.tapSize * 1, scnd.tapSize * 2, 'rgba(0,0,255,0.5)');
				}
				g = scnd.rakeGroup(scnd.tapSize * 3, scnd.tapSize * 5, scnd.tapSize * 1, scnd.tapSize * 1, 'bolo', loBoth, left, top, width, height);
				//console.log(g,a1);
				if (g) {
					scnd.tileRectangle(g, scnd.tapSize * 3, scnd.tapSize * 5, scnd.tapSize * 1, scnd.tapSize * 1, '#999');
					
				}
				scnd.addSpot('svlo', scnd.tapSize * 2, scnd.tapSize * 1, scnd.tapSize * 2, scnd.tapSize * 1, function () {
					console.log('svlo click');
				},true);
				scnd.addSpot('shlo',scnd.tapSize * 5, scnd.tapSize * 2, scnd.tapSize * 1, scnd.tapSize * 2, function () {
					console.log('shlo click');
				},false,true);
				scnd.addSpot('blo',scnd.tapSize * 3, scnd.tapSize * 5, scnd.tapSize * 1, scnd.tapSize * 1, function () {
					console.log('blo click');
				},true,true,10);
				window.onresize = function () {
					scnd.resetSize(); 
				};
			});
			console.log('done');
		</script>
	</body>
</html>
