!function(t){var e={};function r(n){if(e[n])return e[n].exports;var i=e[n]={i:n,l:!1,exports:{}};return t[n].call(i.exports,i,i.exports,r),i.l=!0,i.exports}r.m=t,r.c=e,r.d=function(t,e,n){r.o(t,e)||Object.defineProperty(t,e,{enumerable:!0,get:n})},r.r=function(t){"undefined"!=typeof Symbol&&Symbol.toStringTag&&Object.defineProperty(t,Symbol.toStringTag,{value:"Module"}),Object.defineProperty(t,"__esModule",{value:!0})},r.t=function(t,e){if(1&e&&(t=r(t)),8&e)return t;if(4&e&&"object"==typeof t&&t&&t.__esModule)return t;var n=Object.create(null);if(r.r(n),Object.defineProperty(n,"default",{enumerable:!0,value:t}),2&e&&"string"!=typeof t)for(var i in t)r.d(n,i,function(e){return t[e]}.bind(null,i));return n},r.n=function(t){var e=t&&t.__esModule?function(){return t.default}:function(){return t};return r.d(e,"a",e),e},r.o=function(t,e){return Object.prototype.hasOwnProperty.call(t,e)},r.p="http://127.0.0.1:8080/ministudiolib/",r(r.s=260)}([function(t,e,r){"use strict";function n(t){if(!Array.isArray(t))throw new Error("input must be an array");if(0===t.length)throw new Error("input must not be empty");for(var e=t[0],r=1;r<t.length;r++)t[r]>e&&(e=t[r]);return e}function i(t,e={}){if(!Array.isArray(t))throw new TypeError("input must be an array");if(0===t.length)throw new TypeError("input must not be empty");let r;if(void 0!==e.output){if(!Array.isArray(e.output))throw new TypeError("output option must be an array if specified");r=e.output}else r=new Array(t.length);const i=function(t){if(!Array.isArray(t))throw new Error("input must be an array");if(0===t.length)throw new Error("input must not be empty");for(var e=t[0],r=1;r<t.length;r++)t[r]<e&&(e=t[r]);return e}(t),o=n(t);if(i===o)throw new RangeError("minimum and maximum input values are equal. Cannot rescale a constant array");const{min:s=(e.autoMinMax?i:0),max:a=(e.autoMinMax?o:1)}=e;if(s>=a)throw new RangeError("min option must be smaller than max option");const u=(a-s)/(o-i);for(var h=0;h<t.length;h++)r[h]=(t[h]-i)*u+s;return r}r.r(e);class o{constructor(t){var e,r,n,i,o,s,a,u,h,c=(t=F.checkMatrix(t)).clone(),l=c.rows,f=c.columns,p=new Array(l),m=1;for(e=0;e<l;e++)p[e]=e;for(u=new Array(l),r=0;r<f;r++){for(e=0;e<l;e++)u[e]=c.get(e,r);for(e=0;e<l;e++){for(h=Math.min(e,r),o=0,n=0;n<h;n++)o+=c.get(e,n)*u[n];u[e]-=o,c.set(e,r,u[e])}for(i=r,e=r+1;e<l;e++)Math.abs(u[e])>Math.abs(u[i])&&(i=e);if(i!==r){for(n=0;n<f;n++)s=c.get(i,n),c.set(i,n,c.get(r,n)),c.set(r,n,s);a=p[i],p[i]=p[r],p[r]=a,m=-m}if(r<l&&0!==c.get(r,r))for(e=r+1;e<l;e++)c.set(e,r,c.get(e,r)/c.get(r,r))}this.LU=c,this.pivotVector=p,this.pivotSign=m}isSingular(){for(var t=this.LU,e=t.columns,r=0;r<e;r++)if(0===t[r][r])return!0;return!1}solve(t){t=O.checkMatrix(t);var e=this.LU;if(e.rows!==t.rows)throw new Error("Invalid matrix dimensions");if(this.isSingular())throw new Error("LU matrix is singular");var r,n,i,o=t.columns,s=t.subMatrixRow(this.pivotVector,0,o-1),a=e.columns;for(i=0;i<a;i++)for(r=i+1;r<a;r++)for(n=0;n<o;n++)s[r][n]-=s[i][n]*e[r][i];for(i=a-1;i>=0;i--){for(n=0;n<o;n++)s[i][n]/=e[i][i];for(r=0;r<i;r++)for(n=0;n<o;n++)s[r][n]-=s[i][n]*e[r][i]}return s}get determinant(){var t=this.LU;if(!t.isSquare())throw new Error("Matrix must be square");for(var e=this.pivotSign,r=t.columns,n=0;n<r;n++)e*=t[n][n];return e}get lowerTriangularMatrix(){for(var t=this.LU,e=t.rows,r=t.columns,n=new O(e,r),i=0;i<e;i++)for(var o=0;o<r;o++)n[i][o]=i>o?t[i][o]:i===o?1:0;return n}get upperTriangularMatrix(){for(var t=this.LU,e=t.rows,r=t.columns,n=new O(e,r),i=0;i<e;i++)for(var o=0;o<r;o++)n[i][o]=i<=o?t[i][o]:0;return n}get pivotPermutationVector(){return this.pivotVector.slice()}}function s(t,e){var r=0;return Math.abs(t)>Math.abs(e)?(r=e/t,Math.abs(t)*Math.sqrt(1+r*r)):0!==e?(r=t/e,Math.abs(e)*Math.sqrt(1+r*r)):0}function a(t,e,r){for(var n=new Array(t),i=0;i<t;i++){n[i]=new Array(e);for(var o=0;o<e;o++)n[i][o]=r}return n}class u{constructor(t,e={}){var r=(t=F.checkMatrix(t)).rows,n=t.columns;const{computeLeftSingularVectors:i=!0,computeRightSingularVectors:o=!0,autoTranspose:u=!1}=e;var h,c=Boolean(i),l=Boolean(o),f=!1;if(r<n)if(u){r=(h=t.transpose()).rows,n=h.columns,f=!0;var p=c;c=l,l=p}else h=t.clone(),console.warn("Computing SVD on a matrix with more columns than rows. Consider enabling autoTranspose");else h=t.clone();var m=Math.min(r,n),g=Math.min(r+1,n),d=new Array(g),v=a(r,m,0),y=a(n,n,0),w=new Array(n),b=new Array(r),x=new Array(g);for(let t=0;t<g;t++)x[t]=t;var M=Math.min(r-1,n),S=Math.max(0,Math.min(n-2,r)),A=Math.max(M,S);for(let t=0;t<A;t++){if(t<M){d[t]=0;for(let e=t;e<r;e++)d[t]=s(d[t],h[e][t]);if(0!==d[t]){h[t][t]<0&&(d[t]=-d[t]);for(let e=t;e<r;e++)h[e][t]/=d[t];h[t][t]+=1}d[t]=-d[t]}for(let e=t+1;e<n;e++){if(t<M&&0!==d[t]){let n=0;for(let i=t;i<r;i++)n+=h[i][t]*h[i][e];n=-n/h[t][t];for(let i=t;i<r;i++)h[i][e]+=n*h[i][t]}w[e]=h[t][e]}if(c&&t<M)for(let e=t;e<r;e++)v[e][t]=h[e][t];if(t<S){w[t]=0;for(let e=t+1;e<n;e++)w[t]=s(w[t],w[e]);if(0!==w[t]){w[t+1]<0&&(w[t]=0-w[t]);for(let e=t+1;e<n;e++)w[e]/=w[t];w[t+1]+=1}if(w[t]=-w[t],t+1<r&&0!==w[t]){for(let e=t+1;e<r;e++)b[e]=0;for(let e=t+1;e<r;e++)for(let r=t+1;r<n;r++)b[e]+=w[r]*h[e][r];for(let e=t+1;e<n;e++){let n=-w[e]/w[t+1];for(let i=t+1;i<r;i++)h[i][e]+=n*b[i]}}if(l)for(let e=t+1;e<n;e++)y[e][t]=w[e]}}let E=Math.min(n,r+1);if(M<n&&(d[M]=h[M][M]),r<E&&(d[E-1]=0),S+1<E&&(w[S]=h[S][E-1]),w[E-1]=0,c){for(let t=M;t<m;t++){for(let e=0;e<r;e++)v[e][t]=0;v[t][t]=1}for(let t=M-1;t>=0;t--)if(0!==d[t]){for(let e=t+1;e<m;e++){let n=0;for(let i=t;i<r;i++)n+=v[i][t]*v[i][e];n=-n/v[t][t];for(let i=t;i<r;i++)v[i][e]+=n*v[i][t]}for(let e=t;e<r;e++)v[e][t]=-v[e][t];v[t][t]=1+v[t][t];for(let e=0;e<t-1;e++)v[e][t]=0}else{for(let e=0;e<r;e++)v[e][t]=0;v[t][t]=1}}if(l)for(let t=n-1;t>=0;t--){if(t<S&&0!==w[t])for(let e=t+1;e<n;e++){let r=0;for(let i=t+1;i<n;i++)r+=y[i][t]*y[i][e];r=-r/y[t+1][t];for(let i=t+1;i<n;i++)y[i][e]+=r*y[i][t]}for(let e=0;e<n;e++)y[e][t]=0;y[t][t]=1}for(var _=E-1,k=Number.EPSILON;E>0;){let t,e;for(t=E-2;t>=-1&&-1!==t;t--){const e=Number.MIN_VALUE+k*Math.abs(d[t]+Math.abs(d[t+1]));if(Math.abs(w[t])<=e||Number.isNaN(w[t])){w[t]=0;break}}if(t===E-2)e=4;else{let r;for(r=E-1;r>=t&&r!==t;r--){let e=(r!==E?Math.abs(w[r]):0)+(r!==t+1?Math.abs(w[r-1]):0);if(Math.abs(d[r])<=k*e){d[r]=0;break}}r===t?e=3:r===E-1?e=1:(e=2,t=r)}switch(t++,e){case 1:{let e=w[E-2];w[E-2]=0;for(let r=E-2;r>=t;r--){let i=s(d[r],e),o=d[r]/i,a=e/i;if(d[r]=i,r!==t&&(e=-a*w[r-1],w[r-1]=o*w[r-1]),l)for(let t=0;t<n;t++)i=o*y[t][r]+a*y[t][E-1],y[t][E-1]=-a*y[t][r]+o*y[t][E-1],y[t][r]=i}break}case 2:{let e=w[t-1];w[t-1]=0;for(let n=t;n<E;n++){let i=s(d[n],e),o=d[n]/i,a=e/i;if(d[n]=i,e=-a*w[n],w[n]=o*w[n],c)for(let e=0;e<r;e++)i=o*v[e][n]+a*v[e][t-1],v[e][t-1]=-a*v[e][n]+o*v[e][t-1],v[e][n]=i}break}case 3:{const e=Math.max(Math.abs(d[E-1]),Math.abs(d[E-2]),Math.abs(w[E-2]),Math.abs(d[t]),Math.abs(w[t])),i=d[E-1]/e,o=d[E-2]/e,a=w[E-2]/e,u=d[t]/e,h=w[t]/e,f=((o+i)*(o-i)+a*a)/2,p=i*a*(i*a);let m=0;0===f&&0===p||(m=p/(f+(m=f<0?0-Math.sqrt(f*f+p):Math.sqrt(f*f+p))));let g=(u+i)*(u-i)+m,b=u*h;for(let e=t;e<E-1;e++){let i=s(g,b);0===i&&(i=Number.MIN_VALUE);let o=g/i,a=b/i;if(e!==t&&(w[e-1]=i),g=o*d[e]+a*w[e],w[e]=o*w[e]-a*d[e],b=a*d[e+1],d[e+1]=o*d[e+1],l)for(let t=0;t<n;t++)i=o*y[t][e]+a*y[t][e+1],y[t][e+1]=-a*y[t][e]+o*y[t][e+1],y[t][e]=i;if(0===(i=s(g,b))&&(i=Number.MIN_VALUE),o=g/i,a=b/i,d[e]=i,g=o*w[e]+a*d[e+1],d[e+1]=-a*w[e]+o*d[e+1],b=a*w[e+1],w[e+1]=o*w[e+1],c&&e<r-1)for(let t=0;t<r;t++)i=o*v[t][e]+a*v[t][e+1],v[t][e+1]=-a*v[t][e]+o*v[t][e+1],v[t][e]=i}w[E-2]=g,1;break}case 4:if(d[t]<=0&&(d[t]=d[t]<0?-d[t]:0,l))for(let e=0;e<=_;e++)y[e][t]=-y[e][t];for(;t<_&&!(d[t]>=d[t+1]);){let e=d[t];if(d[t]=d[t+1],d[t+1]=e,l&&t<n-1)for(let r=0;r<n;r++)e=y[r][t+1],y[r][t+1]=y[r][t],y[r][t]=e;if(c&&t<r-1)for(let n=0;n<r;n++)e=v[n][t+1],v[n][t+1]=v[n][t],v[n][t]=e;t++}0,E--}}if(f){var R=y;y=v,v=R}this.m=r,this.n=n,this.s=d,this.U=v,this.V=y}solve(t){var e=t,r=this.threshold,n=this.s.length,i=O.zeros(n,n);for(let t=0;t<n;t++)Math.abs(this.s[t])<=r?i[t][t]=0:i[t][t]=1/this.s[t];var o=this.U,s=this.rightSingularVectors,a=s.mmul(i),u=s.rows,h=o.length,c=O.zeros(u,h);for(let t=0;t<u;t++)for(let e=0;e<h;e++){let r=0;for(let i=0;i<n;i++)r+=a[t][i]*o[e][i];c[t][e]=r}return c.mmul(e)}solveForDiagonal(t){return this.solve(O.diag(t))}inverse(){var t=this.V,e=this.threshold,r=t.length,n=t[0].length,i=new O(r,this.s.length);for(let o=0;o<r;o++)for(let r=0;r<n;r++)Math.abs(this.s[r])>e?i[o][r]=t[o][r]/this.s[r]:i[o][r]=0;var o=this.U,s=o.length,a=o[0].length,u=new O(r,s);for(let t=0;t<r;t++)for(let e=0;e<s;e++){let r=0;for(let n=0;n<a;n++)r+=i[t][n]*o[e][n];u[t][e]=r}return u}get condition(){return this.s[0]/this.s[Math.min(this.m,this.n)-1]}get norm2(){return this.s[0]}get rank(){for(var t=Math.max(this.m,this.n)*this.s[0]*Number.EPSILON,e=0,r=this.s,n=0,i=r.length;n<i;n++)r[n]>t&&e++;return e}get diagonal(){return this.s}get threshold(){return Number.EPSILON/2*Math.max(this.m,this.n)*this.s[0]}get leftSingularVectors(){return O.isMatrix(this.U)||(this.U=new O(this.U)),this.U}get rightSingularVectors(){return O.isMatrix(this.V)||(this.V=new O(this.V)),this.V}get diagonalMatrix(){return O.diag(this.s)}}function h(t,e,r){var n=r?t.rows:t.rows-1;if(e<0||e>n)throw new RangeError("Row index out of range")}function c(t,e,r){var n=r?t.columns:t.columns-1;if(e<0||e>n)throw new RangeError("Column index out of range")}function l(t,e){if(e.to1DArray&&(e=e.to1DArray()),e.length!==t.columns)throw new RangeError("vector size must be the same as the number of columns");return e}function f(t,e){if(e.to1DArray&&(e=e.to1DArray()),e.length!==t.rows)throw new RangeError("vector size must be the same as the number of rows");return e}function p(t,e,r){return{row:m(t,e),column:g(t,r)}}function m(t,e){if("object"!=typeof e)throw new TypeError("unexpected type for row indices");if(e.some(e=>e<0||e>=t.rows))throw new RangeError("row indices are out of range");return Array.isArray(e)||(e=Array.from(e)),e}function g(t,e){if("object"!=typeof e)throw new TypeError("unexpected type for column indices");if(e.some(e=>e<0||e>=t.columns))throw new RangeError("column indices are out of range");return Array.isArray(e)||(e=Array.from(e)),e}function d(t,e,r,n,i){if(5!==arguments.length)throw new RangeError("expected 4 arguments");if(v("startRow",e),v("endRow",r),v("startColumn",n),v("endColumn",i),e>r||n>i||e<0||e>=t.rows||r<0||r>=t.rows||n<0||n>=t.columns||i<0||i>=t.columns)throw new RangeError("Submatrix indices are out of range")}function v(t,e){if("number"!=typeof e)throw new TypeError(`${t} must be a number`)}class y extends(R()){constructor(t,e,r){super(),this.matrix=t,this.rows=e,this.columns=r}static get[Symbol.species](){return O}}class w extends y{constructor(t){super(t,t.columns,t.rows)}set(t,e,r){return this.matrix.set(e,t,r),this}get(t,e){return this.matrix.get(e,t)}}class b extends y{constructor(t,e){super(t,1,t.columns),this.row=e}set(t,e,r){return this.matrix.set(this.row,e,r),this}get(t,e){return this.matrix.get(this.row,e)}}class x extends y{constructor(t,e,r,n,i){d(t,e,r,n,i),super(t,r-e+1,i-n+1),this.startRow=e,this.startColumn=n}set(t,e,r){return this.matrix.set(this.startRow+t,this.startColumn+e,r),this}get(t,e){return this.matrix.get(this.startRow+t,this.startColumn+e)}}class M extends y{constructor(t,e,r){var n=p(t,e,r);super(t,n.row.length,n.column.length),this.rowIndices=n.row,this.columnIndices=n.column}set(t,e,r){return this.matrix.set(this.rowIndices[t],this.columnIndices[e],r),this}get(t,e){return this.matrix.get(this.rowIndices[t],this.columnIndices[e])}}class S extends y{constructor(t,e){super(t,(e=m(t,e)).length,t.columns),this.rowIndices=e}set(t,e,r){return this.matrix.set(this.rowIndices[t],e,r),this}get(t,e){return this.matrix.get(this.rowIndices[t],e)}}class A extends y{constructor(t,e){e=g(t,e),super(t,t.rows,e.length),this.columnIndices=e}set(t,e,r){return this.matrix.set(t,this.columnIndices[e],r),this}get(t,e){return this.matrix.get(t,this.columnIndices[e])}}class E extends y{constructor(t,e){super(t,t.rows,1),this.column=e}set(t,e,r){return this.matrix.set(t,this.column,r),this}get(t){return this.matrix.get(t,this.column)}}class _ extends y{constructor(t){super(t,t.rows,t.columns)}set(t,e,r){return this.matrix.set(this.rows-t-1,e,r),this}get(t,e){return this.matrix.get(this.rows-t-1,e)}}class k extends y{constructor(t){super(t,t.rows,t.columns)}set(t,e,r){return this.matrix.set(t,this.columns-e-1,r),this}get(t,e){return this.matrix.get(t,this.columns-e-1)}}function R(t){void 0===t&&(t=Object);class e extends t{static get[Symbol.species](){return this}static from1DArray(t,e,r){if(t*e!==r.length)throw new RangeError("Data length does not match given dimensions");for(var n=new this(t,e),i=0;i<t;i++)for(var o=0;o<e;o++)n.set(i,o,r[i*e+o]);return n}static rowVector(t){for(var e=new this(1,t.length),r=0;r<t.length;r++)e.set(0,r,t[r]);return e}static columnVector(t){for(var e=new this(t.length,1),r=0;r<t.length;r++)e.set(r,0,t[r]);return e}static empty(t,e){return new this(t,e)}static zeros(t,e){return this.empty(t,e).fill(0)}static ones(t,e){return this.empty(t,e).fill(1)}static rand(t,e,r){void 0===r&&(r=Math.random);for(var n=this.empty(t,e),i=0;i<t;i++)for(var o=0;o<e;o++)n.set(i,o,r());return n}static randInt(t,e,r,n){void 0===r&&(r=1e3),void 0===n&&(n=Math.random);for(var i=this.empty(t,e),o=0;o<t;o++)for(var s=0;s<e;s++){var a=Math.floor(n()*r);i.set(o,s,a)}return i}static eye(t,e,r){void 0===e&&(e=t),void 0===r&&(r=1);for(var n=Math.min(t,e),i=this.zeros(t,e),o=0;o<n;o++)i.set(o,o,r);return i}static diag(t,e,r){var n=t.length;void 0===e&&(e=n),void 0===r&&(r=e);for(var i=Math.min(n,e,r),o=this.zeros(e,r),s=0;s<i;s++)o.set(s,s,t[s]);return o}static min(t,e){t=this.checkMatrix(t),e=this.checkMatrix(e);for(var r=t.rows,n=t.columns,i=new this(r,n),o=0;o<r;o++)for(var s=0;s<n;s++)i.set(o,s,Math.min(t.get(o,s),e.get(o,s)));return i}static max(t,e){t=this.checkMatrix(t),e=this.checkMatrix(e);for(var r=t.rows,n=t.columns,i=new this(r,n),o=0;o<r;o++)for(var s=0;s<n;s++)i.set(o,s,Math.max(t.get(o,s),e.get(o,s)));return i}static checkMatrix(t){return e.isMatrix(t)?t:new this(t)}static isMatrix(t){return null!=t&&"Matrix"===t.klass}get size(){return this.rows*this.columns}apply(t){if("function"!=typeof t)throw new TypeError("callback must be a function");for(var e=this.rows,r=this.columns,n=0;n<e;n++)for(var i=0;i<r;i++)t.call(this,n,i);return this}to1DArray(){for(var t=new Array(this.size),e=0;e<this.rows;e++)for(var r=0;r<this.columns;r++)t[e*this.columns+r]=this.get(e,r);return t}to2DArray(){for(var t=new Array(this.rows),e=0;e<this.rows;e++){t[e]=new Array(this.columns);for(var r=0;r<this.columns;r++)t[e][r]=this.get(e,r)}return t}isRowVector(){return 1===this.rows}isColumnVector(){return 1===this.columns}isVector(){return 1===this.rows||1===this.columns}isSquare(){return this.rows===this.columns}isSymmetric(){if(this.isSquare()){for(var t=0;t<this.rows;t++)for(var e=0;e<=t;e++)if(this.get(t,e)!==this.get(e,t))return!1;return!0}return!1}set(t,e,r){throw new Error("set method is unimplemented")}get(t,e){throw new Error("get method is unimplemented")}repeat(t,e){t=t||1,e=e||1;for(var r=new this.constructor[Symbol.species](this.rows*t,this.columns*e),n=0;n<t;n++)for(var i=0;i<e;i++)r.setSubMatrix(this,this.rows*n,this.columns*i);return r}fill(t){for(var e=0;e<this.rows;e++)for(var r=0;r<this.columns;r++)this.set(e,r,t);return this}neg(){return this.mulS(-1)}getRow(t){h(this,t);for(var e=new Array(this.columns),r=0;r<this.columns;r++)e[r]=this.get(t,r);return e}getRowVector(t){return this.constructor.rowVector(this.getRow(t))}setRow(t,e){h(this,t),e=l(this,e);for(var r=0;r<this.columns;r++)this.set(t,r,e[r]);return this}swapRows(t,e){h(this,t),h(this,e);for(var r=0;r<this.columns;r++){var n=this.get(t,r);this.set(t,r,this.get(e,r)),this.set(e,r,n)}return this}getColumn(t){c(this,t);for(var e=new Array(this.rows),r=0;r<this.rows;r++)e[r]=this.get(r,t);return e}getColumnVector(t){return this.constructor.columnVector(this.getColumn(t))}setColumn(t,e){c(this,t),e=f(this,e);for(var r=0;r<this.rows;r++)this.set(r,t,e[r]);return this}swapColumns(t,e){c(this,t),c(this,e);for(var r=0;r<this.rows;r++){var n=this.get(r,t);this.set(r,t,this.get(r,e)),this.set(r,e,n)}return this}addRowVector(t){t=l(this,t);for(var e=0;e<this.rows;e++)for(var r=0;r<this.columns;r++)this.set(e,r,this.get(e,r)+t[r]);return this}subRowVector(t){t=l(this,t);for(var e=0;e<this.rows;e++)for(var r=0;r<this.columns;r++)this.set(e,r,this.get(e,r)-t[r]);return this}mulRowVector(t){t=l(this,t);for(var e=0;e<this.rows;e++)for(var r=0;r<this.columns;r++)this.set(e,r,this.get(e,r)*t[r]);return this}divRowVector(t){t=l(this,t);for(var e=0;e<this.rows;e++)for(var r=0;r<this.columns;r++)this.set(e,r,this.get(e,r)/t[r]);return this}addColumnVector(t){t=f(this,t);for(var e=0;e<this.rows;e++)for(var r=0;r<this.columns;r++)this.set(e,r,this.get(e,r)+t[e]);return this}subColumnVector(t){t=f(this,t);for(var e=0;e<this.rows;e++)for(var r=0;r<this.columns;r++)this.set(e,r,this.get(e,r)-t[e]);return this}mulColumnVector(t){t=f(this,t);for(var e=0;e<this.rows;e++)for(var r=0;r<this.columns;r++)this.set(e,r,this.get(e,r)*t[e]);return this}divColumnVector(t){t=f(this,t);for(var e=0;e<this.rows;e++)for(var r=0;r<this.columns;r++)this.set(e,r,this.get(e,r)/t[e]);return this}mulRow(t,e){h(this,t);for(var r=0;r<this.columns;r++)this.set(t,r,this.get(t,r)*e);return this}mulColumn(t,e){c(this,t);for(var r=0;r<this.rows;r++)this.set(r,t,this.get(r,t)*e);return this}max(){for(var t=this.get(0,0),e=0;e<this.rows;e++)for(var r=0;r<this.columns;r++)this.get(e,r)>t&&(t=this.get(e,r));return t}maxIndex(){for(var t=this.get(0,0),e=[0,0],r=0;r<this.rows;r++)for(var n=0;n<this.columns;n++)this.get(r,n)>t&&(t=this.get(r,n),e[0]=r,e[1]=n);return e}min(){for(var t=this.get(0,0),e=0;e<this.rows;e++)for(var r=0;r<this.columns;r++)this.get(e,r)<t&&(t=this.get(e,r));return t}minIndex(){for(var t=this.get(0,0),e=[0,0],r=0;r<this.rows;r++)for(var n=0;n<this.columns;n++)this.get(r,n)<t&&(t=this.get(r,n),e[0]=r,e[1]=n);return e}maxRow(t){h(this,t);for(var e=this.get(t,0),r=1;r<this.columns;r++)this.get(t,r)>e&&(e=this.get(t,r));return e}maxRowIndex(t){h(this,t);for(var e=this.get(t,0),r=[t,0],n=1;n<this.columns;n++)this.get(t,n)>e&&(e=this.get(t,n),r[1]=n);return r}minRow(t){h(this,t);for(var e=this.get(t,0),r=1;r<this.columns;r++)this.get(t,r)<e&&(e=this.get(t,r));return e}minRowIndex(t){h(this,t);for(var e=this.get(t,0),r=[t,0],n=1;n<this.columns;n++)this.get(t,n)<e&&(e=this.get(t,n),r[1]=n);return r}maxColumn(t){c(this,t);for(var e=this.get(0,t),r=1;r<this.rows;r++)this.get(r,t)>e&&(e=this.get(r,t));return e}maxColumnIndex(t){c(this,t);for(var e=this.get(0,t),r=[0,t],n=1;n<this.rows;n++)this.get(n,t)>e&&(e=this.get(n,t),r[0]=n);return r}minColumn(t){c(this,t);for(var e=this.get(0,t),r=1;r<this.rows;r++)this.get(r,t)<e&&(e=this.get(r,t));return e}minColumnIndex(t){c(this,t);for(var e=this.get(0,t),r=[0,t],n=1;n<this.rows;n++)this.get(n,t)<e&&(e=this.get(n,t),r[0]=n);return r}diag(){for(var t=Math.min(this.rows,this.columns),e=new Array(t),r=0;r<t;r++)e[r]=this.get(r,r);return e}sum(t){switch(t){case"row":return function(t){for(var e=O.zeros(t.rows,1),r=0;r<t.rows;++r)for(var n=0;n<t.columns;++n)e.set(r,0,e.get(r,0)+t.get(r,n));return e}(this);case"column":return function(t){for(var e=O.zeros(1,t.columns),r=0;r<t.rows;++r)for(var n=0;n<t.columns;++n)e.set(0,n,e.get(0,n)+t.get(r,n));return e}(this);default:return function(t){for(var e=0,r=0;r<t.rows;r++)for(var n=0;n<t.columns;n++)e+=t.get(r,n);return e}(this)}}mean(){return this.sum()/this.size}prod(){for(var t=1,e=0;e<this.rows;e++)for(var r=0;r<this.columns;r++)t*=this.get(e,r);return t}norm(t="frobenius"){var e=0;if("max"===t)return this.max();if("frobenius"===t){for(var r=0;r<this.rows;r++)for(var n=0;n<this.columns;n++)e+=this.get(r,n)*this.get(r,n);return Math.sqrt(e)}throw new RangeError(`unknown norm type: ${t}`)}cumulativeSum(){for(var t=0,e=0;e<this.rows;e++)for(var r=0;r<this.columns;r++)t+=this.get(e,r),this.set(e,r,t);return this}dot(t){e.isMatrix(t)&&(t=t.to1DArray());var r=this.to1DArray();if(r.length!==t.length)throw new RangeError("vectors do not have the same size");for(var n=0,i=0;i<r.length;i++)n+=r[i]*t[i];return n}mmul(t){t=this.constructor.checkMatrix(t),this.columns!==t.rows&&console.warn("Number of columns of left matrix are not equal to number of rows of right matrix.");for(var e=this.rows,r=this.columns,n=t.columns,i=new this.constructor[Symbol.species](e,n),o=new Array(r),s=0;s<n;s++){for(var a=0;a<r;a++)o[a]=t.get(a,s);for(var u=0;u<e;u++){var h=0;for(a=0;a<r;a++)h+=this.get(u,a)*o[a];i.set(u,s,h)}}return i}strassen2x2(t){var e=new this.constructor[Symbol.species](2,2);const r=this.get(0,0),n=t.get(0,0),i=this.get(0,1),o=t.get(0,1),s=this.get(1,0),a=t.get(1,0),u=this.get(1,1),h=t.get(1,1),c=(r+u)*(n+h),l=(s+u)*n,f=r*(o-h),p=u*(a-n),m=(r+i)*h,g=c+p-m+(i-u)*(a+h),d=f+m,v=l+p,y=c-l+f+(s-r)*(n+o);return e.set(0,0,g),e.set(0,1,d),e.set(1,0,v),e.set(1,1,y),e}strassen3x3(t){var e=new this.constructor[Symbol.species](3,3);const r=this.get(0,0),n=this.get(0,1),i=this.get(0,2),o=this.get(1,0),s=this.get(1,1),a=this.get(1,2),u=this.get(2,0),h=this.get(2,1),c=this.get(2,2),l=t.get(0,0),f=t.get(0,1),p=t.get(0,2),m=t.get(1,0),g=t.get(1,1),d=t.get(1,2),v=t.get(2,0),y=t.get(2,1),w=t.get(2,2),b=(r-o)*(-f+g),x=(-r+o+s)*(l-f+g),M=(o+s)*(-l+f),S=r*l,A=(-r+u+h)*(l-p+d),E=(-r+u)*(p-d),_=(u+h)*(-l+p),k=(-i+h+c)*(g+v-y),R=(i-c)*(g-y),O=i*v,C=(h+c)*(-v+y),F=(-i+s+a)*(d+v-w),T=(i-a)*(d-w),D=(s+a)*(-v+w),z=S+O+n*m,P=(r+n+i-o-s-h-c)*g+x+M+S+k+O+C,N=S+A+_+(r+n+i-s-a-u-h)*d+O+F+D,j=b+s*(-l+f+m-g-d-v+w)+x+S+O+F+T,V=b+x+M+S+a*y,I=O+F+T+D+o*p,L=S+A+E+h*(-l+p+m-g-d-v+y)+k+R+O,q=k+R+O+C+u*f,U=S+A+E+_+c*w;return e.set(0,0,z),e.set(0,1,P),e.set(0,2,N),e.set(1,0,j),e.set(1,1,V),e.set(1,2,I),e.set(2,0,L),e.set(2,1,q),e.set(2,2,U),e}mmulStrassen(t){var r=this.clone(),n=r.rows,i=r.columns,o=t.rows,s=t.columns;function a(t,r,n){var i=t.rows,o=t.columns;if(i===r&&o===n)return t;var s=e.zeros(r,n);return s=s.setSubMatrix(t,0,0)}i!==o&&console.warn(`Multiplying ${n} x ${i} and ${o} x ${s} matrix: dimensions do not match.`);var u=Math.max(n,o),h=Math.max(i,s);return function t(r,n,i,o){if(i<=512||o<=512)return r.mmul(n);i%2==1&&o%2==1?(r=a(r,i+1,o+1),n=a(n,i+1,o+1)):i%2==1?(r=a(r,i+1,o),n=a(n,i+1,o)):o%2==1&&(r=a(r,i,o+1),n=a(n,i,o+1));var s=parseInt(r.rows/2,10),u=parseInt(r.columns/2,10),h=r.subMatrix(0,s-1,0,u-1),c=n.subMatrix(0,s-1,0,u-1),l=r.subMatrix(0,s-1,u,r.columns-1),f=n.subMatrix(0,s-1,u,n.columns-1),p=r.subMatrix(s,r.rows-1,0,u-1),m=n.subMatrix(s,n.rows-1,0,u-1),g=r.subMatrix(s,r.rows-1,u,r.columns-1),d=n.subMatrix(s,n.rows-1,u,n.columns-1),v=t(e.add(h,g),e.add(c,d),s,u),y=t(e.add(p,g),c,s,u),w=t(h,e.sub(f,d),s,u),b=t(g,e.sub(m,c),s,u),x=t(e.add(h,l),d,s,u),M=t(e.sub(p,h),e.add(c,f),s,u),S=t(e.sub(l,g),e.add(m,d),s,u),A=e.add(v,b);A.sub(x),A.add(S);var E=e.add(w,x),_=e.add(y,b),k=e.sub(v,y);k.add(w),k.add(M);var R=e.zeros(2*A.rows,2*A.columns);return(R=(R=(R=(R=R.setSubMatrix(A,0,0)).setSubMatrix(E,A.rows,0)).setSubMatrix(_,0,A.columns)).setSubMatrix(k,A.rows,A.columns)).subMatrix(0,i-1,0,o-1)}(r=a(r,u,h),t=a(t,u,h),u,h)}scaleRows(t,e){if((t=void 0===t?0:t)>=(e=void 0===e?1:e))throw new RangeError("min should be strictly smaller than max");for(var r=this.constructor.empty(this.rows,this.columns),n=0;n<this.rows;n++){var o=i(this.getRow(n),{min:t,max:e});r.setRow(n,o)}return r}scaleColumns(t,e){if((t=void 0===t?0:t)>=(e=void 0===e?1:e))throw new RangeError("min should be strictly smaller than max");for(var r=this.constructor.empty(this.rows,this.columns),n=0;n<this.columns;n++){var o=i(this.getColumn(n),{min:t,max:e});r.setColumn(n,o)}return r}kroneckerProduct(t){t=this.constructor.checkMatrix(t);for(var e=this.rows,r=this.columns,n=t.rows,i=t.columns,o=new this.constructor[Symbol.species](e*n,r*i),s=0;s<e;s++)for(var a=0;a<r;a++)for(var u=0;u<n;u++)for(var h=0;h<i;h++)o[n*s+u][i*a+h]=this.get(s,a)*t.get(u,h);return o}transpose(){for(var t=new this.constructor[Symbol.species](this.columns,this.rows),e=0;e<this.rows;e++)for(var r=0;r<this.columns;r++)t.set(r,e,this.get(e,r));return t}sortRows(t){void 0===t&&(t=r);for(var e=0;e<this.rows;e++)this.setRow(e,this.getRow(e).sort(t));return this}sortColumns(t){void 0===t&&(t=r);for(var e=0;e<this.columns;e++)this.setColumn(e,this.getColumn(e).sort(t));return this}subMatrix(t,e,r,n){d(this,t,e,r,n);for(var i=new this.constructor[Symbol.species](e-t+1,n-r+1),o=t;o<=e;o++)for(var s=r;s<=n;s++)i[o-t][s-r]=this.get(o,s);return i}subMatrixRow(t,e,r){if(void 0===e&&(e=0),void 0===r&&(r=this.columns-1),e>r||e<0||e>=this.columns||r<0||r>=this.columns)throw new RangeError("Argument out of range");for(var n=new this.constructor[Symbol.species](t.length,r-e+1),i=0;i<t.length;i++)for(var o=e;o<=r;o++){if(t[i]<0||t[i]>=this.rows)throw new RangeError(`Row index out of range: ${t[i]}`);n.set(i,o-e,this.get(t[i],o))}return n}subMatrixColumn(t,e,r){if(void 0===e&&(e=0),void 0===r&&(r=this.rows-1),e>r||e<0||e>=this.rows||r<0||r>=this.rows)throw new RangeError("Argument out of range");for(var n=new this.constructor[Symbol.species](r-e+1,t.length),i=0;i<t.length;i++)for(var o=e;o<=r;o++){if(t[i]<0||t[i]>=this.columns)throw new RangeError(`Column index out of range: ${t[i]}`);n.set(o-e,i,this.get(o,t[i]))}return n}setSubMatrix(t,e,r){d(this,e,e+(t=this.constructor.checkMatrix(t)).rows-1,r,r+t.columns-1);for(var n=0;n<t.rows;n++)for(var i=0;i<t.columns;i++)this[e+n][r+i]=t.get(n,i);return this}selection(t,e){for(var r=p(this,t,e),n=new this.constructor[Symbol.species](t.length,e.length),i=0;i<r.row.length;i++)for(var o=r.row[i],s=0;s<r.column.length;s++){var a=r.column[s];n[i][s]=this.get(o,a)}return n}trace(){for(var t=Math.min(this.rows,this.columns),e=0,r=0;r<t;r++)e+=this.get(r,r);return e}transposeView(){return new w(this)}rowView(t){return h(this,t),new b(this,t)}columnView(t){return c(this,t),new E(this,t)}flipRowView(){return new _(this)}flipColumnView(){return new k(this)}subMatrixView(t,e,r,n){return new x(this,t,e,r,n)}selectionView(t,e){return new M(this,t,e)}rowSelectionView(t){return new S(this,t)}columnSelectionView(t){return new A(this,t)}det(){var t,e,r,n,i,s;if(this.isSquare())return 2===this.columns?(t=this.get(0,0),e=this.get(0,1),r=this.get(1,0),t*this.get(1,1)-e*r):3===this.columns?(n=this.selectionView([1,2],[1,2]),i=this.selectionView([1,2],[0,2]),s=this.selectionView([1,2],[0,1]),t=this.get(0,0),e=this.get(0,1),r=this.get(0,2),t*n.det()-e*i.det()+r*s.det()):new o(this).determinant;throw Error("Determinant can only be calculated for a square matrix.")}pseudoInverse(t){void 0===t&&(t=Number.EPSILON);for(var e=new u(this,{autoTranspose:!0}),r=e.leftSingularVectors,n=e.rightSingularVectors,i=e.diagonal,o=0;o<i.length;o++)Math.abs(i[o])>t?i[o]=1/i[o]:i[o]=0;return i=this.constructor[Symbol.species].diag(i),n.mmul(i.mmul(r.transposeView()))}clone(){for(var t=new this.constructor[Symbol.species](this.rows,this.columns),e=0;e<this.rows;e++)for(var r=0;r<this.columns;r++)t.set(e,r,this.get(e,r));return t}}function r(t,e){return t-e}e.prototype.klass="Matrix",e.random=e.rand,e.diagonal=e.diag,e.prototype.diagonal=e.prototype.diag,e.identity=e.eye,e.prototype.negate=e.prototype.neg,e.prototype.tensorProduct=e.prototype.kroneckerProduct,e.prototype.determinant=e.prototype.det;var n,s="\n(function %name%(matrix, %args%) {\n    var newMatrix = new this[Symbol.species](matrix);\n    return newMatrix.%name%(%args%);\n})\n",a=eval;for(var m of[["+","add"],["-","sub","subtract"],["*","mul","multiply"],["/","div","divide"],["%","mod","modulus"],["&","and"],["|","or"],["^","xor"],["<<","leftShift"],[">>","signPropagatingRightShift"],[">>>","rightShift","zeroFillRightShift"]]){var g=a(B("\n(function %name%(value) {\n    if (typeof value === 'number') return this.%name%S(value);\n    return this.%name%M(value);\n})\n",{name:m[1],op:m[0]})),v=a(B("\n(function %name%S(value) {\n    for (var i = 0; i < this.rows; i++) {\n        for (var j = 0; j < this.columns; j++) {\n            this.set(i, j, this.get(i, j) %op% value);\n        }\n    }\n    return this;\n})\n",{name:`${m[1]}S`,op:m[0]})),y=a(B("\n(function %name%M(matrix) {\n    matrix = this.constructor.checkMatrix(matrix);\n    if (this.rows !== matrix.rows ||\n        this.columns !== matrix.columns) {\n        throw new RangeError('Matrices dimensions must be equal');\n    }\n    for (var i = 0; i < this.rows; i++) {\n        for (var j = 0; j < this.columns; j++) {\n            this.set(i, j, this.get(i, j) %op% matrix.get(i, j));\n        }\n    }\n    return this;\n})\n",{name:`${m[1]}M`,op:m[0]})),R=a(B("\n(function %name%(matrix, value) {\n    var newMatrix = new this[Symbol.species](matrix);\n    return newMatrix.%name%(value);\n})\n",{name:m[1]}));for(n=1;n<m.length;n++)e.prototype[m[n]]=g,e.prototype[`${m[n]}S`]=v,e.prototype[`${m[n]}M`]=y,e[m[n]]=R}var C=[["~","not"]];for(var F of(["abs","acos","acosh","asin","asinh","atan","atanh","cbrt","ceil","clz32","cos","cosh","exp","expm1","floor","fround","log","log1p","log10","log2","round","sign","sin","sinh","sqrt","tan","tanh","trunc"].forEach(function(t){C.push([`Math.${t}`,t])}),C)){var T=a(B("\n(function %name%() {\n    for (var i = 0; i < this.rows; i++) {\n        for (var j = 0; j < this.columns; j++) {\n            this.set(i, j, %method%(this.get(i, j)));\n        }\n    }\n    return this;\n})\n",{name:F[1],method:F[0]})),D=a(B("\n(function %name%(matrix) {\n    var newMatrix = new this[Symbol.species](matrix);\n    return newMatrix.%name%();\n})\n",{name:F[1]}));for(n=1;n<F.length;n++)e.prototype[F[n]]=T,e[F[n]]=D}for(var z of[["Math.pow",1,"pow"]]){var P="arg0";for(n=1;n<z[1];n++)P+=`, arg${n}`;if(1!==z[1]){var N=a(B("\n(function %name%(%args%) {\n    for (var i = 0; i < this.rows; i++) {\n        for (var j = 0; j < this.columns; j++) {\n            this.set(i, j, %method%(this.get(i, j), %args%));\n        }\n    }\n    return this;\n})\n",{name:z[2],method:z[0],args:P})),j=a(B(s,{name:z[2],args:P}));for(n=2;n<z.length;n++)e.prototype[z[n]]=N,e[z[n]]=j}else{var V={name:z[2],args:P,method:z[0]},I=a(B("\n(function %name%(value) {\n    if (typeof value === 'number') return this.%name%S(value);\n    return this.%name%M(value);\n})\n",V)),L=a(B("\n(function %name%S(value) {\n    for (var i = 0; i < this.rows; i++) {\n        for (var j = 0; j < this.columns; j++) {\n            this.set(i, j, %method%(this.get(i, j), value));\n        }\n    }\n    return this;\n})\n",V)),q=a(B("\n(function %name%M(matrix) {\n    matrix = this.constructor.checkMatrix(matrix);\n    if (this.rows !== matrix.rows ||\n        this.columns !== matrix.columns) {\n        throw new RangeError('Matrices dimensions must be equal');\n    }\n    for (var i = 0; i < this.rows; i++) {\n        for (var j = 0; j < this.columns; j++) {\n            this.set(i, j, %method%(this.get(i, j), matrix.get(i, j)));\n        }\n    }\n    return this;\n})\n",V)),U=a(B("\n(function %name%(matrix, %args%) {\n    var newMatrix = new this[Symbol.species](matrix);\n    return newMatrix.%name%(%args%);\n})\n",V));for(n=2;n<z.length;n++)e.prototype[z[n]]=I,e.prototype[`${z[n]}M`]=q,e.prototype[`${z[n]}S`]=L,e[z[n]]=U}}function B(t,e){for(var r in e)t=t.replace(new RegExp(`%${r}%`,"g"),e[r]);return t}return e}class O extends(R(Array)){constructor(t,e){var r;if(1===arguments.length&&"number"==typeof t)return new Array(t);if(O.isMatrix(t))return t.clone();if(Number.isInteger(t)&&t>0){if(super(t),!(Number.isInteger(e)&&e>0))throw new TypeError("nColumns must be a positive integer");for(r=0;r<t;r++)this[r]=new Array(e)}else{if(!Array.isArray(t))throw new TypeError("First argument must be a positive number or an array");{const n=t;if(t=n.length,"number"!=typeof(e=n[0].length)||0===e)throw new TypeError("Data must be a 2D array with at least one element");for(super(t),r=0;r<t;r++){if(n[r].length!==e)throw new RangeError("Inconsistent array dimensions");this[r]=[].concat(n[r])}}}return this.rows=t,this.columns=e,this}set(t,e,r){return this[t][e]=r,this}get(t,e){return this[t][e]}removeRow(t){if(h(this,t),1===this.rows)throw new RangeError("A matrix cannot have less than one row");return this.splice(t,1),this.rows-=1,this}addRow(t,e){return void 0===e&&(e=t,t=this.rows),h(this,t,!0),e=l(this,e),this.splice(t,0,e),this.rows+=1,this}removeColumn(t){if(c(this,t),1===this.columns)throw new RangeError("A matrix cannot have less than one column");for(var e=0;e<this.rows;e++)this[e].splice(t,1);return this.columns-=1,this}addColumn(t,e){void 0===e&&(e=t,t=this.columns),c(this,t,!0),e=f(this,e);for(var r=0;r<this.rows;r++)this[r].splice(t,0,e[r]);return this.columns+=1,this}}class C extends(R()){constructor(t,e={}){const{rows:r=1}=e;if(t.length%r!=0)throw new Error("the data length is not divisible by the number of rows");super(),this.rows=r,this.columns=t.length/r,this.data=t}set(t,e,r){var n=this._calculateIndex(t,e);return this.data[n]=r,this}get(t,e){var r=this._calculateIndex(t,e);return this.data[r]}_calculateIndex(t,e){return t*this.columns+e}static get[Symbol.species](){return O}}class F extends(R()){constructor(t){super(),this.data=t,this.rows=t.length,this.columns=t[0].length}set(t,e,r){return this.data[t][e]=r,this}get(t,e){return this.data[t][e]}static get[Symbol.species](){return O}}function T(t,e){if(Array.isArray(t))return t[0]&&Array.isArray(t[0])?new F(t):new C(t,e);throw new Error("the argument is not an array")}class D{constructor(t){var e,r,n,i,o=(t=F.checkMatrix(t)).clone(),a=t.rows,u=t.columns,h=new Array(u);for(n=0;n<u;n++){var c=0;for(e=n;e<a;e++)c=s(c,o.get(e,n));if(0!==c){for(o.get(n,n)<0&&(c=-c),e=n;e<a;e++)o.set(e,n,o.get(e,n)/c);for(o.set(n,n,o.get(n,n)+1),r=n+1;r<u;r++){for(i=0,e=n;e<a;e++)i+=o.get(e,n)*o.get(e,r);for(i=-i/o.get(n,n),e=n;e<a;e++)o.set(e,r,o.get(e,r)+i*o.get(e,n))}}h[n]=-c}this.QR=o,this.Rdiag=h}solve(t){t=O.checkMatrix(t);var e=this.QR,r=e.rows;if(t.rows!==r)throw new Error("Matrix row dimensions must agree");if(!this.isFullRank())throw new Error("Matrix is rank deficient");var n,i,o,s,a=t.columns,u=t.clone(),h=e.columns;for(o=0;o<h;o++)for(i=0;i<a;i++){for(s=0,n=o;n<r;n++)s+=e[n][o]*u[n][i];for(s=-s/e[o][o],n=o;n<r;n++)u[n][i]+=s*e[n][o]}for(o=h-1;o>=0;o--){for(i=0;i<a;i++)u[o][i]/=this.Rdiag[o];for(n=0;n<o;n++)for(i=0;i<a;i++)u[n][i]-=u[o][i]*e[n][o]}return u.subMatrix(0,h-1,0,a-1)}isFullRank(){for(var t=this.QR.columns,e=0;e<t;e++)if(0===this.Rdiag[e])return!1;return!0}get upperTriangularMatrix(){var t,e,r=this.QR,n=r.columns,i=new O(n,n);for(t=0;t<n;t++)for(e=0;e<n;e++)i[t][e]=t<e?r[t][e]:t===e?this.Rdiag[t]:0;return i}get orthogonalMatrix(){var t,e,r,n,i=this.QR,o=i.rows,s=i.columns,a=new O(o,s);for(r=s-1;r>=0;r--){for(t=0;t<o;t++)a[t][r]=0;for(a[r][r]=1,e=r;e<s;e++)if(0!==i[r][r]){for(n=0,t=r;t<o;t++)n+=i[t][r]*a[t][e];for(n=-n/i[r][r],t=r;t<o;t++)a[t][e]+=n*i[t][r]}}return a}}function z(t,e=!1){return t=F.checkMatrix(t),e?new u(t).inverse():P(t,O.eye(t.rows))}function P(t,e,r=!1){return t=F.checkMatrix(t),e=F.checkMatrix(e),r?new u(t).solve(e):t.isSquare()?new o(t).solve(e):new D(t).solve(e)}function N(t,e){for(var r=[],n=0;n<t;n++)n!==e&&r.push(n);return r}function j(t,e,r,n=1e-9,i=1e-9){if(t>i)return new Array(e.rows+1).fill(0);for(var o=e.addRow(r,[0]),s=0;s<o.rows;s++)Math.abs(o.get(s,0))<n&&o.set(s,0,0);return o.to1DArray()}function V(t,e={}){const{thresholdValue:r=1e-9,thresholdError:i=1e-9}=e;for(var o=t.rows,s=new O(o,o),a=0;a<o;a++){var h=O.columnVector(t.getRow(a)),c=t.subMatrixRow(N(o,a)).transposeView(),l=new u(c).solve(h),f=n(O.sub(h,c.mmul(l)).abs().to1DArray());s.setRow(a,j(f,l,a,r,i))}return s}class I{constructor(t,e={}){const{assumeSymmetric:r=!1}=e;if(!(t=F.checkMatrix(t)).isSquare())throw new Error("Matrix is not a square matrix");var n,i,o=t.columns,u=a(o,o,0),h=new Array(o),c=new Array(o),l=t;if(!!r||t.isSymmetric()){for(n=0;n<o;n++)for(i=0;i<o;i++)u[n][i]=l.get(n,i);!function(t,e,r,n){var i,o,s,a,u,h,c,l;for(u=0;u<t;u++)r[u]=n[t-1][u];for(a=t-1;a>0;a--){for(l=0,s=0,h=0;h<a;h++)l+=Math.abs(r[h]);if(0===l)for(e[a]=r[a-1],u=0;u<a;u++)r[u]=n[a-1][u],n[a][u]=0,n[u][a]=0;else{for(h=0;h<a;h++)r[h]/=l,s+=r[h]*r[h];for(i=r[a-1],o=Math.sqrt(s),i>0&&(o=-o),e[a]=l*o,s-=i*o,r[a-1]=i-o,u=0;u<a;u++)e[u]=0;for(u=0;u<a;u++){for(i=r[u],n[u][a]=i,o=e[u]+n[u][u]*i,h=u+1;h<=a-1;h++)o+=n[h][u]*r[h],e[h]+=n[h][u]*i;e[u]=o}for(i=0,u=0;u<a;u++)e[u]/=s,i+=e[u]*r[u];for(c=i/(s+s),u=0;u<a;u++)e[u]-=c*r[u];for(u=0;u<a;u++){for(i=r[u],o=e[u],h=u;h<=a-1;h++)n[h][u]-=i*e[h]+o*r[h];r[u]=n[a-1][u],n[a][u]=0}}r[a]=s}for(a=0;a<t-1;a++){if(n[t-1][a]=n[a][a],n[a][a]=1,0!==(s=r[a+1])){for(h=0;h<=a;h++)r[h]=n[h][a+1]/s;for(u=0;u<=a;u++){for(o=0,h=0;h<=a;h++)o+=n[h][a+1]*n[h][u];for(h=0;h<=a;h++)n[h][u]-=o*r[h]}}for(h=0;h<=a;h++)n[h][a+1]=0}for(u=0;u<t;u++)r[u]=n[t-1][u],n[t-1][u]=0;n[t-1][t-1]=1,e[0]=0}(o,c,h,u),function(t,e,r,n){var i,o,a,u,h,c,l,f,p,m,g,d,v,y,w,b;for(a=1;a<t;a++)e[a-1]=e[a];e[t-1]=0;var x=0,M=0,S=Number.EPSILON;for(c=0;c<t;c++){for(M=Math.max(M,Math.abs(r[c])+Math.abs(e[c])),l=c;l<t&&!(Math.abs(e[l])<=S*M);)l++;if(l>c){0;do{for(1,i=r[c],f=(r[c+1]-i)/(2*e[c]),p=s(f,1),f<0&&(p=-p),r[c]=e[c]/(f+p),r[c+1]=e[c]*(f+p),m=r[c+1],o=i-r[c],a=c+2;a<t;a++)r[a]-=o;for(x+=o,f=r[l],d=g=1,v=g,y=e[c+1],w=0,b=0,a=l-1;a>=c;a--)for(v=d,d=g,b=w,i=g*e[a],o=g*f,p=s(f,e[a]),e[a+1]=w*p,w=e[a]/p,f=(g=f/p)*r[a]-w*i,r[a+1]=o+w*(g*i+w*r[a]),h=0;h<t;h++)o=n[h][a+1],n[h][a+1]=w*n[h][a]+g*o,n[h][a]=g*n[h][a]-w*o;f=-w*b*v*y*e[c]/m,e[c]=w*f,r[c]=g*f}while(Math.abs(e[c])>S*M)}r[c]=r[c]+x,e[c]=0}for(a=0;a<t-1;a++){for(h=a,f=r[a],u=a+1;u<t;u++)r[u]<f&&(h=u,f=r[u]);if(h!==a)for(r[h]=r[a],r[a]=f,u=0;u<t;u++)f=n[u][a],n[u][a]=n[u][h],n[u][h]=f}}(o,c,h,u)}else{var f=a(o,o,0),p=new Array(o);for(i=0;i<o;i++)for(n=0;n<o;n++)f[n][i]=l.get(n,i);!function(t,e,r,n){var i,o,s,a,u,h,c,l=t-1;for(h=1;h<=l-1;h++){for(c=0,a=h;a<=l;a++)c+=Math.abs(e[a][h-1]);if(0!==c){for(s=0,a=l;a>=h;a--)r[a]=e[a][h-1]/c,s+=r[a]*r[a];for(o=Math.sqrt(s),r[h]>0&&(o=-o),s-=r[h]*o,r[h]=r[h]-o,u=h;u<t;u++){for(i=0,a=l;a>=h;a--)i+=r[a]*e[a][u];for(i/=s,a=h;a<=l;a++)e[a][u]-=i*r[a]}for(a=0;a<=l;a++){for(i=0,u=l;u>=h;u--)i+=r[u]*e[a][u];for(i/=s,u=h;u<=l;u++)e[a][u]-=i*r[u]}r[h]=c*r[h],e[h][h-1]=c*o}}for(a=0;a<t;a++)for(u=0;u<t;u++)n[a][u]=a===u?1:0;for(h=l-1;h>=1;h--)if(0!==e[h][h-1]){for(a=h+1;a<=l;a++)r[a]=e[a][h-1];for(u=h;u<=l;u++){for(o=0,a=h;a<=l;a++)o+=r[a]*n[a][u];for(o=o/r[h]/e[h][h-1],a=h;a<=l;a++)n[a][u]+=o*r[a]}}}(o,f,p,u),function(t,e,r,n,i){var o,s,a,u,h,c,l,f,p,m,g,d,v,y,w,b=t-1,x=t-1,M=Number.EPSILON,S=0,A=0,E=0,_=0,k=0,R=0,O=0,C=0;for(o=0;o<t;o++)for((o<0||o>x)&&(r[o]=i[o][o],e[o]=0),s=Math.max(o-1,0);s<t;s++)A+=Math.abs(i[o][s]);for(;b>=0;){for(u=b;u>0&&(0===(R=Math.abs(i[u-1][u-1])+Math.abs(i[u][u]))&&(R=A),!(Math.abs(i[u][u-1])<M*R));)u--;if(u===b)i[b][b]=i[b][b]+S,r[b]=i[b][b],e[b]=0,b--,C=0;else if(u===b-1){if(l=i[b][b-1]*i[b-1][b],E=(i[b-1][b-1]-i[b][b])/2,_=E*E+l,O=Math.sqrt(Math.abs(_)),i[b][b]=i[b][b]+S,i[b-1][b-1]=i[b-1][b-1]+S,f=i[b][b],_>=0){for(O=E>=0?E+O:E-O,r[b-1]=f+O,r[b]=r[b-1],0!==O&&(r[b]=f-l/O),e[b-1]=0,e[b]=0,f=i[b][b-1],R=Math.abs(f)+Math.abs(O),E=f/R,_=O/R,k=Math.sqrt(E*E+_*_),E/=k,_/=k,s=b-1;s<t;s++)O=i[b-1][s],i[b-1][s]=_*O+E*i[b][s],i[b][s]=_*i[b][s]-E*O;for(o=0;o<=b;o++)O=i[o][b-1],i[o][b-1]=_*O+E*i[o][b],i[o][b]=_*i[o][b]-E*O;for(o=0;o<=x;o++)O=n[o][b-1],n[o][b-1]=_*O+E*n[o][b],n[o][b]=_*n[o][b]-E*O}else r[b-1]=f+E,r[b]=f+E,e[b-1]=O,e[b]=-O;b-=2,C=0}else{if(f=i[b][b],p=0,l=0,u<b&&(p=i[b-1][b-1],l=i[b][b-1]*i[b-1][b]),10===C){for(S+=f,o=0;o<=b;o++)i[o][o]-=f;R=Math.abs(i[b][b-1])+Math.abs(i[b-1][b-2]),f=p=.75*R,l=-.4375*R*R}if(30===C&&(R=(R=(p-f)/2)*R+l)>0){for(R=Math.sqrt(R),p<f&&(R=-R),R=f-l/((p-f)/2+R),o=0;o<=b;o++)i[o][o]-=R;S+=R,f=p=l=.964}for(C+=1,h=b-2;h>=u&&(O=i[h][h],E=((k=f-O)*(R=p-O)-l)/i[h+1][h]+i[h][h+1],_=i[h+1][h+1]-O-k-R,k=i[h+2][h+1],R=Math.abs(E)+Math.abs(_)+Math.abs(k),E/=R,_/=R,k/=R,h!==u)&&!(Math.abs(i[h][h-1])*(Math.abs(_)+Math.abs(k))<M*(Math.abs(E)*(Math.abs(i[h-1][h-1])+Math.abs(O)+Math.abs(i[h+1][h+1]))));)h--;for(o=h+2;o<=b;o++)i[o][o-2]=0,o>h+2&&(i[o][o-3]=0);for(a=h;a<=b-1&&(y=a!==b-1,a!==h&&(E=i[a][a-1],_=i[a+1][a-1],k=y?i[a+2][a-1]:0,0!==(f=Math.abs(E)+Math.abs(_)+Math.abs(k))&&(E/=f,_/=f,k/=f)),0!==f);a++)if(R=Math.sqrt(E*E+_*_+k*k),E<0&&(R=-R),0!==R){for(a!==h?i[a][a-1]=-R*f:u!==h&&(i[a][a-1]=-i[a][a-1]),f=(E+=R)/R,p=_/R,O=k/R,_/=E,k/=E,s=a;s<t;s++)E=i[a][s]+_*i[a+1][s],y&&(E+=k*i[a+2][s],i[a+2][s]=i[a+2][s]-E*O),i[a][s]=i[a][s]-E*f,i[a+1][s]=i[a+1][s]-E*p;for(o=0;o<=Math.min(b,a+3);o++)E=f*i[o][a]+p*i[o][a+1],y&&(E+=O*i[o][a+2],i[o][a+2]=i[o][a+2]-E*k),i[o][a]=i[o][a]-E,i[o][a+1]=i[o][a+1]-E*_;for(o=0;o<=x;o++)E=f*n[o][a]+p*n[o][a+1],y&&(E+=O*n[o][a+2],n[o][a+2]=n[o][a+2]-E*k),n[o][a]=n[o][a]-E,n[o][a+1]=n[o][a+1]-E*_}}}if(0===A)return;for(b=t-1;b>=0;b--)if(E=r[b],0===(_=e[b]))for(u=b,i[b][b]=1,o=b-1;o>=0;o--){for(l=i[o][o]-E,k=0,s=u;s<=b;s++)k+=i[o][s]*i[s][b];if(e[o]<0)O=l,R=k;else if(u=o,0===e[o]?i[o][b]=0!==l?-k/l:-k/(M*A):(f=i[o][o+1],p=i[o+1][o],_=(r[o]-E)*(r[o]-E)+e[o]*e[o],c=(f*R-O*k)/_,i[o][b]=c,i[o+1][b]=Math.abs(f)>Math.abs(O)?(-k-l*c)/f:(-R-p*c)/O),c=Math.abs(i[o][b]),M*c*c>1)for(s=o;s<=b;s++)i[s][b]=i[s][b]/c}else if(_<0)for(u=b-1,Math.abs(i[b][b-1])>Math.abs(i[b-1][b])?(i[b-1][b-1]=_/i[b][b-1],i[b-1][b]=-(i[b][b]-E)/i[b][b-1]):(w=L(0,-i[b-1][b],i[b-1][b-1]-E,_),i[b-1][b-1]=w[0],i[b-1][b]=w[1]),i[b][b-1]=0,i[b][b]=1,o=b-2;o>=0;o--){for(m=0,g=0,s=u;s<=b;s++)m+=i[o][s]*i[s][b-1],g+=i[o][s]*i[s][b];if(l=i[o][o]-E,e[o]<0)O=l,k=m,R=g;else if(u=o,0===e[o]?(w=L(-m,-g,l,_),i[o][b-1]=w[0],i[o][b]=w[1]):(f=i[o][o+1],p=i[o+1][o],d=(r[o]-E)*(r[o]-E)+e[o]*e[o]-_*_,v=2*(r[o]-E)*_,0===d&&0===v&&(d=M*A*(Math.abs(l)+Math.abs(_)+Math.abs(f)+Math.abs(p)+Math.abs(O))),w=L(f*k-O*m+_*g,f*R-O*g-_*m,d,v),i[o][b-1]=w[0],i[o][b]=w[1],Math.abs(f)>Math.abs(O)+Math.abs(_)?(i[o+1][b-1]=(-m-l*i[o][b-1]+_*i[o][b])/f,i[o+1][b]=(-g-l*i[o][b]-_*i[o][b-1])/f):(w=L(-k-p*i[o][b-1],-R-p*i[o][b],O,_),i[o+1][b-1]=w[0],i[o+1][b]=w[1])),c=Math.max(Math.abs(i[o][b-1]),Math.abs(i[o][b])),M*c*c>1)for(s=o;s<=b;s++)i[s][b-1]=i[s][b-1]/c,i[s][b]=i[s][b]/c}for(o=0;o<t;o++)if(o<0||o>x)for(s=o;s<t;s++)n[o][s]=i[o][s];for(s=t-1;s>=0;s--)for(o=0;o<=x;o++){for(O=0,a=0;a<=Math.min(s,x);a++)O+=n[o][a]*i[a][s];n[o][s]=O}}(o,c,h,u,f)}this.n=o,this.e=c,this.d=h,this.V=u}get realEigenvalues(){return this.d}get imaginaryEigenvalues(){return this.e}get eigenvectorMatrix(){return O.isMatrix(this.V)||(this.V=new O(this.V)),this.V}get diagonalMatrix(){var t,e,r=this.n,n=this.e,i=this.d,o=new O(r,r);for(t=0;t<r;t++){for(e=0;e<r;e++)o[t][e]=0;o[t][t]=i[t],n[t]>0?o[t][t+1]=n[t]:n[t]<0&&(o[t][t-1]=n[t])}return o}}function L(t,e,r,n){var i,o;return Math.abs(r)>Math.abs(n)?[(t+(i=n/r)*e)/(o=r+i*n),(e-i*t)/o]:[((i=r/n)*t+e)/(o=n+i*r),(i*e-t)/o]}class q{constructor(t){if(!(t=F.checkMatrix(t)).isSymmetric())throw new Error("Matrix is not symmetric");var e,r,n,i=t,o=i.rows,s=new O(o,o),a=!0;for(r=0;r<o;r++){var u=s[r],h=0;for(n=0;n<r;n++){var c=s[n],l=0;for(e=0;e<n;e++)l+=c[e]*u[e];u[n]=l=(i.get(r,n)-l)/s[n][n],h+=l*l}for(a&=(h=i.get(r,r)-h)>0,s[r][r]=Math.sqrt(Math.max(h,0)),n=r+1;n<o;n++)s[r][n]=0}if(!a)throw new Error("Matrix is not positive definite");this.L=s}solve(t){t=F.checkMatrix(t);var e=this.L,r=e.rows;if(t.rows!==r)throw new Error("Matrix dimensions do not match");var n,i,o,s=t.columns,a=t.clone();for(o=0;o<r;o++)for(i=0;i<s;i++){for(n=0;n<o;n++)a[o][i]-=a[n][i]*e[o][n];a[o][i]/=e[o][o]}for(o=r-1;o>=0;o--)for(i=0;i<s;i++){for(n=o+1;n<r;n++)a[o][i]-=a[n][i]*e[n][o];a[o][i]/=e[o][o]}return a}get lowerTriangularMatrix(){return this.L}}r.d(e,"default",function(){return O}),r.d(e,"Matrix",function(){return O}),r.d(e,"abstractMatrix",function(){return R}),r.d(e,"wrap",function(){return T}),r.d(e,"WrapperMatrix2D",function(){return F}),r.d(e,"WrapperMatrix1D",function(){return C}),r.d(e,"solve",function(){return P}),r.d(e,"inverse",function(){return z}),r.d(e,"linearDependencies",function(){return V}),r.d(e,"SingularValueDecomposition",function(){return u}),r.d(e,"SVD",function(){return u}),r.d(e,"EigenvalueDecomposition",function(){return I}),r.d(e,"EVD",function(){return I}),r.d(e,"CholeskyDecomposition",function(){return q}),r.d(e,"CHO",function(){return q}),r.d(e,"LuDecomposition",function(){return o}),r.d(e,"LU",function(){return o}),r.d(e,"QrDecomposition",function(){return D}),r.d(e,"QR",function(){return D})},,,,,,,function(t,e,r){"use strict";function n(t,e){for(var r=0,n=0;n<t.length;n++)r+=(t[n]-e[n])*(t[n]-e[n]);return r}function i(t,e){return Math.sqrt(n(t,e))}t.exports=i,i.squared=n},,,,,,,,function(t,e,r){"use strict";e.array=r(101),e.matrix=r(20)},,,,,function(t,e,r){"use strict";var n=r(101);function i(t,e){return t-e}e.max=function(t){for(var e=-1/0,r=0;r<t.length;r++)for(var n=0;n<t[r].length;n++)t[r][n]>e&&(e=t[r][n]);return e},e.min=function(t){for(var e=1/0,r=0;r<t.length;r++)for(var n=0;n<t[r].length;n++)t[r][n]<e&&(e=t[r][n]);return e},e.minMax=function(t){for(var e=1/0,r=-1/0,n=0;n<t.length;n++)for(var i=0;i<t[n].length;i++)t[n][i]<e&&(e=t[n][i]),t[n][i]>r&&(r=t[n][i]);return{min:e,max:r}},e.entropy=function(t,e){void 0===e&&(e=0);for(var r=0,n=t.length,i=t[0].length,o=0;o<n;o++)for(var s=0;s<i;s++)r+=t[o][s]*Math.log(t[o][s]+e);return-r},e.mean=function(t,e){void 0===e&&(e=0);var r,n,i,o,s=t.length,a=t[0].length;if(-1===e){for(r=[0],n=s*a,i=0;i<s;i++)for(o=0;o<a;o++)r[0]+=t[i][o];r[0]/=n}else if(0===e)for(r=new Array(a),n=s,o=0;o<a;o++){for(r[o]=0,i=0;i<s;i++)r[o]+=t[i][o];r[o]/=n}else{if(1!==e)throw new Error("Invalid dimension");for(r=new Array(s),n=a,o=0;o<s;o++){for(r[o]=0,i=0;i<a;i++)r[o]+=t[o][i];r[o]/=n}}return r},e.sum=function(t,e){void 0===e&&(e=0);var r,n,i,o=t.length,s=t[0].length;if(-1===e)for(r=[0],n=0;n<o;n++)for(i=0;i<s;i++)r[0]+=t[n][i];else if(0===e)for(r=new Array(s),i=0;i<s;i++)for(r[i]=0,n=0;n<o;n++)r[i]+=t[n][i];else{if(1!==e)throw new Error("Invalid dimension");for(r=new Array(o),i=0;i<o;i++)for(r[i]=0,n=0;n<s;n++)r[i]+=t[i][n]}return r},e.product=function(t,e){void 0===e&&(e=0);var r,n,i,o=t.length,s=t[0].length;if(-1===e)for(r=[1],n=0;n<o;n++)for(i=0;i<s;i++)r[0]*=t[n][i];else if(0===e)for(r=new Array(s),i=0;i<s;i++)for(r[i]=1,n=0;n<o;n++)r[i]*=t[n][i];else{if(1!==e)throw new Error("Invalid dimension");for(r=new Array(o),i=0;i<o;i++)for(r[i]=1,n=0;n<s;n++)r[i]*=t[i][n]}return r},e.standardDeviation=function(t,r,n){for(var i=e.variance(t,r,n),o=i.length,s=0;s<o;s++)i[s]=Math.sqrt(i[s]);return i},e.variance=function(t,r,n){void 0===n&&(n=!0),r=r||e.mean(t);var i=t.length;if(0===i)return[];for(var o=t[0].length,s=new Array(o),a=0;a<o;a++){for(var u=0,h=0,c=0,l=0;l<i;l++)u+=c=t[l][a]-r[a],h+=c*c;s[a]=n?(h-u*u/i)/(i-1):(h-u*u/i)/i}return s},e.median=function(t){for(var e=t.length,r=t[0].length,n=new Array(r),o=0;o<r;o++){for(var s=new Array(e),a=0;a<e;a++)s[a]=t[a][o];s.sort(i);var u=s.length;n[o]=u%2==0?.5*(s[u/2]+s[u/2-1]):s[Math.floor(u/2)]}return n},e.mode=function(t){var e,r,n=t.length,i=t[0].length,o=new Array(i);for(e=0;e<i;e++){for(var s=new Array(n),a=0;a<n;a++)s[a]=0;var u=new Array(n),h=0;for(r=0;r<n;r++){var c=u.indexOf(t[r][e]);c>=0?s[c]++:(u[h]=t[r][e],s[h]=1,h++)}var l=0,f=0;for(r=0;r<h;r++)s[r]>l&&(l=s[r],f=r);o[e]=u[f]}return o},e.skewness=function(t,r){void 0===r&&(r=!0);for(var n=e.mean(t),i=t.length,o=n.length,s=new Array(o),a=0;a<o;a++){for(var u=0,h=0,c=0;c<i;c++){var l=t[c][a]-n[a];u+=l*l,h+=l*l*l}var f=u/i,p=h/i/Math.pow(f,1.5);if(r){var m=Math.sqrt(i*(i-1)),g=i-2;s[a]=m/g*p}else s[a]=p}return s},e.kurtosis=function(t,r){void 0===r&&(r=!0);for(var n=e.mean(t),i=t.length,o=t[0].length,s=new Array(o),a=0;a<o;a++){for(var u=0,h=0,c=0;c<i;c++){var l=t[c][a]-n[a];u+=l*l,h+=l*l*l*l}var f=u/i,p=h/i;if(r){var m=u/(i-1),g=i*(i+1)/((i-1)*(i-2)*(i-3)),d=h/(m*m),v=(i-1)*(i-1)/((i-2)*(i-3));s[a]=g*d-3*v}else s[a]=p/(f*f)-3}return s},e.standardError=function(t){for(var r=t.length,n=e.standardDeviation(t),i=n.length,o=new Array(i),s=Math.sqrt(r),a=0;a<i;a++)o[a]=n[a]/s;return o},e.covariance=function(t,r){return e.scatter(t,void 0,r)},e.scatter=function(t,r,n){void 0===n&&(n=0),void 0===r&&(0===n?r=t.length-1:1===n&&(r=t[0].length-1));var i=e.mean(t,n),o=t.length;if(0===o)return[[]];var s,a,u,h,c,l=t[0].length;if(0===n){for(s=new Array(l),a=0;a<l;a++)s[a]=new Array(l);for(a=0;a<l;a++)for(u=a;u<l;u++){for(h=0,c=0;c<o;c++)h+=(t[c][u]-i[u])*(t[c][a]-i[a]);h/=r,s[a][u]=h,s[u][a]=h}}else{if(1!==n)throw new Error("Invalid dimension");for(s=new Array(o),a=0;a<o;a++)s[a]=new Array(o);for(a=0;a<o;a++)for(u=a;u<o;u++){for(h=0,c=0;c<l;c++)h+=(t[u][c]-i[u])*(t[a][c]-i[a]);h/=r,s[a][u]=h,s[u][a]=h}}return s},e.correlation=function(t){var r,n,i=e.mean(t),o=e.standardDeviation(t,!0,i),s=e.zScores(t,i,o),a=t.length,u=t[0].length,h=new Array(u);for(r=0;r<u;r++)h[r]=new Array(u);for(r=0;r<u;r++)for(n=r;n<u;n++){for(var c=0,l=0,f=s.length;l<f;l++)c+=s[l][n]*s[l][r];c/=a-1,h[r][n]=c,h[n][r]=c}return h},e.zScores=function(t,r,n){return r=r||e.mean(t),void 0===n&&(n=e.standardDeviation(t,!0,r)),e.standardize(e.center(t,r,!1),n,!0)},e.center=function(t,r,n){r=r||e.mean(t);var i,o,s,a=t,u=t.length;if(!n)for(a=new Array(u),i=0;i<u;i++)a[i]=new Array(t[i].length);for(i=0;i<u;i++){var h=a[i];for(o=0,s=h.length;o<s;o++)h[o]=t[i][o]-r[o]}return a},e.standardize=function(t,r,n){void 0===r&&(r=e.standardDeviation(t));var i,o,s,a=t,u=t.length;if(!n)for(a=new Array(u),i=0;i<u;i++)a[i]=new Array(t[i].length);for(i=0;i<u;i++){var h=a[i],c=t[i];for(o=0,s=h.length;o<s;o++)0===r[o]||isNaN(r[o])||(h[o]=c[o]/r[o])}return a},e.weightedVariance=function(t,r){var n=e.mean(t),i=t.length;if(0===i)return[];for(var o=t[0].length,s=new Array(o),a=0;a<o;a++){for(var u=0,h=0,c=0,l=0;l<i;l++){var f=t[l][a]-n[a],p=r[l];u+=p*(f*f),c+=p,h+=p*p}s[a]=u*(c/(c*c-h))}return s},e.weightedMean=function(t,e,r){void 0===r&&(r=0);var i=t.length;if(0===i)return[];var o,s,a,u,h,c,l=t[0].length;if(0===r){for(o=new Array(l),s=0;s<l;s++)o[s]=0;for(s=0;s<i;s++)for(c=t[s],h=e[s],u=0;u<l;u++)o[u]+=c[u]*h}else{if(1!==r)throw new Error("Invalid dimension");for(o=new Array(i),s=0;s<i;s++)o[s]=0;for(u=0;u<i;u++)for(c=t[u],h=e[u],s=0;s<l;s++)o[u]+=c[s]*h}var f=n.sum(e);if(0!==f)for(s=0,a=o.length;s<a;s++)o[s]/=f;return o},e.weightedCovariance=function(t,r,n,i){i=i||0,n=n||e.weightedMean(t,r,i);for(var o=0,s=0,a=0,u=r.length;a<u;a++)o+=r[a],s+=r[a]*r[a];var h=o/(o*o-s);return e.weightedScatter(t,r,n,h,i)},e.weightedScatter=function(t,r,n,i,o){o=o||0,n=n||e.weightedMean(t,r,o),void 0===i&&(i=1);var s=t.length;if(0===s)return[[]];var a,u,h,c,l,f=t[0].length;if(0===o){for(a=new Array(f),u=0;u<f;u++)a[u]=new Array(f);for(u=0;u<f;u++)for(h=u;h<f;h++){for(l=0,c=0;c<s;c++)l+=r[c]*(t[c][h]-n[h])*(t[c][u]-n[u]);a[u][h]=l*i,a[h][u]=l*i}}else{if(1!==o)throw new Error("Invalid dimension");for(a=new Array(s),u=0;u<s;u++)a[u]=new Array(s);for(u=0;u<s;u++)for(h=u;h<s;h++){for(l=0,c=0;c<f;c++)l+=r[c]*(t[h][c]-n[h])*(t[u][c]-n[u]);a[u][h]=l*i,a[h][u]=l*i}}return a}},function(t,e,r){"use strict";Object.defineProperty(e,"__esModule",{value:!0});var n=r(104);e.EventHub={teachDataUpdated:{dispatch:function(t){}}},e.arrayBufferToBase64String=function(t){for(var e="",r=new Uint8Array(t),n=0;n<r.byteLength;n++)e+=String.fromCharCode(r[n]);return btoa(e)},e.base64ToArrayBuffer=function(t){for(var e=atob(t),r=e.length,n=new Uint8Array(r),i=0;i<r;i++)n[i]=e.charCodeAt(i);return n.buffer},e.sliceFloat32Array=function(t,e,r){if(t.slice)return t.slice(e,r);for(var n=new Float32Array(t.length),i=0;i<n.length;i++)n[i]=t[i];return n},e.Utils={clamp:function(t,e,r){return t<=e?e:t>=r?r:t},endsWith:function(t,e){return-1!==t.indexOf(e,t.length-e.length)},column:function(t,e){for(var r=[],n=0;n<t.length;n++)r.push(t[n][e]);return r},rangeOf:function(t){for(var e=Number.MAX_VALUE,r=Number.MIN_VALUE,n=0;n<t.length;n++){var i=t[n];i>r&&(r=i),i<e&&(e=i)}return{min:e,max:r}},median:function(t){var e=t.slice(t);//!!??
e.sort(function(t,e){return t-e});var r=Math.floor(e.length/2);return e.length%2?e[r]:(e[r-1]+e[r])/2},mean:function(t){for(var e=0,r=t.length,n=0;n<r;n++)e+=t[n];return e/r},std:function(t,r){void 0==r&&(r=e.Utils.mean(t));for(var n=0,i=t.length,o=0;o<i;o++){var s=t[o]-r;n+=s*s}return Math.sqrt(n/i)},rms:function(t){for(var e=0,r=t.length,n=0;n<r;n++)e+=t[n]*t[n];return Math.sqrt(e/r)},offset:function(t,e){for(var r=0;r<t.length;r++)t[r]+=e;return t},normalize:function(t,r,n){if(void 0===r&&(r=-1),void 0===n&&(n=1),1==t.length)t[0]=(r+n)/2;else for(var i=e.Utils.rangeOf(t),o=0;o<t.length;o++)t[o]=r+(n-r)*(t[o]-i.min)/(i.max-i.min);return t},adaptiveBoost:function(t,r){for(var i=new Float32Array(t.length),o=(new n.FeatureExtractor).extract("rms",t,2048),s=0;s<o.length;s++)o[s]=e.Utils.linToDb(o[s]);var a=e.Utils.rangeOf(o).min+r,u=0,h=!1;for(s=0;s<o.length;s++){if(o[s]>a){h=!0,(m=u+2048)>t.length&&(m=t.length);for(var c=u;c<m;c++)i[c]=t[c]}u+=2048}if(h){var l=e.Utils.rangeOf(i),f=Math.max(Math.abs(l.min),Math.abs(l.max));if(0!=f){f=1/f;var p=0;for(s=0;s<o.length;s++){if(o[s]>a){var m;(m=p+2048)>i.length&&(m=i.length);for(c=p;c<m;c++)i[c]*=f}p+=2048}}}return i},boostDb:function(t,r){var n=e.Utils.dbToLin(r),i=e.Utils.rangeOf(t),o=Math.max(Math.abs(i.min),Math.abs(i.max));if(0==o)return t;if(o*n>1&&(n=1/o),1==n)return t;for(var s=0;s<t.length;s++)t[s]*=n;return t},dbToLin:function(t){return Math.pow(10,t/20)},linToDb:function(t){return 0==t?1/0:20*Math.log(t)/Math.log(10)},roundOff:function(t){return Math.round(1e4*t)/1e4},validVectorInput:function(t,e){return t.length-e.length==0},dot:function(t,r){if(!e.Utils.validVectorInput(t,r))throw"invalid dot product input";for(var n=t.length,i=0,o=0;o<n;o++)i+=t[o]*r[o];return i},mag:function(t){var r=e.Utils.dot(t,t);return Math.sqrt(r)},cosineSimilarity:function(t,r){if(!e.Utils.validVectorInput(t,r))throw"invalid cosine similarity input";return e.Utils.dot(t,r)/(e.Utils.mag(t)*e.Utils.mag(r))},angularDistance:function(t,r){if(!e.Utils.validVectorInput(t,r))throw"invalid angular distance input";return Math.acos(e.Utils.cosineSimilarity(t,r))/Math.PI},angularSimilarity:function(t,r){if(!e.Utils.validVectorInput(t,r))throw"invalid angular similarity input";return 1-e.Utils.angularDistance(t,r)},euclideanDistance:function(t,r){if(!e.Utils.validVectorInput(t,r))throw"invalid euclidean distance input";for(var n=t.length,i=[],o=0;o<n;o++)i.push(t[o]-r[o]);return e.Utils.mag(i)},standardize:function(t,r,n){void 0===r&&(r=!0),void 0===n&&(n=!0);t.length;for(var i=e.Utils.mean(t),o=n?e.Utils.std(t,i):1,s=0;s<t.length;s++)r&&(t[s]-=i),n&&(t[s]/=o);return t},quadraticPeakPos:function(t,e){var r,n,i,o,s;return 0===e||e==t.length-1?e:(o=e<1?e:e-1,s=e+1<t.length?e+1:e,o==e?t[e]<=t[s]?e:s:s==e?t[e]<=t[o]?e:o:(r=t[o],n=t[e],e+.5*(r-(i=t[s]))/(r-2*n+i)))},minIdxOf:function(t){var e,r=0,n=t[0];for(e=0;e<t.length;e++)r=n<t[e]?r:e,n=n<t[e]?n:t[e];return r},minOf:function(t){for(var e=t[0],r=0;r<t.length;r++)e=e<t[r]?e:t[r];return e},maxOf:function(t){for(var e=t[0],r=0;r<t.length;r++)e=e>t[r]?e:t[r];return e},levelLinOf:function(t){for(var e=0,r=0;r<t.length;r++)e+=t[r]*t[r];return e/t.length},medianOf:function(t,e){var r=t.slice().sort(),n=Math.floor(r.length/2);return r.length%2||!e?r[n]:(r[n-1]+r[n])/2},meanOf:function(t){return e.Utils.sumOf(t)/t.length},sumOf:function(t){for(var e=0,r=0;r<t.length;r++)e+=t[r];return e},nonZerosOf:function(t){return t.filter(function(t){return t>0})},medianFilter:function(t,r){return r.shift(),r.push(t),e.Utils.medianOf(r,!1)}}},,,,,,,,,,function(t,e,r){"use strict";function n(t){if(!Array.isArray(t))throw new Error("input must be an array");if(0===t.length)throw new Error("input must not be empty");for(var e=0,r=0;r<t.length;r++)e+=t[r];return e/t.length}r.d(e,"a",function(){return n})},function(t,e,r){"use strict";r.r(e);var n=r(0),i=r(31);function o(t,e){for(var r=new Array(e).fill(0),i=0;i<t.length;++i)r[t[i]]+=1/t.length;return n.default.rowVector(r)}function s(t){if(0===t.length)return 0;for(var e=o(t,a(t))[0],r=0,n=0;n<e.length;++n)r+=e[n]*e[n];return 1-r}function a(t){return t.filter(function(t,e,r){return r.indexOf(t)===e}).length}function u(t){for(var e=t.length,r=Object(i.a)(t),n=0,o=0;o<e;++o){var s=t[o];n+=(s-r)*(s-r)}return n}const h={gini:function(t,e){for(var r=0,n=["greater","lesser"],i=0;i<n.length;++i){var o=e[n[i]];r+=s(o)*o.length/t.length}return s(t)-r},regression:function(t,e){for(var r=0,n=["greater","lesser"],i=0;i<n.length;++i)r+=u(e[n[i]]);return r}},c={mean:function(t,e){return(t+e)/2}};class l{constructor(t){this.kind=t.kind,this.gainFunction=t.gainFunction,this.splitFunction=t.splitFunction,this.minNumSamples=t.minNumSamples,this.maxDepth=t.maxDepth}bestSplit(t,e){for(var r,n,i="classifier"===this.kind?-1/0:1/0,o="classifier"===this.kind?(t,e)=>t>e:(t,e)=>t<e,s=0;s<t.rows;++s)for(var a=t[s],u=this.featureSplit(a,e),c=0;c<u.length;++c){var l=u[c],f=this.split(a,e,l),p=h[this.gainFunction](e,f);o(p,i)&&(r=s,n=l,i=p)}return{maxGain:i,maxColumn:r,maxValue:n}}split(t,e,r){for(var n=[],i=[],o=0;o<t.length;++o)t[o]<r?n.push(e[o]):i.push(e[o]);return{greater:i,lesser:n}}featureSplit(t,e){var r=[],n=function(t,e){if(t.length!==e.length)throw new TypeError("Error on zip: the size of a: "+t.length+" is different from b: "+e.length);for(var r=new Array(t.length),n=0;n<t.length;++n)r[n]=[t[n],e[n]];return r}(t,e);n.sort(function(t,e){return t[0]-e[0]});for(var i=1;i<n.length;++i)n[i-1][1]!==n[i][1]&&r.push(c[this.splitFunction](n[i-1][0],n[i][0]));return r}calculatePrediction(t){if("classifier"===this.kind){if(this.distribution=o(t,a(t)),0===this.distribution.columns)throw new TypeError("Error on calculate the prediction")}else this.distribution=Object(i.a)(t)}train(t,e,r,i){if(t.rows<=this.minNumSamples)this.calculatePrediction(e);else{void 0===i&&(i=0);var o=t.transpose(),s=this.bestSplit(o,e);this.splitValue=s.maxValue,this.splitColumn=s.maxColumn,this.gain=s.maxGain;var a=function(t,e,r,n){for(var i=[],o=[],s=[],a=[],u=0;u<t.rows;++u)t[u][r]<n?(i.push(t[u]),s.push(e[u])):(o.push(t[u]),a.push(e[u]));return{greaterX:o,greaterY:a,lesserX:i,lesserY:s}}(t,e,this.splitColumn,this.splitValue);if(r<this.maxDepth&&this.gain>.01&&this.gain!==i&&a.lesserX.length>0&&a.greaterX.length>0){this.left=new l(this),this.right=new l(this);var u=new n.default(a.lesserX),h=new n.default(a.greaterX);this.left.train(u,a.lesserY,r+1,this.gain),this.right.train(h,a.greaterY,r+1,this.gain)}else this.calculatePrediction(e)}}classify(t){return this.right&&this.left?t[this.splitColumn]<this.splitValue?this.left.classify(t):this.right.classify(t):this.distribution}setNodeParameters(t){void 0!==t.distribution?this.distribution=t.distribution.constructor===Array?new n.default(t.distribution):t.distribution:(this.distribution=void 0,this.splitValue=t.splitValue,this.splitColumn=t.splitColumn,this.gain=t.gain,this.left=new l(this),this.right=new l(this),t.left!=={}&&this.left.setNodeParameters(t.left),t.right!=={}&&this.right.setNodeParameters(t.right))}}const f={gainFunction:"gini",splitFunction:"mean",minNumSamples:3,maxDepth:1/0};class p{constructor(t,e){!0===t?(this.options=e.options,this.root=new l(e.options),this.root.setNodeParameters(e.root)):(this.options=Object.assign({},f,t),this.options.kind="classifier")}train(t,e){this.root=new l(this.options),t=n.default.checkMatrix(t),this.root.train(t,e,0,null)}predict(t){t=n.default.checkMatrix(t);for(var e=new Array(t.rows),r=0;r<t.rows;++r)e[r]=this.root.classify(t.getRow(r)).maxRowIndex(0)[1];return e}toJSON(){return{options:this.options,root:this.root,name:"DTClassifier"}}static load(t){if("DTClassifier"!==t.name)throw new RangeError("Invalid model: "+t.name);return new p(!0,t)}}const m={gainFunction:"regression",splitFunction:"mean",minNumSamples:3,maxDepth:1/0};class g{constructor(t,e){!0===t?(this.options=e.options,this.root=new l(e.options),this.root.setNodeParameters(e.root)):(this.options=Object.assign({},m,t),this.options.kind="regression")}train(t,e){this.root=new l(this.options),void 0===t[0].length&&(t=n.default.columnVector(t)),t=n.default.checkMatrix(t),this.root.train(t,e,0)}predict(t){void 0!==t[0]&&void 0===t[0].length&&(t=n.default.columnVector(t)),t=n.default.checkMatrix(t);for(var e=new Array(t.rows),r=0;r<t.rows;++r)e[r]=this.root.classify(t.getRow(r));return e}toJSON(){return{options:this.options,root:this.root,name:"DTRegression"}}static load(t){if("DTRegression"!==t.name)throw new RangeError("Invalid model:"+t.name);return new g(!0,t)}}r.d(e,"DecisionTreeClassifier",function(){return p}),r.d(e,"DecisionTreeRegression",function(){return g})},,,,,function(t,e){var r;r=function(){return this}();try{r=r||Function("return this")()||(0,eval)("this")}catch(t){"object"==typeof window&&(r=window)}t.exports=r},,,function(t,e,r){"use strict";const n=r(0).Matrix,i=r(240),o=r(239),s=r(238),a=r(237),u=r(236),h=r(235),c=r(234),l=r(233),f=r(232),p=r(231),m={gaussian:i,rbf:i,polynomial:o,poly:o,anova:s,cauchy:a,exponential:u,histogram:h,min:h,laplacian:c,multiquadratic:l,rational:f,sigmoid:p,mlp:p};t.exports=class{constructor(t,e){if(this.kernelType=t,"linear"!==t)if("string"==typeof t){t=t.toLowerCase();var r=m[t];if(!r)throw new Error("unsupported kernel type: "+t);this.kernelFunction=new r(e)}else{if("object"!=typeof t||"function"!=typeof t.compute)throw new TypeError("first argument must be a valid kernel type or instance");this.kernelFunction=t}}compute(t,e){if(void 0===e&&(e=t),"linear"===this.kernelType)return new n(t).mmul(new n(e).transposeView());const r=new n(t.length,e.length);var i,o;if(t===e)for(i=0;i<t.length;i++)for(o=i;o<t.length;o++)r[i][o]=r[o][i]=this.kernelFunction.compute(t[i],t[o]);else for(i=0;i<t.length;i++)for(o=0;o<e.length;o++)r[i][o]=this.kernelFunction.compute(t[i],e[o]);return r}}},function(t,e,r){var n;!function(i){"use strict";var o="function"!=typeof Math.imul||-5!==Math.imul(4294967295,5)?function(t,e){var r=65535&t,n=65535&e;return r*n+((t>>>16&65535)*n+r*(e>>>16&65535)<<16>>>0)|0}:Math.imul,s="function"==typeof String.prototype.repeat&&"xxx"==="x".repeat(3)?function(t,e){return t.repeat(e)}:function(t,e){for(var r="";e>0;)1&e&&(r+=t),e>>=1,t+=t;return r};function a(t){if(!(this instanceof a))return new a(t);if(null==t)t=a.engines.nativeMath;else if("function"!=typeof t)throw new TypeError("Expected engine to be a function, got "+typeof t);this.engine=t}var u,h,c=a.prototype;function l(t){return function(){return t}}function f(t,e){return 0===e?t:function(r){return t(r)+e}}function p(t){var e=+t;return e<0?Math.ceil(e):Math.floor(e)}function m(t,e){return t<0?Math.max(t+e,0):Math.min(t,e)}function g(){}a.engines={nativeMath:function(){return 4294967296*Math.random()|0},mt19937:function(t){function e(t){for(var e=0,r=0;(0|e)<227;e=e+1|0)r=2147483648&t[e]|2147483647&t[e+1|0],t[e]=t[e+397|0]^r>>>1^(1&r?2567483615:0);for(;(0|e)<623;e=e+1|0)r=2147483648&t[e]|2147483647&t[e+1|0],t[e]=t[e-227|0]^r>>>1^(1&r?2567483615:0);r=2147483648&t[623]|2147483647&t[0],t[623]=t[396]^r>>>1^(1&r?2567483615:0)}return function(){var r=new t(624),n=0,i=0;function s(){(0|n)>=624&&(e(r),n=0);var t=r[n];return n=n+1|0,i+=1,0|function(t){return t^=t>>>11,t^=t<<7&2636928640,(t^=t<<15&4022730752)^t>>>18}(t)}return s.getUseCount=function(){return i},s.discard=function(t){for(i+=t,(0|n)>=624&&(e(r),n=0);t-n>624;)t-=624-n,e(r),n=0;return n=n+t|0,s},s.seed=function(t){var e=0;r[0]=e=0|t;for(var a=1;a<624;a=a+1|0)r[a]=e=o(e^e>>>30,1812433253)+a|0;return n=624,i=0,s},s.seedWithArray=function(t){return s.seed(19650218),function(t,e){for(var r=1,n=0,i=e.length,s=0|Math.max(i,624),a=0|t[0];(0|s)>0;--s)t[r]=a=(t[r]^o(a^a>>>30,1664525))+(0|e[n])+(0|n)|0,++n,(0|(r=r+1|0))>623&&(t[0]=t[623],r=1),n>=i&&(n=0);for(s=623;(0|s)>0;--s)t[r]=a=(t[r]^o(a^a>>>30,1566083941))-r|0,(0|(r=r+1|0))>623&&(t[0]=t[623],r=1);t[0]=2147483648}(r,t),s},s.autoSeed=function(){return s.seedWithArray(a.generateEntropyArray())},s}}("function"==typeof Int32Array?Int32Array:Array),browserCrypto:"undefined"!=typeof crypto&&"function"==typeof crypto.getRandomValues&&"function"==typeof Int32Array?(u=null,h=128,function(){return h>=128&&(null===u&&(u=new Int32Array(128)),crypto.getRandomValues(u),h=0),0|u[h++]}):null},a.generateEntropyArray=function(){for(var t=[],e=a.engines.nativeMath,r=0;r<16;++r)t[r]=0|e();return t.push(0|(new Date).getTime()),t},a.int32=function(t){return 0|t()},c.int32=function(){return a.int32(this.engine)},a.uint32=function(t){return t()>>>0},c.uint32=function(){return a.uint32(this.engine)},a.uint53=function(t){return 4294967296*(2097151&t())+(t()>>>0)},c.uint53=function(){return a.uint53(this.engine)},a.uint53Full=function(t){for(;;){var e=0|t();if(!(2097152&e))return 4294967296*(2097151&e)+(t()>>>0);if(2097152==(4194303&e)&&0==(0|t()))return 9007199254740992}},c.uint53Full=function(){return a.uint53Full(this.engine)},a.int53=function(t){var e=0|t();return 4294967296*(2097151&e)+(t()>>>0)+(2097152&e?-9007199254740992:0)},c.int53=function(){return a.int53(this.engine)},a.int53Full=function(t){for(;;){var e=0|t();if(!(4194304&e))return 4294967296*(2097151&e)+(t()>>>0)+(2097152&e?-9007199254740992:0);if(4194304==(8388607&e)&&0==(0|t()))return 9007199254740992}},c.int53Full=function(){return a.int53Full(this.engine)},a.integer=function(){function t(t){return 0==(t+1&t)}function e(e){return t(e)?(r=e,function(t){return t()&r}):function(t){var e=t+1,r=e*Math.floor(4294967296/e);return function(t){var n=0;do{n=t()>>>0}while(n>=r);return n%e}}(e);var r}function r(e){var r,n=e+1;if(0==(0|n)){var i=(n/4294967296|0)-1;if(t(i))return r=i,function(t){return 4294967296*(t()&r)+(t()>>>0)}}return function(t){var e=t*Math.floor(9007199254740992/t);return function(r){var n=0;do{n=4294967296*(2097151&r())+(r()>>>0)}while(n>=e);return n%t}}(n)}function n(t,e){return function(r){var n=0;do{var i=0|r();n=4294967296*(2097151&i)+(r()>>>0)+(2097152&i?-9007199254740992:0)}while(n<t||n>e);return n}}return function(t,i){if(t=Math.floor(t),i=Math.floor(i),t<-9007199254740992||!isFinite(t))throw new RangeError("Expected min to be at least -9007199254740992");if(i>9007199254740992||!isFinite(i))throw new RangeError("Expected max to be at most 9007199254740992");var o=i-t;return o<=0||!isFinite(o)?l(t):4294967295===o?0===t?a.uint32:f(a.int32,t+2147483648):o<4294967295?f(e(o),t):9007199254740991===o?f(a.uint53,t):o<9007199254740991?f(r(o),t):i-1-t==9007199254740991?f(a.uint53Full,t):-9007199254740992===t&&9007199254740992===i?a.int53Full:-9007199254740992===t&&9007199254740991===i?a.int53:-9007199254740991===t&&9007199254740992===i?f(a.int53,1):9007199254740992===i?f(n(t-1,i-1),1):n(t,i)}}(),c.integer=function(t,e){return a.integer(t,e)(this.engine)},a.realZeroToOneInclusive=function(t){return a.uint53Full(t)/9007199254740992},c.realZeroToOneInclusive=function(){return a.realZeroToOneInclusive(this.engine)},a.realZeroToOneExclusive=function(t){return a.uint53(t)/9007199254740992},c.realZeroToOneExclusive=function(){return a.realZeroToOneExclusive(this.engine)},a.real=function(){return function(t,e,r){if(!isFinite(t))throw new RangeError("Expected left to be a finite number");if(!isFinite(e))throw new RangeError("Expected right to be a finite number");return f((n=r?a.realZeroToOneInclusive:a.realZeroToOneExclusive,1===(i=e-t)?n:0===i?function(){return 0}:function(t){return n(t)*i}),t);var n,i}}(),c.real=function(t,e,r){return a.real(t,e,r)(this.engine)},a.bool=function(){function t(t){return 1==(1&t())}function e(t,e){return function(r){return t(r)<e}}return function(r,n){return null==n?null==r?t:function(t){if(t<=0)return l(!1);if(t>=1)return l(!0);var r=4294967296*t;return r%1==0?e(a.int32,r-2147483648|0):e(a.uint53,Math.round(9007199254740992*t))}(r):r<=0?l(!1):r>=n?l(!0):e(a.integer(0,n-1),r)}}(),c.bool=function(t,e){return a.bool(t,e)(this.engine)},a.pick=function(t,e,r,n){var i=e.length,o=null==r?0:m(p(r),i),s=void 0===n?i:m(p(n),i);if(!(o>=s))return e[a.integer(o,s-1)(t)]},c.pick=function(t,e,r){return a.pick(this.engine,t,e,r)};var d,v,y=Array.prototype.slice;a.picker=function(t,e,r){var n=y.call(t,e,r);if(!n.length)return g;var i=a.integer(0,n.length-1);return function(t){return n[i(t)]}},a.shuffle=function(t,e,r){var n=e.length;if(n){null==r&&(r=0);for(var i=n-1>>>0;i>r;--i){var o=a.integer(0,i)(t);if(i!==o){var s=e[i];e[i]=e[o],e[o]=s}}}return e},c.shuffle=function(t){return a.shuffle(this.engine,t)},a.sample=function(t,e,r){if(r<0||r>e.length||!isFinite(r))throw new RangeError("Expected sampleSize to be within 0 and the length of the population");if(0===r)return[];var n=y.call(e),i=n.length;if(i===r)return a.shuffle(t,n,0);var o=i-r;return a.shuffle(t,n,o-1).slice(o)},c.sample=function(t,e){return a.sample(this.engine,t,e)},a.die=function(t){return a.integer(1,t)},c.die=function(t){return a.die(t)(this.engine)},a.dice=function(t,e){var r=a.die(t);return function(t){var n=[];n.length=e;for(var i=0;i<e;++i)n[i]=r(t);return n}},c.dice=function(t,e){return a.dice(t,e)(this.engine)},a.uuid4=function(){function t(t,e){return s("0",e-t.length)+t}return function(e){var r=e()>>>0,n=0|e(),i=0|e(),o=e()>>>0;return t(r.toString(16),8)+"-"+t((65535&n).toString(16),4)+"-"+t((n>>4&4095|16384).toString(16),4)+"-"+t((16383&i|32768).toString(16),4)+"-"+t((i>>4&65535).toString(16),4)+t(o.toString(16),8)}}(),c.uuid4=function(){return a.uuid4(this.engine)},a.string=function(t){null==t&&(t="abcdefghijklmnopqrstuvwxyzABCDEFGHIJKLMNOPQRSTUVWXYZ0123456789_-");var e=t.length;if(!e)throw new Error("Expected pool not to be an empty string");var r=a.integer(0,e-1);return function(e,n){for(var i="",o=0;o<n;++o){var s=r(e);i+=t.charAt(s)}return i}},c.string=function(t,e){return a.string(e)(this.engine,t)},a.hex=(d=a.string("0123456789abcdef"),v=a.string("0123456789abcdef".toUpperCase()),function(t){return t?v:d}),c.hex=function(t,e){return a.hex(e)(this.engine,t)},a.date=function(t,e){if(!(t instanceof Date))throw new TypeError("Expected start to be a Date, got "+typeof t);if(!(e instanceof Date))throw new TypeError("Expected end to be a Date, got "+typeof e);var r=a.integer(t.getTime(),e.getTime());return function(t){return new Date(r(t))}},c.date=function(t,e){return a.date(t,e)(this.engine)},void 0===(n=function(){return a}.call(e,r,e,t))||(t.exports=n)}()},,,,,,,,,,,,function(t,e){var r,n,i=t.exports={};function o(){throw new Error("setTimeout has not been defined")}function s(){throw new Error("clearTimeout has not been defined")}function a(t){if(r===setTimeout)return setTimeout(t,0);if((r===o||!r)&&setTimeout)return r=setTimeout,setTimeout(t,0);try{return r(t,0)}catch(e){try{return r.call(null,t,0)}catch(e){return r.call(this,t,0)}}}!function(){try{r="function"==typeof setTimeout?setTimeout:o}catch(t){r=o}try{n="function"==typeof clearTimeout?clearTimeout:s}catch(t){n=s}}();var u,h=[],c=!1,l=-1;function f(){c&&u&&(c=!1,u.length?h=u.concat(h):l=-1,h.length&&p())}function p(){if(!c){var t=a(f);c=!0;for(var e=h.length;e;){for(u=h,h=[];++l<e;)u&&u[l].run();l=-1,e=h.length}u=null,c=!1,function(t){if(n===clearTimeout)return clearTimeout(t);if((n===s||!n)&&clearTimeout)return n=clearTimeout,clearTimeout(t);try{n(t)}catch(e){try{return n.call(null,t)}catch(e){return n.call(this,t)}}}(t)}}function m(t,e){this.fun=t,this.array=e}function g(){}i.nextTick=function(t){var e=new Array(arguments.length-1);if(arguments.length>1)for(var r=1;r<arguments.length;r++)e[r-1]=arguments[r];h.push(new m(t,e)),1!==h.length||c||a(p)},m.prototype.run=function(){this.fun.apply(null,this.array)},i.title="browser",i.browser=!0,i.env={},i.argv=[],i.version="",i.versions={},i.on=g,i.addListener=g,i.once=g,i.off=g,i.removeListener=g,i.removeAllListeners=g,i.emit=g,i.prependListener=g,i.prependOnceListener=g,i.listeners=function(t){return[]},i.binding=function(t){throw new Error("process.binding is not supported")},i.cwd=function(){return"/"},i.chdir=function(t){throw new Error("process.chdir is not supported")},i.umask=function(){return 0}},,,,,,,function(t,e,r){"use strict";const n=r(222),i=r(221),o=i.nextPrime,s=i.largestPrime,a=0,u=1,h=2,c=150,l=1/6,f=2/3;class p{constructor(t={}){if(t instanceof p)return this.table=t.table.slice(),this.values=t.values.slice(),this.state=t.state.slice(),this.minLoadFactor=t.minLoadFactor,this.maxLoadFactor=t.maxLoadFactor,this.distinct=t.distinct,this.freeEntries=t.freeEntries,this.lowWaterMark=t.lowWaterMark,void(this.highWaterMark=t.maxLoadFactor);const e=void 0===t.initialCapacity?c:t.initialCapacity;if(e<0)throw new RangeError(`initial capacity must not be less than zero: ${e}`);const r=void 0===t.minLoadFactor?l:t.minLoadFactor,i=void 0===t.maxLoadFactor?f:t.maxLoadFactor;if(r<0||r>=1)throw new RangeError(`invalid minLoadFactor: ${r}`);if(i<=0||i>=1)throw new RangeError(`invalid maxLoadFactor: ${i}`);if(r>=i)throw new RangeError(`minLoadFactor (${r}) must be smaller than maxLoadFactor (${i})`);let a=e;0===(a=o(a=a/i|0))&&(a=1),this.table=n(a,0),this.values=n(a,0),this.state=n(a,0),this.minLoadFactor=r,this.maxLoadFactor=a===s?1:i,this.distinct=0,this.freeEntries=a,this.lowWaterMark=0,this.highWaterMark=m(a,this.maxLoadFactor)}clone(){return new p(this)}get size(){return this.distinct}get(t){const e=this.indexOfKey(t);return e<0?0:this.values[e]}set(t,e){let r=this.indexOfInsertion(t);if(r<0)return r=-r-1,this.values[r]=e,!1;if(this.distinct>this.highWaterMark){const r=g(this.distinct+1,this.minLoadFactor,this.maxLoadFactor);return this.rehash(r),this.set(t,e)}if(this.table[r]=t,this.values[r]=e,this.state[r]===a&&this.freeEntries--,this.state[r]=u,this.distinct++,this.freeEntries<1){const t=g(this.distinct+1,this.minLoadFactor,this.maxLoadFactor);this.rehash(t)}return!0}remove(t,e){const r=this.indexOfKey(t);return!(r<0)&&(this.state[r]=h,this.distinct--,e||this.maybeShrinkCapacity(),!0)}delete(t,e){const r=this.indexOfKey(t);return!(r<0)&&(this.state[r]=a,this.distinct--,e||this.maybeShrinkCapacity(),!0)}maybeShrinkCapacity(){if(this.distinct<this.lowWaterMark){const n=(t=this.distinct,e=this.minLoadFactor,r=this.maxLoadFactor,o(Math.max(t+1,4*t/(e+3*r)|0)));this.rehash(n)}var t,e,r}containsKey(t){return this.indexOfKey(t)>=0}indexOfKey(t){const e=this.table,r=this.state,n=this.table.length,i=2147483647&t;let o=i%n,s=i%(n-2);for(0===s&&(s=1);r[o]!==a&&(r[o]===h||e[o]!==t);)(o-=s)<0&&(o+=n);return r[o]===a?-1:o}containsValue(t){return this.indexOfValue(t)>=0}indexOfValue(t){const e=this.values,r=this.state;for(var n=0;n<r.length;n++)if(r[n]===u&&e[n]===t)return n;return-1}indexOfInsertion(t){const e=this.table,r=this.state,n=e.length,i=2147483647&t;let o=i%n,s=i%(n-2);for(0===s&&(s=1);r[o]===u&&e[o]!==t;)(o-=s)<0&&(o+=n);if(r[o]===h){const i=o;for(;r[o]!==a&&(r[o]===h||e[o]!==t);)(o-=s)<0&&(o+=n);r[o]===a&&(o=i)}return r[o]===u?-o-1:o}ensureCapacity(t){if(this.table.length<t){const e=o(t);this.rehash(e)}}rehash(t){const e=this.table.length;if(t<=this.distinct)throw new Error("Unexpected");const r=this.table,i=this.values,o=this.state,s=n(t,0),a=n(t,0),h=n(t,0);var c,l;this.lowWaterMark=(c=t,l=this.minLoadFactor,c*l|0),this.highWaterMark=m(t,this.maxLoadFactor),this.table=s,this.values=a,this.state=h,this.freeEntries=t-this.distinct;for(var f=0;f<e;f++)if(o[f]===u){var p=r[f],g=this.indexOfInsertion(p);s[g]=p,a[g]=i[f],h[g]=u}}forEachKey(t){for(var e=0;e<this.state.length;e++)if(this.state[e]===u&&!t(this.table[e]))return!1;return!0}forEachValue(t){for(var e=0;e<this.state.length;e++)if(this.state[e]===u&&!t(this.values[e]))return!1;return!0}forEachPair(t){for(var e=0;e<this.state.length;e++)if(this.state[e]===u&&!t(this.table[e],this.values[e]))return!1;return!0}}function m(t,e){return Math.min(t-2,t*e|0)}function g(t,e,r){return o(Math.max(t+1,4*t/(3*e+r)|0))}t.exports=p},function(t,e,r){"use strict";var n=Object.prototype.hasOwnProperty,i=Object.prototype.toString,o=function(t){return"function"==typeof Array.isArray?Array.isArray(t):"[object Array]"===i.call(t)},s=function(t){if(!t||"[object Object]"!==i.call(t))return!1;var e,r=n.call(t,"constructor"),o=t.constructor&&t.constructor.prototype&&n.call(t.constructor.prototype,"isPrototypeOf");if(t.constructor&&!r&&!o)return!1;for(e in t);return void 0===e||n.call(t,e)};t.exports=function t(){var e,r,n,i,a,u,h=arguments[0],c=1,l=arguments.length,f=!1;for("boolean"==typeof h&&(f=h,h=arguments[1]||{},c=2),(null==h||"object"!=typeof h&&"function"!=typeof h)&&(h={});c<l;++c)if(null!=(e=arguments[c]))for(r in e)n=h[r],h!==(i=e[r])&&(f&&i&&(s(i)||(a=o(i)))?(a?(a=!1,u=n&&o(n)?n:[]):u=n&&s(n)?n:{},h[r]=t(f,u,i)):void 0!==i&&(h[r]=i));return h}},function(t,e,r){"use strict";const n=r(247);function i(){this.children=[],this.distance=-1,this.index=[]}i.prototype.cut=function(t){if(t<0)throw new RangeError("Threshold too small");var e=new i;e.children=this.children,e.distance=this.distance,e.index=this.index;for(var r=[e],n=[];r.length>0;){var o=r.shift();t>=o.distance?n.push(o):r=r.concat(o.children)}return n},i.prototype.group=function(t){if(!Number.isInteger(t)||t<1)throw new RangeError("Number of groups must be a positive integer");const e=new n(function(t,e){return e.distance-t.distance});for(e.push(this);e.size()<t;){var r=e.pop();if(0===r.children.length)break;r.children.forEach(t=>e.push(t))}var o=new i;return o.children=e.toArray(),o.distance=this.distance,o},i.prototype.traverse=function(t){!function t(e,r){if(r(e),e.children)for(var n=e.children.length-1;n>=0;n--)t(e.children[n],r)}(this,t)},t.exports=i},function(t,e,r){"use strict";Object.defineProperty(e,"__esModule",{value:!0}),e.initWorker=function(t,e){console.log(t+" worker started"),onmessage=function(t){e(t.data.cmd).then(function(e){if(e){var r=e[0],n=e[1];postMessage({id:t.data.id,resp:r},n)}})}}},function(t,e,r){"use strict";Object.defineProperty(e,"__esModule",{value:!0});var n=function(){function t(){this.queue=[],this.working=!1}return t.prototype.defer=function(t,e){var r=this;return new Promise(function(n){return r.add({f:function(){n(t())},taskId:e})})},t.prototype.remove=function(t){var e=this.queue.findIndex(function(e){return e.taskId==t});e>=0&&this.queue.splice(e,1)},t.prototype.clear=function(){this.queue.length>0&&(this.queue=[])},t.prototype.add=function(t){this.queue.push(t),this.working||this.startWorking()},t.prototype.startWorking=function(){var t=this;this.working=!0,setTimeout(function(){return t.work()},0)},t.prototype.work=function(){var t=this,e=this.queue.shift();e?(e.f(),setTimeout(function(){return t.work()},0)):this.working=!1},t}();e.TaskQueue=n},,,,,,,,,,,,,,,function(t,e,r){"use strict";function n(t,e){return t<0?(t=0-t,"number"==typeof e?"- "+t.toPrecision(e):"- "+t.toString()):"number"==typeof e?t.toPrecision(e):t.toString()}function i(t,e){if(!Array.isArray(t)||!Array.isArray(e))throw new TypeError("x and y must be arrays");if(t.length!==e.length)throw new RangeError("x and y arrays must have the same length")}r.r(e);class o{constructor(){if(new.target===o)throw new Error("BaseRegression must be subclassed")}predict(t){if("number"==typeof t)return this._predict(t);if(Array.isArray(t)){const e=new Array(t.length);for(let r=0;r<t.length;r++)e[r]=this._predict(t[r]);return e}throw new TypeError("x must be a number or array")}_predict(){throw new Error("_predict must be implemented")}train(){}toString(){return""}toLaTeX(){return""}score(t,e){if(!Array.isArray(t)||!Array.isArray(e)||t.length!==e.length)throw new Error("x and y must be arrays of the same length");const r=t.length,n=new Array(r);for(let e=0;e<r;e++)n[e]=this._predict(t[e]);let i=0,o=0,s=0,a=0,u=0,h=0,c=0;for(let t=0;t<r;t++)i+=n[t],o+=e[t],u+=n[t]*n[t],h+=e[t]*e[t],c+=n[t]*e[t],0!==e[t]&&(s+=(e[t]-n[t])*(e[t]-n[t])/e[t]),a=(e[t]-n[t])*(e[t]-n[t]);const l=(r*c-i*o)/Math.sqrt((r*u-i*i)*(r*h-o*o));return{r:l,r2:l*l,chi2:s,rmsd:a*a/r}}}class s extends o{constructor(t,e){super(),!0===t?(this.slope=e.slope,this.intercept=e.intercept,this.coefficients=[e.intercept,e.slope]):(i(t,e),function(t,e,r){const n=e.length;let i=0,o=0,s=0,a=0;for(let t=0;t<n;t++)i+=e[t],o+=r[t],s+=e[t]*e[t],a+=e[t]*r[t];const u=n*a-i*o;t.slope=u/(n*s-i*i),t.intercept=1/n*o-t.slope*(1/n)*i,t.coefficients=[t.intercept,t.slope]}(this,t,e))}toJSON(){return{name:"simpleLinearRegression",slope:this.slope,intercept:this.intercept}}_predict(t){return this.slope*t+this.intercept}computeX(t){return(t-this.intercept)/this.slope}toString(t){let e="f(x) = ";if(0!==this.slope){const r=n(this.slope,t);if(e+=("1"===r?"":r+" * ")+"x",this.intercept){const r=Math.abs(this.intercept);e+=` ${r===this.intercept?"+":"-"} ${n(r,t)}`}}else e+=n(this.intercept,t);return e}toLaTeX(t){return this.toString(t)}static load(t){if("simpleLinearRegression"!==t.name)throw new TypeError("not a SLR model");return new s(!0,t)}}var a=r(0);class u extends o{constructor(t,e,r){super(),!0===t?(this.degree=e.degree,this.powers=e.powers,this.coefficients=e.coefficients):(i(t,e),function(t,e,r,n){const i=e.length;let o;if(Array.isArray(n))n=(o=n).length;else{n++,o=new Array(n);for(let t=0;t<n;t++)o[t]=t}const s=new a.default(i,n),u=new a.default([r]);for(let t=0;t<n;t++)for(let r=0;r<i;r++)0===o[t]?s[r][t]=1:s[r][t]=Math.pow(e[r],o[t]);const h=s.transposeView(),c=h.mmul(s),l=h.mmul(u.transposeView());t.degree=n-1,t.powers=o,t.coefficients=Object(a.solve)(c,l).to1DArray()}(this,t,e,r))}_predict(t){let e=0;for(let r=0;r<this.powers.length;r++)e+=this.coefficients[r]*Math.pow(t,this.powers[r]);return e}toJSON(){return{name:"polynomialRegression",degree:this.degree,powers:this.powers,coefficients:this.coefficients}}toString(t){return this._toFormula(t,!1)}toLaTeX(t){return this._toFormula(t,!0)}_toFormula(t,e){let r="^",i="",o=" * ";e&&(r="^{",i="}",o="");let s="",a="";for(let e=0;e<this.coefficients.length;e++)a="",0!==this.coefficients[e]&&(a=0===this.powers[e]?n(this.coefficients[e],t):1===this.powers[e]?n(this.coefficients[e],t)+o+"x":n(this.coefficients[e],t)+o+"x"+r+this.powers[e]+i,this.coefficients[e]>0&&e!==this.coefficients.length-1?a=" + "+a:e!==this.coefficients.length-1&&(a=" "+a)),s=a+s;return"+"===s.charAt(0)&&(s=s.slice(1)),"f(x) = "+s}static load(t){if("polynomialRegression"!==t.name)throw new TypeError("not a polynomial regression model");return new u(!0,t)}}class h extends o{constructor(t,e){super(),!0===t?(this.A=e.A,this.B=e.B):(i(t,e),function(t,e,r){const n=e.length,i=new Array(n);for(let t=0;t<n;t++)i[t]=Math.log(r[t]);const o=new s(e,i);t.A=o.slope,t.B=Math.exp(o.intercept)}(this,t,e))}_predict(t){return this.B*Math.exp(t*this.A)}toJSON(){return{name:"exponentialRegression",A:this.A,B:this.B}}toString(t){return"f(x) = "+n(this.B,t)+" * e^("+n(this.A,t)+" * x)"}toLaTeX(t){return this.A>=0?"f(x) = "+n(this.B,t)+"e^{"+n(this.A,t)+"x}":"f(x) = \\frac{"+n(this.B,t)+"}{e^{"+n(-this.A,t)+"x}}"}static load(t){if("exponentialRegression"!==t.name)throw new TypeError("not a exponential regression model");return new h(!0,t)}}class c extends o{constructor(t,e){super(),!0===t?(this.A=e.A,this.B=e.B):(i(t,e),function(t,e,r){const n=e.length,i=new Array(n),o=new Array(n);for(let t=0;t<n;t++)i[t]=Math.log(e[t]),o[t]=Math.log(r[t]);const a=new s(i,o);t.A=Math.exp(a.intercept),t.B=a.slope}(this,t,e))}_predict(t){return this.A*Math.pow(t,this.B)}toJSON(){return{name:"powerRegression",A:this.A,B:this.B}}toString(t){return"f(x) = "+n(this.A,t)+" * x^"+n(this.B,t)}toLaTeX(t){return this.B>=0?"f(x) = "+n(this.A,t)+"x^{"+n(this.B,t)+"}":"f(x) = \\frac{"+n(this.A,t)+"}{x^{"+n(-this.B,t)+"}}"}static load(t){if("powerRegression"!==t.name)throw new TypeError("not a power regression model");return new c(!0,t)}}class l extends o{constructor(t,e,r={}){const{intercept:n=!0,statistics:i=!0}=r;if(super(),this.statistics=i,!0===t)this.weights=e.weights,this.inputs=e.inputs,this.outputs=e.outputs,this.intercept=e.intercept;else{t=new a.default(t),n&&t.addColumn(new Array(t.length).fill(1));const r=new a.SVD(t,{autoTranspose:!0}).solve(e);if(this.weights=r.to2DArray(),this.inputs=t[0].length,this.outputs=e[0].length,n&&this.inputs--,this.intercept=n,i){const n=t.mmul(r),i=new a.default(e).addM(n.neg()).to2DArray().map(t=>Math.pow(t[0],2)).reduce((t,e)=>t+e)/(e.length-t.columns);this.stdError=Math.sqrt(i),this.stdErrorMatrix=t.transposeView().mmul(t).pseudoInverse().mul(i),this.stdErrors=this.stdErrorMatrix.diagonal().map(t=>Math.sqrt(t)),this.tStats=this.weights.map((t,e)=>0===this.stdErrors[e]?0:t[0]/this.stdErrors[e])}}}predict(t){if(Array.isArray(t)){if("number"==typeof t[0])return this._predict(t);if(Array.isArray(t[0])){const e=new Array(t.length);for(let r=0;r<t.length;r++)e[r]=this._predict(t[r]);return e}}throw new TypeError("x must be a matrix or array of numbers")}_predict(t){const e=new Array(this.outputs);if(this.intercept)for(let t=0;t<this.outputs;t++)e[t]=this.weights[this.inputs][t];else e.fill(0);for(let r=0;r<this.inputs;r++)for(let n=0;n<this.outputs;n++)e[n]+=this.weights[r][n]*t[r];return e}score(){throw new Error("score method is not implemented yet")}toJSON(){return{name:"multivariateLinearRegression",weights:this.weights,inputs:this.inputs,outputs:this.outputs,intercept:this.intercept,summary:this.statistics?{regressionStatistics:{standardError:this.stdError,observations:this.outputs},variables:this.weights.map((t,e)=>({label:e===this.weights.length-1?"Intercept":`X Variable ${e+1}`,coefficients:t,standardError:this.stdErrors[e],tStat:this.tStats[e]}))}:void 0}}static load(t){if("multivariateLinearRegression"!==t.name)throw new Error("not a MLR model");return new l(!0,t)}}class f extends o{constructor(t,e,r){if(super(),!0===t)this.A=e.A,this.M=e.M;else{if(t.length!==e.length)throw new RangeError("input and output array have a different length");var n=new u(t,e,[r]);this.A=n.coefficients[0],this.M=r}}_predict(t){return this.A*Math.pow(t,this.M)}toJSON(){return{name:"potentialRegression",A:this.A,M:this.M}}toString(t){return"f(x) = "+n(this.A,t)+" * x^"+this.M}toLaTeX(t){return this.M>=0?"f(x) = "+n(this.A,t)+"x^{"+this.M+"}":"f(x) = \\frac{"+n(this.A,t)+"}{x^{"+-this.M+"}}"}static load(t){if("potentialRegression"!==t.name)throw new TypeError("not a potential regression model");return new f(!0,t)}}var p=r(40),m=r.n(p);const g={lambda:.1,kernelType:"gaussian",kernelOptions:{},computeCoefficient:!1};class d extends o{constructor(t,e,r){if(super(),!0===t)this.alpha=e.alpha,this.inputs=e.inputs,this.kernelType=e.kernelType,this.kernelOptions=e.kernelOptions,this.kernel=new m.a(e.kernelType,e.kernelOptions);else{r=Object.assign({},g,r);const n=new m.a(r.kernelType,r.kernelOptions),i=n.compute(t),o=t.length;i.add(a.Matrix.eye(o,o).mul(r.lambda)),this.alpha=Object(a.solve)(i,e),this.inputs=t,this.kernelType=r.kernelType,this.kernelOptions=r.kernelOptions,this.kernel=n}}_predict(t){return this.kernel.compute([t],this.inputs).mmul(this.alpha)[0]}toJSON(){return{name:"kernelRidgeRegression",alpha:this.alpha,inputs:this.inputs,kernelType:this.kernelType,kernelOptions:this.kernelOptions}}static load(t){if("kernelRidgeRegression"!==t.name)throw new TypeError("not a KRR model");return new d(!0,t)}}const v={order:2};class y extends o{constructor(t,e,r){super(),!0===t?(this.coefficients=a.Matrix.columnVector(e.coefficients),this.order=e.order,e.r&&(this.r=e.r,this.r2=e.r2),e.chi2&&(this.chi2=e.chi2)):(r=Object.assign({},v,r),this.order=r.order,this.coefficients=[],this.X=t,this.y=e,this.train(this.X,this.y,r))}train(t,e){if(a.Matrix.isMatrix(t)||(t=new a.Matrix(t)),a.Matrix.isMatrix(e)||(e=a.Matrix.columnVector(e)),e.rows!==t.rows&&(e=e.transpose()),2!==t.columns)throw new RangeError("You give X with "+t.columns+" columns and it must be 2");if(t.rows!==e.rows)throw new RangeError("X and y must have the same rows");var r=t.rows,n=(this.order+2)*(this.order+1)/2;this.coefficients=new Array(n);var i=t.getColumnVector(0),o=t.getColumnVector(1),s=1/i.clone().apply(b).max(),u=1/o.clone().apply(b).max(),h=1/e.clone().apply(b).max();i.mulColumn(0,s),o.mulColumn(0,u),e.mulColumn(0,h);for(var c=new a.Matrix(r,n),l=0,f=0;f<=this.order;++f)for(var p=this.order-f,m=0;m<=p;++m){var g=w(i,f).mulColumnVector(w(o,m));c.setColumn(l,g),l++}var d=new a.SVD(c.transpose(),{computeLeftSingularVectors:!0,computeRightSingularVectors:!0,autoTranspose:!1}),v=a.Matrix.rowVector(d.diagonal);v=v.apply(function(t,e){this[t][e]>=1e-15?this[t][e]=1/this[t][e]:this[t][e]=0});var y=a.Matrix.zeros(r,n);for(f=0;f<n;++f)y[f][f]=v[0][f];v=y;var x=d.rightSingularVectors,M=d.leftSingularVectors;for(this.coefficients=M.mmul(v.transpose()).mmul(x.transpose()).mmul(e),l=0,f=0;f<=n;++f)for(p=this.order-f,m=0;m<=p;++m)this.coefficients[l][0]=this.coefficients[l][0]*Math.pow(s,f)*Math.pow(u,m)/h,l++}_predict(t){for(var e=t[0],r=t[1],n=0,i=0,o=0;o<=this.order;o++)for(var s=0;s<=this.order-o;s++)n+=Math.pow(e,o)*Math.pow(r,s)*this.coefficients[i][0],i++;return n}toJSON(){return{name:"polyfit2D",order:this.order,coefficients:this.coefficients}}static load(t){if("polyfit2D"!==t.name)throw new TypeError("not a polyfit2D model");return new y(!0,t)}}function w(t,e){for(var r=t.clone(),n=0;n<t.rows;++n)r[n][0]=Math.pow(r[n][0],e);return r}function b(t,e){this[t][e]=Math.abs(this[t][e])}const x=r(15).array.median;class M extends o{constructor(t,e){super(),!0===t?(this.slope=e.slope,this.intercept=e.intercept,this.coefficients=e.coefficients):(i(t,e),function(t,e,r){let n=e.length,i=new Array(n*n),o=0;for(let t=0;t<n;++t)for(let s=t+1;s<n;++s)e[t]!==e[s]&&(i[o++]=(r[s]-r[t])/(e[s]-e[t]));i.length=o;let s=x(i),a=new Array(n);for(let t=0;t<n;++t)a[t]=r[t]-s*e[t];t.slope=s,t.intercept=x(a),t.coefficients=[t.intercept,t.slope]}(this,t,e))}toJSON(){return{name:"TheilSenRegression",slope:this.slope,intercept:this.intercept}}_predict(t){return this.slope*t+this.intercept}computeX(t){return(t-this.intercept)/this.slope}toString(t){var e="f(x) = ";if(this.slope){var r=n(this.slope,t);if(e+=(Math.abs(r-1)<1e-5?"":r+" * ")+"x",this.intercept){var i=Math.abs(this.intercept);e+=" "+(i===this.intercept?"+":"-")+" "+n(i,t)}}else e+=n(this.intercept,t);return e}toLaTeX(t){return this.toString(t)}static load(t){if("TheilSenRegression"!==t.name)throw new TypeError("not a Theil-Sen model");return new M(!0,t)}}class S extends o{constructor(t,e,r){super(),!0===t?(this.degree=e.degree,this.powers=e.powers,this.coefficients=e.coefficients):(i(t,e),function(t,e,r,n){let i=new Array(n);for(let t=0;t<n;t++)i[t]=t;const o=function(t,e,r){for(var n=Math.floor(t.length/r),i=new Array(n),o=0;o<t.length;o++){for(var s=Math.floor(Math.random()*n),a=0;a<t.length;){if(!i[s]){i[s]=[{x:t[o],y:e[o]}];break}if(i[s].length<r){i[s].push({x:t[o],y:e[o]});break}a++,s=(s+1)%n}if(a===t.length)return i}return i}(e,r,n);for(var s,a=0;a<o.length;a++){for(var u=o[a],h=A(u,i),c=e.slice(),l=0;l<e.length;l++)c[l]=r[l]-E(e[l],i,h),c[l]={residual:c[l]*c[l],coefficients:h};var f=_(c);(!s||f.residual<s.residual)&&(s=f)}t.degree=n,t.powers=i,t.coefficients=s.coefficients}(this,t,e,r))}toJSON(){return{name:"robustPolynomialRegression",degree:this.degree,powers:this.powers,coefficients:this.coefficients}}_predict(t){return E(t,this.powers,this.coefficients)}toString(t){return this._toFormula(t,!1)}toLaTeX(t){return this._toFormula(t,!0)}_toFormula(t,e){let r="^",i="",o=" * ";e&&(r="^{",i="}",o="");let s="",a="";for(let e=0;e<this.coefficients.length;e++)a="",0!==this.coefficients[e]&&(a=0===this.powers[e]?n(this.coefficients[e],t):1===this.powers[e]?n(this.coefficients[e],t)+o+"x":n(this.coefficients[e],t)+o+"x"+r+this.powers[e]+i,this.coefficients[e]>0&&e!==this.coefficients.length-1?a=" + "+a:e!==this.coefficients.length-1&&(a=" "+a)),s=a+s;return"+"===s.charAt(0)&&(s=s.slice(1)),"f(x) = "+s}static load(t){if("robustPolynomialRegression"!==t.name)throw new TypeError("not a RobustPolynomialRegression model");return new S(!0,t)}}function A(t,e){for(var r=t.slice(),n=t.slice(),i=0;i<r.length;i++){n[i]=[t[i].y],r[i]=new Array(e.length);for(var o=0;o<e.length;o++)r[i][o]=Math.pow(t[i].x,e[o])}return Object(a.solve)(r,n).to1DArray()}function E(t,e,r){let n=0;for(let i=0;i<e.length;i++)n+=r[i]*Math.pow(t,e[i]);return n}function _(t){t.sort((t,e)=>t.residual-e.residual);var e=t.length,r=Math.floor(e/2);return e%2==0?t[r-1]:t[r]}r.d(e,"NLR",function(){return k}),r.d(e,"NonLinearRegression",function(){return k}),r.d(e,"SimpleLinearRegression",function(){return s}),r.d(e,"SLR",function(){return s}),r.d(e,"PolynomialRegression",function(){return u}),r.d(e,"ExponentialRegression",function(){return h}),r.d(e,"PowerRegression",function(){return c}),r.d(e,"MultivariateLinearRegression",function(){return l}),r.d(e,"KernelRidgeRegression",function(){return d}),r.d(e,"KRR",function(){return d}),r.d(e,"PolinomialFitting2D",function(){return y}),r.d(e,"TheilSenRegression",function(){return M}),r.d(e,"RobustPolynomialRegression",function(){return S});const k={PotentialRegression:f}},function(t,e,r){"use strict";var n=r(61),i={size:1,value:0};t.exports=function(t,e){if(e=n({},i,e),Array.isArray(t))return Array.isArray(t[0])?function(t,e){throw t.length,t[0].length,void 0===e.size[0]&&(e.size=[e.size,e.size,e.size,e.size]),new Error("matrix not supported yet, sorry")}(t,e):function(t,e){var r=t.length;"number"==typeof e.size&&(e.size=[e.size,e.size]);var n,i,o=r+e.size[0]+e.size[1];if(e.output){if(e.output.length!==o)throw new RangeError("Wrong output size");n=e.output}else n=new Array(o);if("circular"===e.value)for(i=0;i<o;i++)i<e.size[0]?n[i]=t[(r-e.size[0]%r+i)%r]:i<e.size[0]+r?n[i]=t[i-e.size[0]]:n[i]=t[(i-e.size[0])%r];else if("replicate"===e.value)for(i=0;i<o;i++)i<e.size[0]?n[i]=t[0]:i<e.size[0]+r?n[i]=t[i-e.size[0]]:n[i]=t[r-1];else if("symmetric"===e.value){if(e.size[0]>r||e.size[1]>r)throw new RangeError("expanded value should not be bigger than the data length");for(i=0;i<o;i++)i<e.size[0]?n[i]=t[e.size[0]-1-i]:i<e.size[0]+r?n[i]=t[i-e.size[0]]:n[i]=t[2*r+e.size[0]-i-1]}else for(i=0;i<o;i++)i<e.size[0]?n[i]=e.value:i<e.size[0]+r?n[i]=t[i-e.size[0]]:n[i]=e.value;return n}(t,e);throw new TypeError("data should be an array")}},function(t,e){t.exports=function(t,e){for(var r=t.length,n=0,i=0,o=0,s=0;s<r;s++)n+=t[s]*e[s],i+=t[s]*t[s],o+=e[s]*e[s];return n/(Math.sqrt(i)*Math.sqrt(o))}},function(t,e){t.exports=function(t,e,r){if(r){for(var n=0,i=0,o=0;o<t.length;o++)n+=t[o]&&e[o],i+=t[o]||e[o];return 0===i?1:n/i}for(var s=t.length,a=0,u=0,h=0,c=0;c<s;c++)a+=t[c],u+=e[c],h+=Math.min(t[c],e[c]);return 1-(a+u-2*h)/(a+u-h)}},function(t,e){t.exports=function(t,e){for(var r=t.length,n=0,i=0;i<r;i++)n+=(Math.sqrt(t[i])-Math.sqrt(e[i]))*(Math.sqrt(t[i])-Math.sqrt(e[i]));return n}},function(t,e){t.exports=function(t,e){for(var r=t.length,n=0,i=0,o=0;o<r;o++)n+=Math.min(t[o],e[o]),i+=t[o]+e[o];return 1-n/i}},function(t,e){t.exports=function(t,e){for(var r=t.length,n=0,i=0,o=0;o<r;o++)n+=Math.abs(t[o]-e[o]),i+=Math.min(t[o],e[o]);return n/i}},function(t,e){t.exports=function(t,e){for(var r=t.length,n=0,i=0,o=0,s=0,a=0;a<r;a++)n+=t[a]*e[a],i+=t[a]*t[a],o+=e[a]*e[a],s+=(t[a]-e[a])*(t[a]-e[a]);return s/(i+o-n)}},function(t,e){t.exports=function(t,e){for(var r=t.length,n=0,i=0;i<r;i++)n+=Math.min(t[i],e[i]);return 1-n}},function(t,e){t.exports=function(t,e){for(var r=t.length,n=0,i=0,o=0,s=0;s<r;s++)n+=t[s]*t[s],i+=e[s]*e[s],o+=(t[s]-e[s])*(t[s]-e[s]);return o/(n+i)}},function(t,e,r){"use strict";t.exports=function(t,e){for(var r=0,n=0,i=0;i<t.length;i++)r+=Math.min(t[i],e[i]),n+=t[i]+e[i];return 2*r/n}},function(t,e,r){"use strict";e.distance=r(219),e.similarity=r(182)},function(t,e,r){"use strict";var n=r(220);function i(t){if("number"!=typeof t||n(t))throw new TypeError("Expected a number")}e.asc=function(t,e){return i(t),i(e),t-e},e.desc=function(t,e){return i(t),i(e),e-t}},function(t,e){t.exports=function(t,e,r,n,i){var o,s;if(void 0===n)n=0;else if((n|=0)<0||n>=t.length)throw new RangeError("invalid lower bound");if(void 0===i)i=t.length-1;else if((i|=0)<n||i>=t.length)throw new RangeError("invalid upper bound");for(;n<=i;)if((s=+r(t[o=n+(i-n>>1)],e,o,t))<0)n=o+1;else{if(!(s>0))return o;i=o-1}return~n}},function(t,e){function r(t,e,r,n){this.x=t,this.y=e,this.weights=r,this.som=n,this.neighbors={}}r.prototype.adjustWeights=function(t,e,r){for(var n=0,i=this.weights.length;n<i;n++)this.weights[n]+=e*r*(t[n]-this.weights[n])},r.prototype.getDistance=function(t){return Math.max(Math.abs(this.x-t.x),Math.abs(this.y-t.y))},r.prototype.getDistanceTorus=function(t){var e=Math.abs(this.x-t.x),r=Math.abs(this.y-t.y);return Math.max(Math.min(e,this.som.gridDim.x-e),Math.min(r,this.som.gridDim.y-r))},r.prototype.getNeighbors=function(t){if(!this.neighbors[t]){var e,r,n,i;if(this.neighbors[t]=new Array(2),this[t]>0?e=this[t]-1:this.som.torus&&(e=this.som.gridDim[t]-1),void 0!==e)"x"===t?(r=e,n=this.y):(r=this.x,n=e),this.neighbors[t][0]=this.som.nodes[r][n];this[t]<this.som.gridDim[t]-1?i=this[t]+1:this.som.torus&&(i=0),void 0!==i&&("x"===t?(r=i,n=this.y):(r=this.x,n=i),this.neighbors[t][1]=this.som.nodes[r][n])}return this.neighbors[t]},r.prototype.getPos=function(t,e){var r,n,i=this.getNeighbors(t),o=this.som.distance;i[0]?i[1]?o(e,i[0].weights)<o(e,i[1].weights)?(r=i[0],n=-1):(r=i[1],n=1):(r=i[0],n=-1):(r=i[1],n=1);var s=1-o(e,this.weights),a=1-o(e,r.weights);return.5+.5*((s-a)/(2-s-a))*n},r.prototype.getPosition=function(t){return[this.getPos("x",t),this.getPos("y",t)]},t.exports=r},function(t,e,r){"use strict";function n(t){return 1/(1+Math.exp(-t))}function i(t,e){return t<0?e*(Math.exp(t)-1):t}const o={tanh:{activation:Math.tanh,derivate:t=>1-t*t},identity:{activation:t=>t,derivate:()=>1},logistic:{activation:n,derivate:t=>n(t)*(1-n(t))},arctan:{activation:Math.atan,derivate:t=>1/(t*t+1)},softsign:{activation:t=>t/(1+Math.abs(t)),derivate:t=>1/((1+Math.abs(t))*(1+Math.abs(t)))},relu:{activation:t=>t<0?0:t,derivate:t=>t<0?0:1},softplus:{activation:t=>Math.log(1+Math.exp(t)),derivate:t=>1/(1+Math.exp(-t))},bent:{activation:t=>(Math.sqrt(t*t+1)-1)/2+t,derivate:t=>t/(2*Math.sqrt(t*t+1))+1},sinusoid:{activation:Math.sin,derivate:Math.cos},sinc:{activation:t=>0===t?1:Math.sin(t)/t,derivate:t=>0===t?0:Math.cos(t)/t-Math.sin(t)/(t*t)},gaussian:{activation:t=>Math.exp(-t*t),derivate:t=>-2*t*Math.exp(-t*t)},"parametric-relu":{activation:(t,e)=>t<0?e*t:t,derivate:(t,e)=>t<0?e:1},"exponential-elu":{activation:i,derivate:(t,e)=>t<0?i(t,e)+e:1},"soft-exponential":{activation:function(t,e){return e<0?-Math.log(1-e*(t+e))/e:e>0?(Math.exp(e*t)-1)/e+e:t},derivate:function(t,e){return e<0?1/(1-e*(e+t)):Math.exp(e*t)}}};t.exports=o},function(t,e,r){"use strict";var n=r(0).Matrix;t.exports={dictOutputs:function(t){for(var e={},r={},n=0,i=0;i<t.length;i+=1)void 0===e[t[i]]&&(e[t[i]]=n,r[n]=t[i],n++);return{inputs:e,outputs:r}},sumCol:function(t){for(var e=n.zeros(1,t.columns),r=0;r<t.rows;++r)for(var i=0;i<t.columns;++i)e[0][i]+=t[r][i];return e},sumRow:function(t){for(var e=n.zeros(t.rows,1),r=0;r<t.rows;++r)for(var i=0;i<t.columns;++i)e[r][0]+=t[r][i];return e}}},function(t,e,r){"use strict";var n=r(0).Matrix,i=r(95);const o=r(94);class s{constructor(t){this.inputSize=t.inputSize,this.outputSize=t.outputSize,this.regularization=t.regularization,this.epsilon=t.epsilon,this.activation=t.activation,this.activationParam=t.activationParam;var e=o[t.activation],r=e.activation.length,i=r>1?r=>e.activation(r,t.activationParam):e.activation,s=r>1?r=>e.derivate(r,t.activationParam):e.derivate;this.activationFunction=function(t,e){this[t][e]=i(this[t][e])},this.derivate=function(t,e){this[t][e]=s(this[t][e])},t.model?(this.W=n.checkMatrix(t.W),this.b=n.checkMatrix(t.b)):(this.W=n.rand(this.inputSize,this.outputSize),this.b=n.zeros(1,this.outputSize),this.W.apply(function(e,r){this[e][r]/=Math.sqrt(t.inputSize)}))}forward(t){var e=t.mmul(this.W).addRowVector(this.b);return e.apply(this.activationFunction),this.a=e.clone(),e}backpropagation(t,e){this.dW=e.transposeView().mmul(t),this.db=i.sumCol(t);var r=e.clone();return t.mmul(this.W.transposeView()).mul(r.apply(this.derivate))}update(){this.dW.add(this.W.clone().mul(this.regularization)),this.W.add(this.dW.mul(-this.epsilon)),this.b.add(this.db.mul(-this.epsilon))}toJSON(){return{model:"Layer",inputSize:this.inputSize,outputSize:this.outputSize,regularization:this.regularization,epsilon:this.epsilon,activation:this.activation,W:this.W,b:this.b}}static load(t){if("Layer"!==t.model)throw new RangeError("the current model is not a Layer model");return new s(t)}}t.exports=s},function(t,e){class r{constructor(t,e){if(t.length!==t[0].length)throw new Error("Confusion matrix must be square");if(e.length!==t.length)throw new Error("Confusion matrix and labels should have the same length");this.labels=e,this.matrix=t}static fromLabels(t,e,n={}){if(e.length!==t.length)throw new Error("predicted and actual must have the same length");let i;i=n.labels?new Set(n.labels):new Set([...t,...e]),i=Array.from(i),n.sort&&i.sort(n.sort);const o=Array.from({length:i.length});for(let t=0;t<o.length;t++)o[t]=new Array(o.length),o[t].fill(0);for(let r=0;r<e.length;r++){const n=i.indexOf(t[r]),s=i.indexOf(e[r]);n>=0&&s>=0&&o[n][s]++}return new r(o,i)}getMatrix(){return this.matrix}getLabels(){return this.labels}getTotalCount(){let t=0;for(var e=0;e<this.matrix.length;e++)for(var r=0;r<this.matrix.length;r++)t+=this.matrix[e][r];return t}getTrueCount(){for(var t=0,e=0;e<this.matrix.length;e++)t+=this.matrix[e][e];return t}getFalseCount(){return this.getTotalCount()-this.getTrueCount()}getTruePositiveCount(t){const e=this.getIndex(t);return this.matrix[e][e]}getTrueNegativeCount(t){const e=this.getIndex(t);for(var r=0,n=0;n<this.matrix.length;n++)for(var i=0;i<this.matrix.length;i++)n!==e&&i!==e&&(r+=this.matrix[n][i]);return r}getFalsePositiveCount(t){const e=this.getIndex(t);for(var r=0,n=0;n<this.matrix.length;n++)n!==e&&(r+=this.matrix[n][e]);return r}getFalseNegativeCount(t){const e=this.getIndex(t);for(var r=0,n=0;n<this.matrix.length;n++)n!==e&&(r+=this.matrix[e][n]);return r}getPositiveCount(t){return this.getTruePositiveCount(t)+this.getFalseNegativeCount(t)}getNegativeCount(t){return this.getTrueNegativeCount(t)+this.getFalsePositiveCount(t)}getIndex(t){const e=this.labels.indexOf(t);if(-1===e)throw new Error("The label does not exist");return e}getTruePositiveRate(t){return this.getTruePositiveCount(t)/this.getPositiveCount(t)}getTrueNegativeRate(t){return this.getTrueNegativeCount(t)/this.getNegativeCount(t)}getPositivePredictiveValue(t){const e=this.getTruePositiveCount(t);return e/(e+this.getFalsePositiveCount(t))}getNegativePredictiveValue(t){const e=this.getTrueNegativeCount(t);return e/(e+this.getFalseNegativeCount(t))}getFalseNegativeRate(t){return 1-this.getTruePositiveRate(t)}getFalsePositiveRate(t){return 1-this.getTrueNegativeRate(t)}getFalseDiscoveryRate(t){const e=this.getFalsePositiveCount(t);return e/(e+this.getTruePositiveCount(t))}getFalseOmissionRate(t){const e=this.getFalseNegativeCount(t);return e/(e+this.getTruePositiveCount(t))}getF1Score(t){const e=this.getTruePositiveCount(t);return 2*e/(2*e+this.getFalsePositiveCount(t)+this.getFalseNegativeCount(t))}getMatthewsCorrelationCoefficient(t){const e=this.getTruePositiveCount(t),r=this.getTrueNegativeCount(t),n=this.getFalsePositiveCount(t),i=this.getFalseNegativeCount(t);return(e*r-n*i)/Math.sqrt((e+n)*(e+i)*(r+n)*(r+i))}getInformedness(t){return this.getTruePositiveRate(t)+this.getTrueNegativeRate(t)-1}getMarkedness(t){return this.getPositivePredictiveValue(t)+this.getNegativePredictiveValue(t)-1}getConfusionTable(t){return[[this.getTruePositiveCount(t),this.getFalseNegativeCount(t)],[this.getFalsePositiveCount(t),this.getTrueNegativeCount(t)]]}getAccuracy(){let t=0,e=0;for(var r=0;r<this.matrix.length;r++)for(var n=0;n<this.matrix.length;n++)r===n?t+=this.matrix[r][n]:e+=this.matrix[r][n];return t/(t+e)}getCount(t,e){const r=this.getIndex(t),n=this.getIndex(e);return this.matrix[r][n]}get accuracy(){return this.getAccuracy()}get total(){return this.getTotalCount()}}t.exports=r},function(t,e,r){"use strict";Object.defineProperty(e,"__esModule",{value:!0});var n=function(){function t(t,e){for(var r=0;r<e.length;r++){var n=e[r];n.enumerable=n.enumerable||!1,n.configurable=!0,"value"in n&&(n.writable=!0),Object.defineProperty(t,n.key,n)}}return function(e,r,n){return r&&t(e.prototype,r),n&&t(e,n),e}}();var i=function(){function t(){var e=arguments.length<=0||void 0===arguments[0]?Date.now():arguments[0];!function(t,e){if(!(t instanceof e))throw new TypeError("Cannot call a class as a function")}(this,t),this.state=new Uint32Array(4),this.init(e)}return n(t,[{key:"init",value:function(t){this.state[0]=t,this.state[1]=0,this.state[2]=0,this.state[3]=0;for(var e=1;e<8;e++)this.state[3&e]^=e+(r=1812433253,n=this.state[e-1&3]^this.state[e-1&3]>>>30>>>0,void 0,i=65535&(r>>>=0),((r-i)*(n>>>=0)>>>0)+i*n>>>0)>>>0;var r,n,i,o;0===(o=this).state[0]&&0===o.state[1]&&0===o.state[2]&&0===o.state[3]&&(o.state[0]=88,o.state[1]=83,o.state[2]=65,o.state[3]=68);for(e=0;e<8;e++)u(this)}},{key:"getUint32",value:function(){return u(this),this.state[3]+this.state[2]>>>0}},{key:"getFloat",value:function(){return(this.getUint32()>>>8)*(1/16777216)}},{key:"random",get:function(){return this._random||(this._random=this.getFloat.bind(this)),this._random}}]),t}();e.default=i;var o=15,s=18,a=11;function u(t){var e=t.state[0];e^=e<<o,e^=e>>>s,e^=t.state[3]<<a,t.state[0]=t.state[1],t.state[1]=t.state[2],t.state[2]=t.state[3],t.state[3]=e}t.exports=e.default},function(t,e,r){"use strict";t.exports=function(t,e){const r=t.length;let n=Array.from({length:r}).map(()=>Array.from({length:r}));for(let i=0;i<r;i++)for(let r=0;r<=i;r++)n[i][r]=e(t[i],t[r]);for(let t=0;t<r;t++)for(let e=t+1;e<r;e++)n[t][e]=n[e][t];return n}},function(t,e,r){"use strict";const n=r(62);function i(t){n.call(this),this.index=t,this.distance=0,this.children=[]}r(245).inherits(i,n),t.exports=i},function(t,e,r){"use strict";function n(t,e){return t-e}e.sum=function(t){for(var e=0,r=0;r<t.length;r++)e+=t[r];return e},e.max=function(t){for(var e=t[0],r=t.length,n=1;n<r;n++)t[n]>e&&(e=t[n]);return e},e.min=function(t){for(var e=t[0],r=t.length,n=1;n<r;n++)t[n]<e&&(e=t[n]);return e},e.minMax=function(t){for(var e=t[0],r=t[0],n=t.length,i=1;i<n;i++)t[i]<e&&(e=t[i]),t[i]>r&&(r=t[i]);return{min:e,max:r}},e.arithmeticMean=function(t){for(var e=0,r=t.length,n=0;n<r;n++)e+=t[n];return e/r},e.mean=e.arithmeticMean,e.geometricMean=function(t){for(var e=1,r=t.length,n=0;n<r;n++)e*=t[n];return Math.pow(e,1/r)},e.logMean=function(t){for(var e=0,r=t.length,n=0;n<r;n++)e+=Math.log(t[n]);return e/r},e.grandMean=function(t,e){for(var r=0,n=0,i=t.length,o=0;o<i;o++)r+=e[o]*t[o],n+=e[o];return r/n},e.truncatedMean=function(t,e,r){void 0===r&&(r=!1),r||(t=[].concat(t).sort(n));for(var i=t.length,o=Math.floor(i*e),s=0,a=o;a<i-o;a++)s+=t[a];return s/(i-2*o)},e.harmonicMean=function(t){for(var e=0,r=t.length,n=0;n<r;n++){if(0===t[n])throw new RangeError("value at index "+n+"is zero");e+=1/t[n]}return r/e},e.contraHarmonicMean=function(t){for(var e=0,r=0,n=t.length,i=0;i<n;i++)e+=t[i]*t[i],r+=t[i];if(r<0)throw new RangeError("sum of values is negative");return e/r},e.median=function(t,e){void 0===e&&(e=!1),e||(t=[].concat(t).sort(n));var r=t.length,i=Math.floor(r/2);return r%2==0?.5*(t[i-1]+t[i]):t[i]},e.variance=function(t,r){void 0===r&&(r=!0);for(var n=e.mean(t),i=0,o=t.length,s=0;s<o;s++){var a=t[s]-n;i+=a*a}return r?i/(o-1):i/o},e.standardDeviation=function(t,r){return Math.sqrt(e.variance(t,r))},e.standardError=function(t){return e.standardDeviation(t)/Math.sqrt(t.length)},e.robustMeanAndStdev=function(t){var e=0,r=t.length,i=0;for(i=0;i<r;i++)e+=t[i];e/=r;var o=new Array(r);for(i=0;i<r;i++)o[i]=Math.abs(t[i]-e);return o.sort(n),{mean:e,stdev:r%2==1?o[(r-1)/2]/.6745:.5*(o[r/2]+o[r/2-1])/.6745}},e.quartiles=function(t,r){void 0===r&&(r=!1),r||(t=[].concat(t).sort(n));var i=t.length/4;return{q1:t[Math.ceil(i)-1],q2:e.median(t,!0),q3:t[Math.ceil(3*i)-1]}},e.pooledStandardDeviation=function(t,r){return Math.sqrt(e.pooledVariance(t,r))},e.pooledVariance=function(t,r){void 0===r&&(r=!0);for(var n=0,i=0,o=t.length,s=0;s<o;s++){var a=t[s],u=e.variance(a);n+=(a.length-1)*u,i+=r?a.length-1:a.length}return n/i},e.mode=function(t){var e,r=t.length,n=new Array(r);for(e=0;e<r;e++)n[e]=0;var i=new Array(r),o=0;for(e=0;e<r;e++){var s=i.indexOf(t[e]);s>=0?n[s]++:(i[o]=t[e],n[o]=1,o++)}var a=0,u=0;for(e=0;e<o;e++)n[e]>a&&(a=n[e],u=e);return i[u]},e.covariance=function(t,r,n){void 0===n&&(n=!0);var i=e.mean(t),o=e.mean(r);if(t.length!==r.length)throw"Vectors do not have the same dimensions";for(var s=0,a=t.length,u=0;u<a;u++){s+=(t[u]-i)*(r[u]-o)}return n?s/(a-1):s/a},e.skewness=function(t,r){void 0===r&&(r=!0);for(var n=e.mean(t),i=0,o=0,s=t.length,a=0;a<s;a++){var u=t[a]-n;i+=u*u,o+=u*u*u}var h=i/s,c=o/s/Math.pow(h,1.5);return r?Math.sqrt(s*(s-1))/(s-2)*c:c},e.kurtosis=function(t,r){void 0===r&&(r=!0);for(var n=e.mean(t),i=t.length,o=0,s=0,a=0;a<i;a++){var u=t[a]-n;o+=u*u,s+=u*u*u*u}var h=o/i,c=s/i;if(r){var l=o/(i-1);return i*(i+1)/((i-1)*(i-2)*(i-3))*(s/(l*l))-3*((i-1)*(i-1)/((i-2)*(i-3)))}return c/(h*h)-3},e.entropy=function(t,e){void 0===e&&(e=0);for(var r=0,n=t.length,i=0;i<n;i++)r+=t[i]*Math.log(t[i]+e);return-r},e.weightedMean=function(t,e){for(var r=0,n=t.length,i=0;i<n;i++)r+=t[i]*e[i];return r},e.weightedStandardDeviation=function(t,r){return Math.sqrt(e.weightedVariance(t,r))},e.weightedVariance=function(t,r){for(var n=e.weightedMean(t,r),i=0,o=t.length,s=0,a=0,u=0;u<o;u++){var h=t[u]-n,c=r[u];i+=c*(h*h),a+=c,s+=c*c}return i*(a/(a*a-s))},e.center=function(t,r){void 0===r&&(r=!1);var n=t;r||(n=[].concat(t));for(var i=e.mean(n),o=n.length,s=0;s<o;s++)n[s]-=i},e.standardize=function(t,r,n){void 0===r&&(r=e.standardDeviation(t)),void 0===n&&(n=!1);for(var i=t.length,o=n?t:new Array(i),s=0;s<i;s++)o[s]=t[s]/r;return o},e.cumulativeSum=function(t){var e=t.length,r=new Array(e);r[0]=t[0];for(var n=1;n<e;n++)r[n]=r[n-1]+t[n];return r}},function(t,e,r){"use strict";const n=r(32),i=r(162),o=e;o.PCA=r(250),o.HClust=r(249),o.KMeans=r(161),o.SVM=r(241),o.NaiveBayes=r(159),o.KNN=r(158),o.PLS=r(160),o.CrossValidation=r(230),o.ConfusionMatrix=r(97),o.DecisionTreeClassifier=n.DecisionTreeClassifier,o.RandomForestClassifier=i.RandomForestClassifier,o.FNN=r(228),o.SOM=r(226);const s=r(79);o.SimpleLinearRegression=s.SimpleLinearRegression,o.PolynomialRegression=s.PolynomialRegression,o.MultivariateLinearRegression=s.MultivariateLinearRegression,o.PowerRegression=s.PowerRegression,o.ExponentialRegression=s.ExponentialRegression,o.TheilSenRegression=s.TheilSenRegression,o.RobustPolynomialRegression=s.RobustPolynomialRegression,o.DesisionTreeRegression=n.DesisionTreeRegression,o.RandomForestRegression=i.RandomForestRegression,o.levenbergMarquardt=r(224);const a=r(0);o.Matrix=a.Matrix,o.SVD=a.SVD,o.EVD=a.EVD,o.CholeskyDecomposition=a.CholeskyDecomposition,o.LuDecomposition=a.LuDecomposition,o.QrDecomposition=a.QrDecomposition,o.SparseMatrix=r(223),o.Kernel=r(40),o.Distance=r(90).distance,o.Similarity=r(90).similarity,o.distanceMatrix=r(99),o.XSadd=r(98),o.Performance=r(174),o.savitzkyGolay=r(172),o.savitzkyGolayGeneralized=r(171),o.BitArray=r(170),o.HashTable=r(60),o.padArray=r(80),o.binarySearch=r(92),o.numSort=r(91),o.ArrayUtils=r(168),o.Regression=r(79),o.MatrixUtil=r(0),o.ArrayStat=r(15).array,o.MatrixStat=r(15).matrix},function(t,e,r){"use strict";Object.defineProperty(e,"__esModule",{value:!0});var n=r(21),i=function(){function t(t,e,r){this._pos={start:0,end:0},this.detects=[],this.pitch=[],this.featureVector=[],this.a1=t,this.a2=e,this.featureExtractor=r}return t.prototype.extractFeatures=function(){this.features={spectralFlatness:this.featureExtractor.extract("spectralFlatness",this.signal,1024),spectralSlope:this.featureExtractor.extract("spectralSlope",this.signal,1024),spectralRolloff:this.featureExtractor.extract("spectralRolloff",this.signal,1024),spectralSkewness:this.featureExtractor.extract("spectralSkewness",this.signal,1024),spectralSpread:this.featureExtractor.extract("spectralSpread",this.signal,2048),spectralKurtosis:this.featureExtractor.extract("spectralKurtosis",this.signal,128),perceptualSpread:this.featureExtractor.extract("perceptualSpread",this.signal,1024),zcr:this.featureExtractor.extract("zcr",this.signal,1024),mfcc:this.featureExtractor.extract("mfcc",this.signal,512),spectralBins:this.featureExtractor.extract("spectralBins",this.signal,2048)}},t.prototype.getMFCC=function(t){var e=n.Utils.column(this.features.mfcc,t);return n.Utils.normalize(e,0,1)},t.prototype.getFeatureVector=function(){if(0==this.featureVector.length)for(var t=this.features.spectralBins.length,e=this.features.spectralBins[0].length,r=0;r<e;r++){for(var n=0,i=0;i<t;i++)n+=this.features.spectralBins[i][r];this.featureVector.push(n/t)}return this.featureVector},t.prototype.trim=function(t,e){var r=n.Utils.dbToLin(e);r>.02&&(r=.01);var i=this.featureExtractor.extract("thresholdCrossings",t,0,r);this.n1=i[0],this.n2=i[i.length-1];var o=t.subarray(this.n1,this.n2);if(o.slice)this.signal=o.slice(0);else{var s=new ArrayBuffer(o.byteLength),a=new Float32Array(s);a.set(o),this.signal=a}},t.prototype.trimLeft=function(t){this.n1=0;for(var e=(void 0).sliceMinLevelTrim,r=(void 0).sliceMinDuration*(void 0).actx.sampleRate,n=(void 0).sliceWinLengthFine,i=t.length,o=0,s=o+n,a=e-6;a<e&&s<i;){var u=t.subarray(o,s);if((a=this.featureExtractor.extract("rms",u))>=e)return i-o>=r?(this.n1=o,this.valid=!0,!0):(this.valid=!1,!1);o=s+1,s+=n}return!0},t.prototype.trimRight=function(t){this.n2=this.a2-this.a1;for(var e=(void 0).sliceMinLevelTrim,r=(void 0).sliceMinDuration*(void 0).actx.sampleRate,n=(void 0).sliceWinLengthFine,i=this.a1,o=this.n2,s=o-n,a=e-6;a<e&&s>i;){var u=t.subarray(s,o);if((a=this.featureExtractor.extract("rms",u))>=e)return s-i>=r?(this.n2=o,this.valid=!0,!0):(this.valid=!1,!1);o=s,s-=n}return!0},t}();e.Slice=i},function(t,e,r){"use strict";Object.defineProperty(e,"__esModule",{value:!0});var n=r(258),i=r(257),o=r(21),s=function(){function t(){this.firstBin=3}return t.prototype.extract=function(t,e,r){switch(t){case"mfcc":return this.extractMFCC(e,r);case"spectralBins":return this.extractSpectralBins(e,r);case"rms":return this.extractRMS(e,r);case"zcr":return this.framewiseMedian(t,e,r);case"spectralFlatness":case"spectralSlope":case"spectralRolloff":case"spectralSpread":case"spectralSkewness":case"spectralKurtosis":case"perceptualSpread":return this.framewiseAverage(t,e,r);case"thresholdCrossings":return this.thresholdCrossings(e,arguments[2],arguments[3]);default:return}},t.prototype.extractMFCC=function(t,e){var r=[],i=e||512;n.bufferSize=i;for(var o=0;o<t.length;o+=i){var s=t.subarray(o,o+i);if(s.length!=i){var a=new Float32Array(i);a.set(s,0),a.set(new Float32Array(i-s.length),s.length),s=a}r.push(n.extract("mfcc",s))}return r.N=i,r},t.prototype.extractSpectralBins=function(t,e){for(var r=[],n=e||512,i=0;i<t.length;i+=n){var o=t.subarray(i,i+n);if(o.length!=n){var s=new Float32Array(n);s.set(o,0),s.set(new Float32Array(n-o.length),o.length),o=s}r.push(this.spectralBins(o))}return r.N=n,r},t.prototype.hannWindow=function(t,e){return.5*(1-Math.cos(2*Math.PI*e/(t-1)))},t.prototype.spectralBins=function(t){var e=[7,15,31,63,127,255,511,1e3,2e3,2750,3500,4250,5e3,5750,6500,7250,8e3];this.octaveFractions=[];for(var r=0;r<e.length;r++)this.octaveFractions.push(e[r]/8192);var n=this.calcSpectrum(t);return this.calcBandData(n)},t.prototype.calcSpectrum=function(t){for(var e=t.length,r=(new Float32Array(e),new i.ComplexArray(e)),n=r.real,o=e/8,s=0;s<e;s++)n[s]=s<o?t[s]*this.hannWindow(2*o,s):s>e-o?t[s]*this.hannWindow(2*o,s-e+o):t[s];r.FFT();var a=[];for(s=0;s<e;s++){var u=Math.abs(n[s]);a.push(u)}return a},t.prototype.calcBandData=function(t,e){void 0===e&&(e=0);for(var r=this.firstBin,n=0,i=new Array(this.octaveFractions.length),o=t.length,s=0;s<i.length;s++){for(var a=0,u=r+1;u<Math.floor(this.octaveFractions[s]*o);u++)u<t.length&&(a+=t[u]);i[s]=a,a>n&&(n=a),r=Math.floor(this.octaveFractions[s]*o)}return i},t.prototype.extractRMS=function(t,e){if(void 0==e){var r=o.Utils.rms(t);return 20*Math.log10(r)}return this.extractX(t,e,"rms")},t.prototype.extractZCR=function(t,e){return this.extractX(t)},t.prototype.framewiseAverage=function(t,e,r){var n=this.extractX(e,r,t);return o.Utils.mean(n)},t.prototype.framewiseMedian=function(t,e,r){var n=this.extractX(e,r,t);return o.Utils.median(n)},t.prototype.extractX=function(t,e,r){void 0===r&&(r="zcr"),r=r||"zcr";var i=[],o=e||512;n.bufferSize=o;for(var s=0;s<t.length;s+=o){var a=this.slice(t,s,o);i.push(n.extract(r,a))}return i},t.prototype.slice=function(t,e,r){var n=t.subarray(e,e+r);if(n.length!=r){var i=new Float32Array(r);i.set(n,0),i.set(new Float32Array(r-n.length),n.length),n=i}return n},t.prototype.thresholdCrossings=function(t,e,r){var n=[],i=(e=isNaN(e)?0:e)+(r=isNaN(r)?1e-10:r),o=e-r,s=t[0];o<=s&&s<=i&&(s=e);var a=s>e;a&&n.push(0);for(var u=0;u<t.length;u++){var h=t[u];o<=h&&h<=i&&(h=e),h<e&&a?n.push(u):h>e&&!a&&n.push(u),a=h>e}return n},t}();e.FeatureExtractor=s},,,,,,,,,,,,,,,,,,,,,,,,,,,,,,,,,,,,,,,,,,,,,,,,,,,,function(t,e,r){"use strict";const n={distanceFunction:r(7).squared,similarityFunction:!1,returnVector:!1};t.exports=function(t,e,r){const i=(r=r||n).distanceFunction||n.distanceFunction,o=r.similarityFunction||n.similarityFunction,s=r.returnVector||n.returnVector;var a=-1;if("function"==typeof o)for(var u=Number.MIN_VALUE,h=0;h<t.length;h++){var c=o(e,t[h]);c>u&&(u=c,a=h)}else{if("function"!=typeof i)throw new Error("A similarity or distance function it's required");for(var l=Number.MAX_VALUE,f=0;f<t.length;f++){var p=i(e,t[f]);p<l&&(l=p,a=f)}}return s?t[a]:a}},function(t,e){!function(){function e(t){for(var e=0,i=t.length-1,o=void 0,s=void 0,a=void 0,u=n(e,i);;){if(i<=e)return t[u];if(i==e+1)return t[e]>t[i]&&r(t,e,i),t[u];for(t[o=n(e,i)]>t[i]&&r(t,o,i),t[e]>t[i]&&r(t,e,i),t[o]>t[e]&&r(t,o,e),r(t,o,e+1),s=e+1,a=i;;){do{s++}while(t[e]>t[s]);do{a--}while(t[a]>t[e]);if(a<s)break;r(t,s,a)}r(t,e,a),a<=u&&(e=s),a>=u&&(i=a-1)}}var r=function(t,e,r){var n;return n=[t[r],t[e]],t[e]=n[0],t[r]=n[1],n},n=function(t,e){return~~((t+e)/2)};void 0!==t&&t.exports?t.exports=e:window.median=e}()},function(t,e,r){"use strict";
/*
 * Original code from:
 *
 * k-d Tree JavaScript - V 1.01
 *
 * https://github.com/ubilabs/kd-tree-javascript
 *
 * @author Mircea Pricop <pricop@ubilabs.net>, 2012
 * @author Martin Kleppe <kleppe@ubilabs.net>, 2012
 * @author Ubilabs http://ubilabs.net, 2012
 * @license MIT License <http://www.opensource.org/licenses/mit-license.php>
 */
function n(t,e,r){this.obj=t,this.left=null,this.right=null,this.parent=r,this.dimension=e}r.r(e);class i{constructor(t,e){if(Array.isArray(t)){this.dimensions=new Array(t[0].length);for(var r=0;r<this.dimensions.length;r++)this.dimensions[r]=r;this.root=function t(e,r,i,o){const s=r%o.length;if(0===e.length)return null;if(1===e.length)return new n(e[0],s,i);e.sort((t,e)=>t[o[s]]-e[o[s]]);const a=Math.floor(e.length/2);const u=new n(e[a],s,i);u.left=t(e.slice(0,a),r+1,u,o);u.right=t(e.slice(a+1),r+1,u,o);return u}(t,0,null,this.dimensions)}else this.dimensions=t.dimensions,this.root=t,function t(e){e.left&&(e.left.parent=e,t(e.left));e.right&&(e.right.parent=e,t(e.right))}(this.root);this.metric=e}toJSON(){const t=function t(e){const r=new n(e.obj,e.dimension,null);e.left&&(r.left=t(e.left));e.right&&(r.right=t(e.right));return r}(this.root);return t.dimensions=this.dimensions,t}nearest(t,e,r){const n=this.metric,i=this.dimensions;var s;const a=new o(function(t){return-t[1]});if(r)for(s=0;s<e;s+=1)a.push([null,r]);this.root&&function r(o){const s=i[o.dimension],u=n(t,o.obj),h={};var c,l,f,p;function m(t,r){a.push([t,r]),a.size()>e&&a.pop()}for(p=0;p<i.length;p+=1)p===o.dimension?h[i[p]]=t[i[p]]:h[i[p]]=o.obj[i[p]];l=n(h,o.obj),null!==o.right||null!==o.left?(r(c=null===o.right?o.left:null===o.left?o.right:t[s]<o.obj[s]?o.left:o.right),(a.size()<e||u<a.peek()[1])&&m(o,u),(a.size()<e||Math.abs(l)<a.peek()[1])&&null!==(f=c===o.left?o.right:o.left)&&r(f)):(a.size()<e||u<a.peek()[1])&&m(o,u)}(this.root);const u=[];for(s=0;s<Math.min(e,a.content.length);s+=1)a.content[s][0]&&u.push([a.content[s][0].obj,a.content[s][1]]);return u}}class o{constructor(t){this.content=[],this.scoreFunction=t}push(t){this.content.push(t),this.bubbleUp(this.content.length-1)}pop(){var t=this.content[0],e=this.content.pop();return this.content.length>0&&(this.content[0]=e,this.sinkDown(0)),t}peek(){return this.content[0]}size(){return this.content.length}bubbleUp(t){for(var e=this.content[t];t>0;){const r=Math.floor((t+1)/2)-1,n=this.content[r];if(!(this.scoreFunction(e)<this.scoreFunction(n)))break;this.content[r]=e,this.content[t]=n,t=r}}sinkDown(t){for(var e=this.content.length,r=this.content[t],n=this.scoreFunction(r);;){var i=2*(t+1),o=i-1,s=null;if(o<e){var a=this.content[o],u=this.scoreFunction(a);u<n&&(s=o)}if(i<e){var h=this.content[i];this.scoreFunction(h)<(null===s?n:u)&&(s=i)}if(null===s)break;this.content[t]=this.content[s],this.content[s]=r,t=s}}}var s=r(7),a=r.n(s);r.d(e,"default",function(){return u});class u{constructor(t,e,r={}){if(!0===t){const t=e;return this.kdTree=new i(t.kdTree,r),this.k=t.k,this.classes=new Set(t.classes),void(this.isEuclidean=t.isEuclidean)}const n=new Set(e),{distance:o=a.a,k:s=n.size+1}=r,u=new Array(t.length);for(var h=0;h<u.length;++h)u[h]=t[h].slice();for(h=0;h<e.length;++h)u[h].push(e[h]);this.kdTree=new i(u,o),this.k=s,this.classes=n,this.isEuclidean=o===a.a}static load(t,e=a.a){if("KNN"!==t.name)throw new Error("invalid model: "+t.name);if(!t.isEuclidean&&e===a.a)throw new Error("a custom distance function was used to create the model. Please provide it again");if(t.isEuclidean&&e!==a.a)throw new Error("the model was created with the default distance function. Do not load it with another one");return new u(!0,t,e)}toJSON(){return{name:"KNN",kdTree:this.kdTree,k:this.k,classes:Array.from(this.classes),isEuclidean:this.isEuclidean}}predict(t){if(Array.isArray(t)){if("number"==typeof t[0])return h(this,t);if(Array.isArray(t[0])&&"number"==typeof t[0][0]){const r=new Array(t.length);for(var e=0;e<t.length;e++)r[e]=h(this,t[e]);return r}}throw new TypeError("dataset to predict must be an array or a matrix")}}function h(t,e){var r=t.kdTree.nearest(e,t.k),n={},i=-1,o=-1,s=r[0][0].length-1;for(var a of t.classes)n[a]=0;for(var u=0;u<r.length;++u){var h=r[u][0][s],c=++n[h];c>o&&(i=h,o=c)}return i}},function(t,e,r){"use strict";r.r(e);var n=r(0),i=r(15),o=r.n(i);function s(t,e){for(var r=t.columns,i=0,o=new Array(1e4),s=0;s<e.length;s++)void 0===o[e[s]]&&(o[e[s]]=0,i++),o[e[s]]++;var a=new Array(i),u=new Array(i);for(s=0;s<i;++s)a[s]=new n.default(o[s],r),u[s]=0;for(s=0;s<t.rows;++s)a[e[s]].setRow(u[e[s]],t.getRow(s)),u[e[s]]++;return a}class a{constructor(t,e){t&&(this.means=e.means,this.calculateProbabilities=e.calculateProbabilities)}train(t,e){var r=Math.sqrt(2*Math.PI);if((t=n.default.checkMatrix(t)).rows!==e.length)throw new RangeError("the size of the training set and the training labels must be the same.");var i=s(t,e),a=new Array(i.length);this.means=new Array(i.length);for(var u=0;u<i.length;++u){var h=o.a.matrix.mean(i[u]),c=o.a.matrix.standardDeviation(i[u],h),l=Math.log(i[u].rows/t.rows);a[u]=new Array(h.length+1),a[u][0]=l;for(var f=1;f<h.length+1;++f){var p=c[f-1];a[u][f]=[1/(r*p),-2*p*p]}this.means[u]=h}this.calculateProbabilities=a}predict(t){if(t[0].length===this.calculateProbabilities[0].length)throw new RangeError("the dataset must have the same features as the training set");for(var e=new Array(t.length),r=0;r<e.length;++r)e[r]=u(t[r],this.means,this.calculateProbabilities);return e}toJSON(){return{modelName:"NaiveBayes",means:this.means,calculateProbabilities:this.calculateProbabilities}}static load(t){if("NaiveBayes"!==t.modelName)throw new RangeError("The current model is not a Multinomial Naive Bayes, current model:",t.name);return new a(!0,t)}}function u(t,e,r){for(var n=0,i=-1,o=0;o<r.length;++o){for(var s=r[o][0],a=1;a<r[0][1].length+1;++a)s+=h(t[a-1],e[o][a-1],r[o][a][0],r[o][a][1]);(s=Math.exp(s))>n&&(n=s,i=o)}return i}function h(t,e,r,n){return t-=e,Math.log(r*Math.exp(t*t/n))}class c{constructor(t){t&&(this.conditionalProbability=n.default.checkMatrix(t.conditionalProbability),this.priorProbability=n.default.checkMatrix(t.priorProbability))}train(t,e){if((t=n.default.checkMatrix(t)).rows!==e.length)throw new RangeError("the size of the training set and the training labels must be the same.");var r=s(t,e);this.priorProbability=new n.default(r.length,1);for(var i=0;i<r.length;++i)this.priorProbability[i][0]=Math.log(r[i].length/t.rows);var o=t.columns;for(this.conditionalProbability=new n.default(r.length,o),i=0;i<r.length;++i){var a=n.default.checkMatrix(r[i]),u=a.sum()+o;this.conditionalProbability.setRow(i,a.sum("column").add(1).div(u).apply(l))}}predict(t){t=n.default.checkMatrix(t);for(var e=new Array(t.rows),r=0;r<t.rows;++r){var i=t.getRowVector(r);e[r]=this.conditionalProbability.clone().mulRowVector(i).sum("row").add(this.priorProbability).maxIndex()[0]}return e}toJSON(){return{name:"MultinomialNB",priorProbability:this.priorProbability,conditionalProbability:this.conditionalProbability}}static load(t){if("MultinomialNB"!==t.name)throw new RangeError(`${t.name} is not a Multinomial Naive Bayes`);return new c(t)}}function l(t,e){this[t][e]=Math.log(this[t][e])}r.d(e,"GaussianNB",function(){return a}),r.d(e,"MultinomialNB",function(){return c})},function(t,e,r){"use strict";r.r(e);var n=r(0),i=r(20),o=r.n(i);function s(t){return Math.sqrt(t.clone().apply(a).sum())}function a(t,e){return this[t][e]=this[t][e]*this[t][e],this}function u(t,e){if(e)for(var r=0;r<t.length;++r)for(var i=0;i<t[r].length;++i){var o=t[r][i];t[r][i]=null!==o?new n.default(t[r][i]):void 0}else for(r=0;r<t.length;++r)t[r]=new n.default(t[r]);return t}class h{constructor(t,e){if(!0===t)this.meanX=e.meanX,this.stdDevX=e.stdDevX,this.meanY=e.meanY,this.stdDevY=e.stdDevY,this.PBQ=n.default.checkMatrix(e.PBQ),this.R2X=e.R2X,this.scale=e.scale,this.scaleMethod=e.scaleMethod,this.tolerance=e.tolerance;else{var{tolerance:r=1e-5,scale:i=!0}=t;this.tolerance=r,this.scale=i,this.latentVectors=t.latentVectors}}train(t,e){if(t=n.default.checkMatrix(t),e=n.default.checkMatrix(e),t.length!==e.length)throw new RangeError("The number of X rows must be equal to the number of Y rows");this.meanX=o.a.mean(t),this.stdDevX=o.a.standardDeviation(t,this.meanX,!0),this.meanY=o.a.mean(e),this.stdDevY=o.a.standardDeviation(e,this.meanY,!0),this.scale&&(t=t.clone().subRowVector(this.meanX).divRowVector(this.stdDevX),e=e.clone().subRowVector(this.meanY).divRowVector(this.stdDevY)),void 0===this.latentVectors&&(this.latentVectors=Math.min(t.length-1,t[0].length));for(var r=t.rows,i=t.columns,a=e.rows,u=e.columns,h=t.clone().mul(t).sum(),l=e.clone().mul(e).sum(),f=this.tolerance,p=this.latentVectors,m=n.default.zeros(r,p),g=n.default.zeros(i,p),d=n.default.zeros(a,p),v=n.default.zeros(u,p),y=n.default.zeros(p,p),w=g.clone(),b=0;s(e)>f&&b<p;){for(var x=t.transpose(),M=e.transpose(),S=c(t.clone().mulM(t)),A=c(e.clone().mulM(e)),E=t.getColumnVector(S),_=e.getColumnVector(A),k=n.default.zeros(r,1);s(E.clone().sub(k))>f;){var R=x.mmul(_);R.div(s(R)),k=E,E=t.mmul(R);var O=M.mmul(E);O.div(s(O)),_=e.mmul(O)}k=E;var C=x.mmul(k),F=k.transpose().mmul(k)[0][0],T=C.div(F),D=s(T);T.div(D),k.mul(D),R.mul(D),C=_.transpose().mmul(k),F=k.transpose().mmul(k)[0][0];var z=C.div(F)[0][0];t.sub(k.mmul(T.transpose())),e.sub(k.clone().mul(z).mmul(O.transpose())),m.setColumn(b,k),g.setColumn(b,T),d.setColumn(b,_),v.setColumn(b,O),w.setColumn(b,R),y[b][b]=z,b++}b--,m=m.subMatrix(0,m.rows-1,0,b),g=g.subMatrix(0,g.rows-1,0,b),d=d.subMatrix(0,d.rows-1,0,b),v=v.subMatrix(0,v.rows-1,0,b),w=w.subMatrix(0,w.rows-1,0,b),y=y.subMatrix(0,b,0,b),this.ssqYcal=l,this.E=t,this.F=e,this.T=m,this.P=g,this.U=d,this.Q=v,this.W=w,this.B=y,this.PBQ=g.mmul(y).mmul(v.transpose()),this.R2X=k.transpose().mmul(k).mmul(T.transpose().mmul(T)).div(h)[0][0]}predict(t){var e=n.default.checkMatrix(t);this.scale&&(e=e.subRowVector(this.meanX).divRowVector(this.stdDevX));var r=e.mmul(this.PBQ);return r=r.mulRowVector(this.stdDevY).addRowVector(this.meanY)}getExplainedVariance(){return this.R2X}toJSON(){return{name:"PLS",R2X:this.R2X,meanX:this.meanX,stdDevX:this.stdDevX,meanY:this.meanY,stdDevY:this.stdDevY,PBQ:this.PBQ,tolerance:this.tolerance,scale:this.scale}}static load(t){if("PLS"!==t.name)throw new RangeError("Invalid model: "+t.name);return new h(!0,t)}}function c(t){return t.sum("column").maxIndex()[0]}class l{constructor(t,e){if(!0===t)this.trainingSet=new n.Matrix(e.trainingSet),this.YLoadingMat=new n.Matrix(e.YLoadingMat),this.SigmaPow=new n.Matrix(e.SigmaPow),this.YScoreMat=new n.Matrix(e.YScoreMat),this.predScoreMat=u(e.predScoreMat,!1),this.YOrthLoadingVec=u(e.YOrthLoadingVec,!1),this.YOrthEigen=e.YOrthEigen,this.YOrthScoreMat=u(e.YOrthScoreMat,!1),this.toNorm=u(e.toNorm,!1),this.TURegressionCoeff=u(e.TURegressionCoeff,!1),this.kernelX=u(e.kernelX,!0),this.kernel=e.kernel,this.orthogonalComp=e.orthogonalComp,this.predictiveComp=e.predictiveComp;else{if(void 0===t.predictiveComponents)throw new RangeError("no predictive components found!");if(void 0===t.orthogonalComponents)throw new RangeError("no orthogonal components found!");if(void 0===t.kernel)throw new RangeError("no kernel found!");this.orthogonalComp=t.orthogonalComponents,this.predictiveComp=t.predictiveComponents,this.kernel=t.kernel}}train(t,e){t=n.Matrix.checkMatrix(t),e=n.Matrix.checkMatrix(e),this.trainingSet=t.clone();var r=this.kernel.compute(t),i=n.Matrix.eye(r.rows,r.rows,1),o=r;(r=new n.Matrix(this.orthogonalComp+1,this.orthogonalComp+1))[0][0]=o;var s=new n.SingularValueDecomposition(e.transpose().mmul(r[0][0]).mmul(e),{computeLeftSingularVectors:!0,computeRightSingularVectors:!1}),a=s.leftSingularVectors,u=s.diagonalMatrix;a=a.subMatrix(0,a.rows-1,0,this.predictiveComp-1),u=u.subMatrix(0,this.predictiveComp-1,0,this.predictiveComp-1);var h=e.mmul(a),c=new Array(this.orthogonalComp+1),l=new Array(this.orthogonalComp+1),f=new Array(this.orthogonalComp),p=new Array(this.orthogonalComp),m=new Array(this.orthogonalComp),g=new Array(this.orthogonalComp),d=n.Matrix.pow(u,-.5);d.apply(function(t,e){this[t][e]===1/0&&(this[t][e]=0)});for(var v=0;v<this.orthogonalComp;++v){c[v]=r[0][v].transpose().mmul(h).mmul(d);var y=c[v].transpose();l[v]=Object(n.inverse)(y.mmul(c[v])).mmul(y).mmul(h);var w=(s=new n.SingularValueDecomposition(y.mmul(n.Matrix.sub(r[v][v],c[v].mmul(y))).mmul(c[v]),{computeLeftSingularVectors:!0,computeRightSingularVectors:!1})).leftSingularVectors,b=s.diagonalMatrix;p[v]=w.subMatrix(0,w.rows-1,0,0),m[v]=b[0][0],f[v]=n.Matrix.sub(r[v][v],c[v].mmul(y)).mmul(c[v]).mmul(p[v]).mul(Math.pow(m[v],-.5));var x=f[v].transpose();g[v]=n.Matrix.sqrt(x.mmul(f[v])),f[v]=f[v].divRowVector(g[v]);var M=n.Matrix.sub(i,f[v].mmul(f[v].transpose()));r[0][v+1]=r[0][v].mmul(M),r[v+1][v+1]=M.mmul(r[v][v]).mmul(M)}var S=c[this.orthogonalComp]=r[0][this.orthogonalComp].transpose().mmul(h).mmul(d),A=S.transpose();l[this.orthogonalComp]=Object(n.inverse)(A.mmul(S)).mmul(A).mmul(h),this.YLoadingMat=a,this.SigmaPow=d,this.YScoreMat=h,this.predScoreMat=c,this.YOrthLoadingVec=p,this.YOrthEigen=m,this.YOrthScoreMat=f,this.toNorm=g,this.TURegressionCoeff=l,this.kernelX=r}predict(t){var e=this.kernel.compute(t,this.trainingSet),r=e;(e=new n.Matrix(this.orthogonalComp+1,this.orthogonalComp+1))[0][0]=r;var i,o=new Array(this.orthogonalComp),s=new Array(this.orthogonalComp);for(i=0;i<this.orthogonalComp;++i){s[i]=e[i][0].mmul(this.YScoreMat).mmul(this.SigmaPow),o[i]=n.Matrix.sub(e[i][i],s[i].mmul(this.predScoreMat[i].transpose())).mmul(this.predScoreMat[i]).mmul(this.YOrthLoadingVec[i]).mul(Math.pow(this.YOrthEigen[i],-.5)),o[i]=o[i].divRowVector(this.toNorm[i]);var a=this.YOrthScoreMat[i].transpose();e[i+1][0]=n.Matrix.sub(e[i][0],o[i].mmul(a).mmul(this.kernelX[0][i].transpose()));var u=n.Matrix.sub(e[i][0],e[i][i].mmul(this.YOrthScoreMat[i]).mmul(a)),h=o[i].mmul(a).mmul(this.kernelX[i][i]),c=h.mmul(this.YOrthScoreMat[i]).mmul(a);e[i+1][i+1]=u.sub(h).add(c)}return s[i]=e[i][0].mmul(this.YScoreMat).mmul(this.SigmaPow),{prediction:s[i].mmul(this.TURegressionCoeff[i]).mmul(this.YLoadingMat.transpose()),predScoreMat:s,predYOrthVectors:o}}toJSON(){return{name:"K-OPLS",YLoadingMat:this.YLoadingMat,SigmaPow:this.SigmaPow,YScoreMat:this.YScoreMat,predScoreMat:this.predScoreMat,YOrthLoadingVec:this.YOrthLoadingVec,YOrthEigen:this.YOrthEigen,YOrthScoreMat:this.YOrthScoreMat,toNorm:this.toNorm,TURegressionCoeff:this.TURegressionCoeff,kernelX:this.kernelX,trainingSet:this.trainingSet,orthogonalComp:this.orthogonalComp,predictiveComp:this.predictiveComp}}static load(t,e){if("K-OPLS"!==t.name)throw new RangeError("Invalid model: "+t.name);if(!e)throw new RangeError("You must provide a kernel for the model!");return t.kernel=e,new l(!0,t)}}r.d(e,"PLS",function(){return h}),r.d(e,"KOPLS",function(){return l})},function(t,e,r){"use strict";r.r(e);var n=r(7),i=r.n(n),o=r(156),s=r.n(o);function a(t,e,r,n){for(var i=0;i<t.length;i++)r[i]=s()(e,t[i],{distanceFunction:n});return r}function u(t,e){return Math.floor(e()*t)}var h=function(t,e={},r=Math.random){const{size:n=1,replace:i=!1}=e;let o;if(o="number"==typeof t?function(t){const e=[];for(let r=0;r<t;r++)e.push(r);return e}(t):t.slice(),!1===i&&n>o.length)throw new Error("size option is too large");const s=[];for(let t=0;t<n;t++){const t=u(o.length,r);s.push(o[t]),i||o.splice(t,1)}return s};const c=r(98);class l{constructor(t=Math.random){if("number"==typeof t){const e=new c(t);this.randomGenerator=e.random}else this.randomGenerator=t}choice(t,e){return h(t,e,this.randomGenerator)}random(){return this.randomGenerator()}}const f=Symbol("distance");class p{constructor(t,e,r,n,i){this.clusters=t,this.centroids=e,this.converged=r,this.iterations=n,this[f]=i}nearest(t){const e=new Array(t.length);return a(t,this.centroids.map(function(t){return t.centroid}),e,this[f])}computeInformation(t){for(var e=this.centroids.map(function(t){return{centroid:t,error:0,size:0}}),r=0;r<t.length;r++)e[this.clusters[r]].error+=this[f](t[r],this.centroids[this.clusters[r]]),e[this.clusters[r]].size++;for(var n=0;n<this.centroids.length;n++)e[n].error/=e[n].size;return new p(this.clusters,e,this.converged,this.iterations,this[f])}}r.d(e,"default",function(){return d});const m={maxIterations:100,tolerance:1e-6,withIterations:!1,initialization:"mostDistant",distanceFunction:i.a.squared};function g(t,e,r,n,i,o){var s=function(t,e,r){const n=t[0].length;for(var i=new Array(r),o=new Array(r),s=0;s<r;s++){i[s]=new Array(n),o[s]=0;for(var a=0;a<n;a++)i[s][a]=0}for(var u=0;u<t.length;u++){o[e[u]]++;for(var h=0;h<n;h++)i[e[u]][h]+=t[u][h]}for(var c=0;c<r;c++)for(var l=0;l<n;l++)i[c][l]/=o[c];return i}(e,r=a(e,t,r,i.distanceFunction),n),u=function(t,e,r,n){for(var i=0;i<t.length;i++)if(r(t[i],e[i])>n)return!1;return!0}(s,t,i.distanceFunction,i.tolerance);return new p(r,s,u,o,i.distanceFunction)}function d(t,e,r){if(r=Object.assign({},m,r),e<=0||e>t.length||!Number.isInteger(e))throw new Error("K should be a positive integer smaller than the number of points");var n;if(Array.isArray(r.initialization)){if(r.initialization.length!==e)throw new Error("The initial centers should have the same length as K");n=r.initialization}else switch(r.initialization){case"random":n=function(t,e,r){return new l(r).choice(t,{size:e})}(t,e,r.seed);break;case"mostDistant":n=function(t,e,r,n){const i=new l(n);var o=new Array(e);if(o[0]=Math.floor(i.random()*t.length),e>1){for(var s={dist:-1,index:-1},a=0;a<t.length;++a)r[o[0]][a]>s.dist&&(s.dist=r[o[0]][a],s.index=a);if(o[1]=s.index,e>2)for(var u=2;u<e;++u){for(var h={dist:-1,index:-1},c=0;c<t.length;++c){for(var f={dist:Number.MAX_VALUE,index:-1},p=0;p<u;++p)r[p][c]<f.dist&&-1===o.indexOf(c)&&(f={dist:r[p][c],index:c});f.dist!==Number.MAX_VALUE&&f.dist>h.dist&&(h=Object.assign({},f))}o[u]=h.index}}return o.map(e=>t[e])}(t,e,function(t,e){for(var r=new Array(t.length),n=0;n<t.length;++n)for(var i=n;i<t.length;++i){r[n]||(r[n]=new Array(t.length)),r[i]||(r[i]=new Array(t.length));const o=e(t[n],t[i]);r[n][i]=o,r[i][n]=o}return r}(t,r.distanceFunction),r.seed);break;default:throw new Error(`Unknown initialization method: "${r.initialization}"`)}0===r.maxIterations&&(r.maxIterations=Number.MAX_VALUE);var i=new Array(t.length);if(r.withIterations)return function*(t,e,r,n,i){for(var o,s=!1,a=0;!s&&a<i.maxIterations;)yield(o=g(t,e,r,n,i,++a)).computeInformation(e),s=o.converged,t=o.centroids}(n,t,i,e,r);for(var o,s=!1,a=0;!s&&a<r.maxIterations;)s=(o=g(n,t,i,e,r,++a)).converged,n=o.centroids;return o.computeInformation(t)}},function(t,e,r){"use strict";r.r(e);var n=r(32),i=r(0),o=r(41),s=r.n(o);function a(t,e,r){var n=s.a.engines.mt19937(),o=s.a.integer(0,t.rows-1);if(void 0===r)n=n.autoSeed();else{if(!Number.isInteger(r))throw new RangeError(`Expected seed must be undefined or integer not ${r}`);n=n.seed(r)}for(var a=new Array(t.rows),u=new Array(t.rows),h=0;h<t.rows;++h){var c=o(n);a[h]=t[c],u[h]=e[c]}return{X:new i.default(a),y:u}}function u(t,e,r,n){if(t.columns<e)throw new RangeError("N should be less or equal to the number of columns of X");var o=s.a.integer(0,t.columns-1),a=s.a.engines.mt19937();if(void 0===n)a=a.autoSeed();else{if(!Number.isInteger(n))throw new RangeError(`Expected seed must be undefined or integer not ${n}`);a=a.seed(n)}var u=new i.default(t.rows,e);if(r)for(var h=new Array(e),c=0;c<e;++c){var l=o(a);h[c]=l,u.setColumn(c,t.getColumn(l))}else{for(h=new Set,l=o(a),c=0;c<e;++c){for(;h.has(l);)l=o(a);u.setColumn(c,t.getColumn(l)),h.add(l)}h=Array.from(h)}return{X:u,usedIndex:h}}class h{constructor(t,e){if(!0===t){this.replacement=e.replacement,this.maxFeatures=e.maxFeatures,this.nEstimators=e.nEstimators,this.treeOptions=e.treeOptions,this.isClassifier=e.isClassifier,this.seed=e.seed,this.n=e.n,this.indexes=e.indexes,this.useSampleBagging=e.useSampleBagging;var r=this.isClassifier?n.DecisionTreeClassifier:n.DecisionTreeRegression;this.estimators=e.estimators.map(t=>r.load(t))}else this.replacement=t.replacement,this.maxFeatures=t.maxFeatures,this.nEstimators=t.nEstimators,this.treeOptions=t.treeOptions,this.isClassifier=t.isClassifier,this.seed=t.seed,this.useSampleBagging=t.useSampleBagging}train(t,e){if(t=i.Matrix.checkMatrix(t),this.maxFeatures=this.maxFeatures||t.columns,(r=this.maxFeatures)>0&&r<=1)this.n=Math.floor(t.columns*this.maxFeatures);else{if(!Number.isInteger(this.maxFeatures))throw new RangeError(`Cannot process the maxFeatures parameter ${this.maxFeatures}`);if(this.maxFeatures>t.columns)throw new RangeError(`The maxFeatures parameter should be less than ${t.columns}`);this.n=this.maxFeatures}var r;if(this.isClassifier)var o=n.DecisionTreeClassifier;else o=n.DecisionTreeRegression;this.estimators=new Array(this.nEstimators),this.indexes=new Array(this.nEstimators);for(var s=0;s<this.nEstimators;++s){var h=this.useSampleBagging?a(t,e,this.seed):{X:t,y:e},c=h.X,l=h.y;c=(h=u(c,this.n,this.replacement,this.seed)).X,this.indexes[s]=h.usedIndex,this.estimators[s]=new o(this.treeOptions),this.estimators[s].train(c,l)}}selection(t){throw new Error("Abstract method 'selection' not implemented!")}predict(t){var e=new Array(this.nEstimators);t=i.Matrix.checkMatrix(t);for(var r=0;r<this.nEstimators;++r){var n=t.columnSelectionView(this.indexes[r]);e[r]=this.estimators[r].predict(n)}e=new i.WrapperMatrix2D(e).transposeView();var o=new Array(e.rows);for(r=0;r<e.rows;++r)o[r]=this.selection(e.getRow(r));return o}toJSON(){return{indexes:this.indexes,n:this.n,replacement:this.replacement,maxFeatures:this.maxFeatures,nEstimators:this.nEstimators,treeOptions:this.treeOptions,isClassifier:this.isClassifier,seed:this.seed,estimators:this.estimators.map(t=>t.toJSON()),useSampleBagging:this.useSampleBagging}}}const c={maxFeatures:1,replacement:!0,nEstimators:10,seed:42,useSampleBagging:!1};class l extends h{constructor(t,e){!0===t?super(!0,e.baseModel):((t=Object.assign({},c,t)).isClassifier=!0,super(t))}selection(t){return(e=t).sort((t,r)=>e.filter(e=>e===t).length-e.filter(t=>t===r).length).pop();var e}toJSON(){return{baseModel:super.toJSON(),name:"RFClassifier"}}static load(t){if("RFClassifier"!==t.name)throw new RangeError(`Invalid model: ${t.name}`);return new l(!0,t)}}var f=r(31),p=r(157),m=r.n(p);const g={mean:f.a,median:function(t){if(!Array.isArray(t))throw new Error("input must be an array");if(0===t.length)throw new Error("input must not be empty");return m()(t.slice())}},d={maxFeatures:1,replacement:!1,nEstimators:10,treeOptions:{},selectionMethod:"mean",seed:42,useSampleBagging:!1};class v extends h{constructor(t,e){if(!0===t)super(!0,e.baseModel),this.selectionMethod=e.selectionMethod;else{if("mean"!==(t=Object.assign({},d,t)).selectionMethod&&"median"!==t.selectionMethod)throw new RangeError(`Unsupported selection method ${t.selectionMethod}`);t.isClassifier=!1,super(t),this.selectionMethod=t.selectionMethod}}selection(t){return g[this.selectionMethod](t)}toJSON(){return{baseModel:super.toJSON(),selectionMethod:this.selectionMethod,name:"RFRegression"}}static load(t){if("RFRegression"!==t.name)throw new RangeError(`Invalid model: ${t.name}`);return new v(!0,t)}}r.d(e,"RandomForestClassifier",function(){return l}),r.d(e,"RandomForestRegression",function(){return v})},function(t,e,r){"use strict";!function(){function e(t){return new Promise(function(e,r){t.onsuccess=function(){e(t.result)},t.onerror=function(){r(t.error)}})}function r(t,r,n){var i,o=new Promise(function(o,s){e(i=t[r].apply(t,n)).then(o,s)});return o.request=i,o}function n(t,e,r){r.forEach(function(r){Object.defineProperty(t.prototype,r,{get:function(){return this[e][r]},set:function(t){this[e][r]=t}})})}function i(t,e,n,i){i.forEach(function(i){i in n.prototype&&(t.prototype[i]=function(){return r(this[e],i,arguments)})})}function o(t,e,r,n){n.forEach(function(n){n in r.prototype&&(t.prototype[n]=function(){return this[e][n].apply(this[e],arguments)})})}function s(t,e,n,i){i.forEach(function(i){i in n.prototype&&(t.prototype[i]=function(){return t=this[e],(n=r(t,i,arguments)).then(function(t){if(t)return new u(t,n.request)});var t,n})})}function a(t){this._index=t}function u(t,e){this._cursor=t,this._request=e}function h(t){this._store=t}function c(t){this._tx=t,this.complete=new Promise(function(e,r){t.oncomplete=function(){e()},t.onerror=function(){r(t.error)},t.onabort=function(){r(t.error)}})}function l(t,e,r){this._db=t,this.oldVersion=e,this.transaction=new c(r)}function f(t){this._db=t}n(a,"_index",["name","keyPath","multiEntry","unique"]),i(a,"_index",IDBIndex,["get","getKey","getAll","getAllKeys","count"]),s(a,"_index",IDBIndex,["openCursor","openKeyCursor"]),n(u,"_cursor",["direction","key","primaryKey","value"]),i(u,"_cursor",IDBCursor,["update","delete"]),["advance","continue","continuePrimaryKey"].forEach(function(t){t in IDBCursor.prototype&&(u.prototype[t]=function(){var r=this,n=arguments;return Promise.resolve().then(function(){return r._cursor[t].apply(r._cursor,n),e(r._request).then(function(t){if(t)return new u(t,r._request)})})})}),h.prototype.createIndex=function(){return new a(this._store.createIndex.apply(this._store,arguments))},h.prototype.index=function(){return new a(this._store.index.apply(this._store,arguments))},n(h,"_store",["name","keyPath","indexNames","autoIncrement"]),i(h,"_store",IDBObjectStore,["put","add","delete","clear","get","getAll","getKey","getAllKeys","count"]),s(h,"_store",IDBObjectStore,["openCursor","openKeyCursor"]),o(h,"_store",IDBObjectStore,["deleteIndex"]),c.prototype.objectStore=function(){return new h(this._tx.objectStore.apply(this._tx,arguments))},n(c,"_tx",["objectStoreNames","mode"]),o(c,"_tx",IDBTransaction,["abort"]),l.prototype.createObjectStore=function(){return new h(this._db.createObjectStore.apply(this._db,arguments))},n(l,"_db",["name","version","objectStoreNames"]),o(l,"_db",IDBDatabase,["deleteObjectStore","close"]),f.prototype.transaction=function(){return new c(this._db.transaction.apply(this._db,arguments))},n(f,"_db",["name","version","objectStoreNames"]),o(f,"_db",IDBDatabase,["close"]),["openCursor","openKeyCursor"].forEach(function(t){[h,a].forEach(function(e){t in e.prototype&&(e.prototype[t.replace("open","iterate")]=function(){var e,r=(e=arguments,Array.prototype.slice.call(e)),n=r[r.length-1],i=this._store||this._index,o=i[t].apply(i,r.slice(0,-1));o.onsuccess=function(){n(o.result)}})})}),[a,h].forEach(function(t){t.prototype.getAll||(t.prototype.getAll=function(t,e){var r=this,n=[];return new Promise(function(i){r.iterateCursor(t,function(t){t?(n.push(t.value),void 0===e||n.length!=e?t.continue():i(n)):i(n)})})})});var p={open:function(t,e,n){var i=r(indexedDB,"open",[t,e]),o=i.request;return o.onupgradeneeded=function(t){n&&n(new l(o.result,t.oldVersion,o.transaction))},i.then(function(t){return new f(t)})},delete:function(t){return r(indexedDB,"deleteDatabase",[t])}};t.exports=p,t.exports.default=t.exports}()},function(t,e,r){"use strict";Object.defineProperty(e,"__esModule",{value:!0});var n=r(21),i=r(163),o=function(){function t(t){this.hasIDB=!0,//!> "indexedDB" in window; -- window isn't accessible from a worker
this.items=[],this.IS_IOS=/iphone|ipad/i.test(navigator.userAgent),this.config=t,this.hasIDB&&this.init()}return t.prototype.init=function(){var t=this;this.dbprom=i.open("HumBeatz",1,function(t){t.objectStoreNames.contains("features")||t.createObjectStore("features",{keyPath:"id",autoIncrement:!0}),console.log("db created")}).catch(function(e){t.hasIDB=!1,console.log(e.message)})},t.prototype.load=function(){var t=this;return new Promise(function(e,r){if(t.IS_IOS){for(var i=[],o=Object.keys(void 0),s=0;s<o.length;s++){var a=(void 0).getItem(o[s]),u=JSON.parse(a);if(u){var h=n.base64ToArrayBuffer(u.signal);u.signal=new Float32Array(h),i.push(u)}}t.items=t.splitClusters(i),e(i)}else t.hasIDB||r(),t.dbprom.then(function(t){return t.transaction("features").objectStore("features").getAll()}).then(function(r){t.items=t.splitClusters(r),e(r)}).catch(r)})},t.prototype.clear=function(){if(this.IS_IOS)for(var t=Object.keys(void 0),e=0;e<t.length;e++)(void 0).removeItem(t[e]);else{if(!this.hasIDB)return!1;this.dbprom.then(function(t){t.transaction("features","readwrite").objectStore("features").clear()})}return!0},t.prototype.save=function(t){for(var e=new Array(this.config.maxClusters),r=(new Date).getTime(),n=this.splitClusters(t),i=0;i<n.length;i++)if(n[i]){var o=n[i],s=Math.min(o.length,this.config.maxPredetects);e[i]={itemsToAdd:[]};for(var a=0;a<s;a++){var u=o[a],h={id:r+"-"+u.id,created:r,cluster:i,signal:new Blob([u.signal],{type:"octet/stream"}),signal2:u.signal};e[i].itemsToAdd.push(h)}}for(i=0;i<e.length;i++)if(e[i]){var c=e[i],l=(s=c.itemsToAdd.length,(o=this.items[i])?o.length:0);if(s+l>this.config.maxPredetects){var f=s-(this.config.maxPredetects-l);c.itemsToRemove=o.splice(o.length-f,f)}else c.itemsToRemove=[]}return this._save(e)},t.prototype.remove=function(t){return this._save([{itemsToAdd:[],itemsToRemove:this.items[t]}])},t.prototype.splitClusters=function(t){var e=new Array(this.config.maxClusters);t.forEach(function(t){e[this.slice.cluster]||(e[this.slice.cluster]=[]),e[this.slice.cluster].push(t)});for(var r=0;r<e.length;r++)e[r]&&e[r].sort(function(t,e){return e.created-t.created});return e},t.prototype._save=function(t){var e=this;return new Promise(function(r,i){if(e.IS_IOS){for(var o=0;o<t.length;o++){var s=t[o];if(s){for(var a=0;a<s.itemsToAdd.length;a++){(h=s.itemsToAdd[a]).signal=n.arrayBufferToBase64String(h.signal2.buffer),h.signal2=null;var u=JSON.stringify(h);(void 0).setItem(h.id,u)}for(a=0;a<s.itemsToRemove.length;a++){var h=s.itemsToRemove[a];(void 0).removeItem(h.id)}}}r()}else e.hasIDB||i(),e.dbprom.then(function(e){for(var r=e.transaction("features","readwrite"),n=r.objectStore("features"),i=0;i<t.length;i++){var o=t[i];if(o){for(var s=0;s<o.itemsToAdd.length;s++)n.add(o.itemsToAdd[s]);for(s=0;s<o.itemsToRemove.length;s++)n.delete(o.itemsToRemove[s].id)}}return r.complete}).then(function(){r()}).catch(function(t){console.log(t.message),i()})})},t}();e.FeatureStorage=o},function(t,e,r){"use strict";e.SNV=function(t){for(var e=n.mean(t),r=n.standardDeviation(t),i=t.slice(),o=0;o<t.length;o++)i[o]=(i[o]-e)/r;return i};var n=r(15).array},function(t,e,r){"use strict";function n(t,e,r,n){return.5*r*e*e+n*e-(.5*r*t*t+n*t)}e.getEquallySpacedData=function(t,e,r={}){var i=t.length;t.length>1&&t[0]>t[1]&&(t=t.slice().reverse(),e=e.slice().reverse());var{from:o=t[0],to:s=t[i-1],variant:a="smooth",numberOfPoints:u=100}=r;if(i!==e.length)throw new RangeError("the x and y vector doesn't have the same size.");if("number"!=typeof o||isNaN(o))throw new RangeError("'from' option must be a number");if("number"!=typeof s||isNaN(s))throw new RangeError("'to' option must be a number");var h=o>s;if(h&&([o,s]=[s,o]),"number"!=typeof u||isNaN(u))throw new RangeError("'numberOfPoints' option must be a number");if(u<1)throw new RangeError("the number of points must be at least 1");var c="slot"===a?function(t,e,r,n,i){var o=t.length,s=(n-r)/(i-1),a=s/2,u=t[t.length-1]-t[t.length-2],h=r-a,c=new Array(i),l=h,f=h+s,p=-Number.MAX_VALUE,m=0,g=t[0],d=e[0],v=0,y=!0,w=0,b=0,x=1,M=0;t:for(;;){if(p>=g)throw new Error("x must be an increasing serie");for(;p-f>0;){if(y&&(b++,y=!1),c[M]=b<=0?0:w/b,++M===i)break t;l=f,f+=s,w=0,b=0}p>l&&(w+=m,b++),(p===-Number.MAX_VALUE||v>1)&&b--,p=g,m=d,x<o?(g=t[x],d=e[x],x++):(g+=u,d=0,v++)}return c}(t,e,o,s,u):function(t,e,r,i,o){var s=t.length,a=(i-r)/(o-1),u=a/2,h=new Array(o),c=t[1]-t[0],l=t[s-1]-t[s-2],f=r-u,p=r+u,m=Number.MIN_VALUE,g=0,d=t[0]-c,v=0,y=0,w=0,b=0,x=0,M=0,S=0,A=0;t:for(;;){for(m<=f&&f<=d&&(E=n(0,f-m,w,g),x=y+E);d-p>=0;){var E=n(0,p-m,w,g);if(M=y+E,h[A++]=(M-x)/a,A===o)break t;f=p,p+=a,x=M}y+=n(m,d,w,b),m=d,g=v,S<s?(d=t[S],v=e[S],S++):S===s&&(d+=l,v=0),b=-(w=(v-g)/(d-m))*m+g}return h}(t,e,o,s,u);return h?c.reverse():c},e.integral=n},function(t,e,r){"use strict";const n=r(15).array;function i(t){for(var e=new Array(t[0].length),r=0;r<e.length;++r)e[r]=new Array(t.length);for(r=0;r<t.length;++r)for(var n=0;n<t[0].length;++n)e[n][r]=t[r][n];return e}t.exports={coordArrayToPoints:function(t,e){if(t.length%e!=0)throw new RangeError("Dimensions number must be accordance with the size of the array.");for(var r=t.length/e,n=new Array(r),i=0,o=0;o<t.length;o+=e){for(var s=new Array(e),a=0;a<e;++a)s[a]=t[o+a];n[i]=s,i++}return n},coordArrayToCoordMatrix:function(t,e){if(t.length%e!=0)throw new RangeError("Dimensions number must be accordance with the size of the array.");for(var r=new Array(e),n=t.length/e,i=0;i<r.length;i++)r[i]=new Array(n);for(i=0;i<t.length;i+=e)for(var o=0;o<e;++o){var s=Math.floor(i/e);r[o][s]=t[i+o]}return r},coordMatrixToCoordArray:function(t){for(var e=new Array(t.length*t[0].length),r=0,n=0;n<t[0].length;++n)for(var i=0;i<t.length;++i)e[r]=t[i][n],++r;return e},coordMatrixToPoints:i,pointsToCoordArray:function(t){for(var e=new Array(t.length*t[0].length),r=0,n=0;n<t.length;++n)for(var i=0;i<t[0].length;++i)e[r]=t[n][i],++r;return e},pointsToCoordMatrix:i,applyDotProduct:function(t,e){var r,n;t.length<=e.length?(n=t,r=e):(n=e,r=t);for(var i=r.length-n.length+1,o=new Array(i),s=0;s<i;++s){for(var a=0,u=0;u<n.length;++u)a+=n[u]*r[s+u];o[s]=a}return o},scale:function t(e,r={}){const{min:i,max:o}=r;var s=r.inPlace?e:new Array(e.length),a=n.minMax(e);if("number"==typeof o)if("number"==typeof i){let t=(o-i)/(a.max-a.min);for(let r=0;r<s.length;r++)s[r]=(e[r]-a.min)*t+i}else if(0!==a.max){let t=o/a.max;for(let r=0;r<s.length;r++)s[r]=e[r]*t}else r.min=a.min,s=t(e,r);else if("number"==typeof i)if(0!==a.min){let t=i/a.min;for(let r=0;r<s.length;r++)s[r]=e[r]*t}else r.max=a.max,s=t(e,r);return s}}},function(t,e,r){"use strict";t.exports=e=r(167),e.getEquallySpacedData=r(166).getEquallySpacedData,e.SNV=r(165).SNV},function(t,e){for(var r=new Array(256),n=0;n<256;n++){for(var i=n,o=0;i;)i&=i-1,o++;r[n]=o}t.exports=r},function(t,e,r){"use strict";var n=r(169);function i(t){for(var e="",r=0;r<t.length;r++){var n=(t[r]>>>0).toString(2);e+="00000000000000000000000000000000".substr(n.length)+n}return e}t.exports={count:function(t){for(var e=0,r=0;r<t.length;r++)e+=n[255&t[r]]+n[t[r]>>8&255]+n[t[r]>>16&255]+n[t[r]>>24&255];return e},and:function(t,e){for(var r=new Array(t.length),n=0;n<t.length;n++)r[n]=t[n]&e[n];return r},or:function(t,e){for(var r=new Array(t.length),n=0;n<t.length;n++)r[n]=t[n]|e[n];return r},xor:function(t,e){for(var r=new Array(t.length),n=0;n<t.length;n++)r[n]=t[n]^e[n];return r},not:function(t){for(var e=new Array(t.length),r=0;r<e.length;r++)e[r]=~t[r];return e},getBit:function(t,e){var r=1<<31-e%32;return Boolean(t[e>>5]&r)},setBit:function(t,e,r){var n=e>>5,i=1<<31-e%32;return t[n]=r?i|t[n]:~i&t[n],t},toBinaryString:i,parseBinaryString:function(t){for(var e=t.length/32,r=new Array(e),n=0;n<e;n++)r[n]=0|parseInt(t.substr(32*n,32),2);return r},toHexString:function(t){for(var e="",r=0;r<t.length;r++){var n=(t[r]>>>0).toString(16);e+="00000000".substr(n.length)+n}return e},parseHexString:function(t){for(var e=t.length/8,r=new Array(e),n=0;n<e;n++)r[n]=0|parseInt(t.substr(8*n,8),16);return r},toDebug:function(t){for(var e=i(t),r="",n=0;n<t.length;n++){r+="0000".substr((32*n).toString(16).length)+(32*n).toString(16)+":";for(var o=0;o<32;o+=4)r+=" "+e.substr(32*n+o,4);n<t.length-1&&(r+="\n")}return r}}},function(t,e,r){var n=r(61),i=(r(15),{windowSize:9,derivative:0,polynomial:3});function o(t,e,r,n){for(var i=0,o=0,s=e-r;s<e+r;s++)s>=0&&s<t.length-1&&(i+=t[s+1]-t[s],o++);return Math.pow(i/o,n)}function s(t,e,r,n){return r>0?(4*r-2)/(r*(2*e-r+1))*(t*s(t,e,r-1,n)+n*s(t,e,r-1,n-1))-(r-1)*(2*e+r)/(r*(2*e-r+1))*s(t,e,r-2,n):0==r&&0==n?1:0}function a(t,e){var r=1;if(t>=e)for(var n=t-e+1;n<=t;n++)r*=n;return r}function u(t,e,r,n,i){for(var o=0,u=0;u<=n;u++)o+=(2*u+1)*(a(2*r,u)/a(2*r+u+1,u+1))*s(t,r,u,0)*s(e,r,u,i);return o}t.exports=function(t,e,r){if((r=n({},i,r)).windowSize%2==0||r.windowSize<5||!Number.isInteger(r.windowSize))throw new RangeError("Invalid window size (should be odd and at least 5 integer number)");if(r.windowSize>t.length)throw new RangeError("Window size is higher than the data length "+r.windowSize+">"+t.length);if(r.derivative<0||!Number.isInteger(r.derivative))throw new RangeError("Derivative should be a positive integer");if(r.polynomial<1||!Number.isInteger(r.polynomial))throw new RangeError("Polynomial should be a positive integer");r.polynomial>=6&&console.warn("You should not use polynomial grade higher than 5 if you are not sure that your data arises from such a model. Possible polynomial oscillation problems");var s=r.windowSize,a=Math.floor(s/2),h=t.length,c=new Array(h),l=function(t,e,r){for(var n=new Array(t),i=Math.floor(t/2),o=-i;o<=i;o++){n[o+i]=new Array(t);for(var s=-i;s<=i;s++)n[o+i][s+i]=u(s,o,i,e,r)}return n}(s,r.polynomial,r.derivative),f=0,p=!0;"[object Array]"===Object.prototype.toString.call(e)?p=!1:f=Math.pow(e,r.derivative);for(var m=0;m<a;m++){for(var g=l[a-m-1],d=l[a+m+1],v=0,y=0,w=0;w<s;w++)v+=g[w]*t[w],y+=d[w]*t[h-s+w-1];p?(c[a-m-1]=v/f,c[h-a+m]=y/f):(f=o(e,a-m-1,a,r.derivative),c[a-m-1]=v/f,f=o(e,h-a+m,a,r.derivative),c[h-a+m]=y/f)}var b=l[a];for(m=s;m<h+1;m++){var x=0;for(w=0;w<s;w++)x+=b[w]*t[w+m-s];p||(f=o(e,m-a-1,a,r.derivative)),c[m-a-1]=x/f}return c}},function(t,e,r){"use strict";var n=r(0),i=n.Matrix,o=n.inverse,s=r(80),a=r(61),u={windowSize:5,derivative:1,polynomial:2,pad:"none",padValue:"replicate"};t.exports=function(t,e,r){if((r=a({},u,r)).windowSize%2==0||r.windowSize<5||!Number.isInteger(r.windowSize))throw new RangeError("Invalid window size (should be odd and at least 5 integer number)");if(r.derivative<0||!Number.isInteger(r.derivative))throw new RangeError("Derivative should be a positive integer");if(r.polynomial<1||!Number.isInteger(r.polynomial))throw new RangeError("Polynomial should be a positive integer");var n,h,c=Math.floor(r.windowSize/2);"pre"===r.pad&&(t=s(t,{size:c,value:r.padValue}));var l=new Array(t.length-2*c);if(5!==r.windowSize||2!==r.polynomial||1!==r.derivative&&2!==r.derivative){for(var f=i.ones(r.windowSize,r.polynomial+1),p=-(r.windowSize-1)/2,m=0;m<f.length;m++)for(var g=0;g<f[m].length;g++)p+1===0&&0===g||(f[m][g]=Math.pow(p+m,g));var d=f.transposeView();n=(n=o(d.mmul(f)).mmul(d))[r.derivative],h=1}else 1===r.derivative?(n=[-2,-1,0,1,2],h=10):(n=[2,-1,-2,-1,2],h=7);for(var v=h*Math.pow(e,r.derivative),y=c;y<t.length-c;y++){for(var w=0,b=0;b<n.length;b++)w+=n[b]*t[b+y-c]/v;l[y-c]=w}return"post"===r.pad&&(l=s(l,{size:c,value:r.padValue})),l}},function(t,e,r){"use strict";e.acc=(t=>{const e=t.cutoffs.length,r=new Array(e);for(var n=0;n<e;n++)r[n]=(t.tn[n]+t.tp[n])/(e-1);return r}),e.err=(t=>{const e=t.cutoffs.length,r=new Array(e);for(var n=0;n<e;n++)r[n]=t.fn[n]+t.fp[n]/(e-1);return r}),e.fpr=(t=>{const e=t.cutoffs.length,r=new Array(e);for(var n=0;n<e;n++)r[n]=t.fp[n]/t.nNeg;return r}),e.tpr=(t=>{const e=t.cutoffs.length,r=new Array(e);for(var n=0;n<e;n++)r[n]=t.tp[n]/t.nPos;return r}),e.fnr=(t=>{const e=t.cutoffs.length,r=new Array(e);for(var n=0;n<e;n++)r[n]=t.fn[n]/t.nPos;return r}),e.tnr=(t=>{const e=t.cutoffs.length,r=new Array(e);for(var n=0;n<e;n++)r[n]=t.tn[n]/t.nNeg;return r}),e.ppv=(t=>{const e=t.cutoffs.length,r=new Array(e);for(var n=0;n<e;n++)r[n]=t.fp[n]+t.tp[n]!==0?t.tp[n]/(t.fp[n]+t.tp[n]):0;return r}),e.npv=(t=>{const e=t.cutoffs.length,r=new Array(e);for(var n=0;n<e;n++)r[n]=t.fn[n]+t.tn[n]!==0?t.tn[n]/(t.fn[n]+t.tn[n]):0;return r}),e.pcfall=(t=>{const e=t.cutoffs.length,r=new Array(e);for(var n=0;n<e;n++)r[n]=t.fp[n]+t.tp[n]!==0?1-t.tp[n]/(t.fp[n]+t.tp[n]):1;return r}),e.pcmiss=(t=>{const e=t.cutoffs.length,r=new Array(e);for(var n=0;n<e;n++)r[n]=t.fn[n]+t.tn[n]!==0?1-t.tn[n]/(t.fn[n]+t.tn[n]):1;return r}),e.lift=(t=>{const e=t.cutoffs.length,r=new Array(e);for(var n=0;n<e;n++)r[n]=0!==t.nPosPred[n]?t.tp[n]/t.nPos/(t.nPosPred[n]/t.nSamples):0;return r}),e.rpp=(t=>{const e=t.cutoffs.length,r=new Array(e);for(var n=0;n<e;n++)r[n]=t.nPosPred[n]/t.nSamples;return r}),e.rnp=(t=>{const e=t.cutoffs.length,r=new Array(e);for(var n=0;n<e;n++)r[n]=t.nNegPred[n]/t.nSamples;return r}),e.threshold=(t=>{const e=t.cutoffs.slice();return e[0]=e[1],e})},function(t,e,r){"use strict";const n=r(173);class i{constructor(t,e,r){if(r=r||{},t.length!==e.length||t[0].length!==e[0].length)throw new Error("dimensions of prediction and target do not match");const n=t.length,i=t[0].length,o=!r.max,s=[];if(r.all)for(var a=0;a<n;a++)for(var u=0;u<i;u++)s.push({pred:t[a][u],targ:e[a][u]});else{if(n<3||n!==i)throw new Error('When "all" option is false, the prediction matrix must be square and have at least 3 columns');for(a=0;a<n-1;a++)for(u=a+1;u<i;u++)s.push({pred:t[a][u],targ:e[a][u]})}o?s.sort((t,e)=>t.pred-e.pred):s.sort((t,e)=>e.pred-t.pred);const h=this.cutoffs=[o?Number.MIN_VALUE:Number.MAX_VALUE],c=this.fp=[0],l=this.tp=[0];var f=0,p=0,m=s[0].pred,g=0,d=0;for(a=0;a<s.length;a++)s[a].pred!==m&&(h.push(m),c.push(d),l.push(g),m=s[a].pred),s[a].targ?(f++,g++):(p++,d++);h.push(m),c.push(d),l.push(g);const v=h.length,y=this.fn=new Array(v),w=this.tn=new Array(v),b=this.nPosPred=new Array(v),x=this.nNegPred=new Array(v);for(a=0;a<v;a++)y[a]=f-l[a],w[a]=p-c[a],b[a]=l[a]+c[a],x[a]=w[a]+y[a];this.nPos=f,this.nNeg=p,this.nSamples=f+p}getMeasure(t){if("string"!=typeof t)throw new Error("No measure specified");if(!n[t])throw new Error(`The specified measure (${t}) does not exist`);return n[t](this)}getAURC(){const t=this.cutoffs.length,e=new Array(t),r=new Array(t);for(var n=0;n<t;n++)e[n]=this.fp[n]/this.nNeg,r[n]=this.tp[n]/this.nPos;var i=0;for(n=1;n<t;n++)i+=.5*(e[n]-e[n-1])*(r[n]+r[n-1]);return i}getAUDC(){const t=this.cutoffs.length,e=new Array(t),r=new Array(t);for(var n=0;n<t;n++)e[n]=this.fn[n]/this.nPos,r[n]=this.fp[n]/this.nNeg;var i=0;for(n=1;n<t;n++)i+=.5*(e[n]+e[n-1])*(r[n]-r[n-1]);return i}getDistribution(t){t=t||{};for(var e=this.cutoffs.length,r=t.xMin||Math.floor(100*this.cutoffs[e-1])/100,n=t.xMax||Math.ceil(100*this.cutoffs[1])/100,i=t.interval||Math.floor((n-r)/20*1e7-1)/1e7,o=[],s=[],a=[],u=[],h=[],c=this.tp[e-1],l=0,f=this.fp[e-1],p=0,m=r,g=e-1;m<=n;m+=i){for(;this.cutoffs[g]<m;)g--;o.push(m);var d=c-l-this.tp[g],v=f-p-this.fp[g];l+=d,p+=v,s.push(v),a.push(d),u.push(100-(f-this.fp[g])/f*100),h.push(100-(c-this.tp[g])/c*100)}return{xLabels:o,interValues:s,intraValues:a,interCumPercent:u,intraCumPercent:h}}}i.names={acc:"Accuracy",err:"Error rate",fpr:"False positive rate",tpr:"True positive rate",fnr:"False negative rate",tnr:"True negative rate",ppv:"Positive predictive value",npv:"Negative predictive value",pcfall:"Prediction-conditioned fallout",pcmiss:"Prediction-conditioned miss",lift:"Lift value",rpp:"Rate of positive predictions",rnp:"Rate of negative predictions",threshold:"Threshold"},t.exports=i},function(t,e,r){var n=r(83);t.exports=function(t,e){return 1-n(t,e)}},function(t,e,r){"use strict";var n=r(15).array,i=r(81);t.exports=function(t,e){for(var r=n.mean(t),o=n.mean(e),s=new Array(t.length),a=new Array(e.length),u=0;u<s.length;u++)s[u]=t[u]-r,a[u]=e[u]-o;return i(s,a)}},function(t,e,r){var n=r(84);t.exports=function(t,e){return 1-n(t,e)}},function(t,e,r){var n=r(85);t.exports=function(t,e){return 1/n(t,e)}},function(t,e,r){var n=r(86);t.exports=function(t,e){return 1-n(t,e)}},function(t,e,r){var n=r(87);t.exports=function(t,e){return 1-n(t,e)}},function(t,e,r){var n=r(88);t.exports=function(t,e){return 1-n(t,e)}},function(t,e,r){"use strict";e.cosine=r(81),e.czekanowski=r(89),e.dice=r(181),e.intersection=r(180),e.jaccard=r(179),e.kulczynski=r(178),e.motyka=r(177),e.pearson=r(176),e.squaredChord=r(175),e.tanimoto=r(82)},function(t,e){t.exports=function(t,e){for(var r=t.length,n=0,i=0;i<r;i++)n+=1-Math.min(t[i],e[i])/Math.max(t[i],e[i]);return n}},function(t,e,r){"use strict";function n(t,e,r,i,o,s){if(o=o||.16,s=s||.01,!(i-r<o)){for(var a=0,u=0;t[u]<i;u++)t[u]>r&&(a+=e[u]);if(!(a<s)){for(var h=0,c=0;t[c]<i;c++)t[u]>r&&(h+=t[c]*e[c]);if(!((h/=a)-r<1e-5||i-h<1e-5))return h-r<o/4?n(t,e,h,i,o,s):i-h<o/4?n(t,e,r,h,o,s):{sum:a,center:h,left:n(t,e,r,h,o,s),right:n(t,e,h,i,o,s)}}}}var i={minWindow:.16,threshold:.01,alpha:.1,beta:.33,gamma:.001};t.exports={calc:function(t,e,r,o,s){for(var a in s=s||{},i)s.hasOwnProperty(a)||(s[a]=i[a]);return function t(e,r,n,i,o){return void 0===e||void 0===r?0:i*(n*Math.min(e.sum,r.sum)/Math.max(e.sum,r.sum)+(1-n)*Math.exp(-o*Math.abs(e.center-r.center)))+(1-i)*(t(e.left,r.left,n,i,o)+t(e.right,r.right,n,i,o))}(t.sum?t:n(t.x,t.y,r,o,s.minWindow,s.threshold),e.sum?e:n(e.x,e.y,r,o,s.minWindow,s.threshold),s.alpha,s.beta,s.gamma)},createTree:n}},function(t,e){t.exports=function(t,e){for(var r=t.length,n=0,i=0;i<r;i++)n+=t[i]*Math.log(2*t[i]/(t[i]+e[i]))+e[i]*Math.log(2*e[i]/(t[i]+e[i]));return n}},function(t,e,r){var n=r(82);t.exports=function(t,e,r){if(r)return 1-n(t,e,r);for(var i=t.length,o=0,s=0,a=0,u=0;u<i;u++)o+=t[u],s+=e[u],a+=Math.min(t[u],e[u]);return(o+s-2*a)/(o+s-a)}},function(t,e){t.exports=function(t,e){for(var r=t.length,n=0,i=0;i<r;i++)n+=(t[i]+e[i])/2*Math.log((t[i]+e[i])/(2*Math.sqrt(t[i]*e[i])));return n}},function(t,e){t.exports=function(t,e){for(var r=0,n=t.length,i=0;r<n;r++)i+=(t[r]-e[r])*(t[r]-e[r])/(t[r]+e[r]);return i}},function(t,e){t.exports=function(t,e){for(var r=t.length,n=0,i=0,o=0;o<r;o++)n+=Math.abs(t[o]-e[o]),i+=t[o]+e[o];return n/i}},function(t,e){t.exports=function(t,e){for(var r=t.length,n=0,i=0,o=0;o<r;o++)n+=Math.abs(t[o]-e[o]),i+=Math.max(t[o],e[o]);return n/i}},function(t,e){t.exports=function(t,e){for(var r=t.length,n=0,i=0,o=0;o<r;o++)n+=Math.min(t[o],e[o]),i+=Math.max(t[o],e[o]);return n/i}},function(t,e){t.exports=function(t,e){for(var r=0,n=t.length,i=0;r<n;r++)i+=(t[r]-e[r])*(t[r]-e[r])/(t[r]+e[r]);return 2*i}},function(t,e){t.exports=function(t,e){for(var r=0,n=t.length,i=0;r<n;r++)i+=(t[r]-e[r])*(t[r]-e[r])/e[r];return i}},function(t,e){t.exports=function(t,e){for(var r=0,n=t.length,i=0;r<n;r++)i+=(t[r]-e[r])*(t[r]-e[r])/t[r];return i}},function(t,e){t.exports=function(t,e,r){for(var n=0,i=t.length,o=0;n<i;n++)o+=Math.pow(Math.abs(t[n]-e[n]),r);return Math.pow(o,1/r)}},function(t,e){t.exports=function(t,e){for(var r=t.length,n=0,i=0;i<r;i++)n+=Math.sqrt(t[i]*e[i]);return Math.sqrt(2-2*n)}},function(t,e){t.exports=function(t,e){for(var r=0,n=t.length,i=0;r<n;r++)i+=Math.abs(t[r]-e[r]);return i}},function(t,e){t.exports=function(t,e){for(var r=t.length,n=0,i=0;i<r;i++)n+=Math.log(Math.abs(t[i]-e[i])+1);return n}},function(t,e){t.exports=function(t,e){for(var r=t.length,n=0,i=0;i<r;i++)n+=Math.pow(t[i]*t[i]-e[i]*e[i],2)/(2*Math.pow(t[i]*e[i],1.5));return n}},function(t,e){t.exports=function(t,e){for(var r=t.length,n=0,i=0,o=0,s=0;s<r;s++)n+=t[s]*e[s],i+=t[s]*t[s],o+=e[s]*e[s];return n/(i+o-n)}},function(t,e){t.exports=function(t,e){for(var r=t.length,n=0,i=0;i<r;i++)n+=t[i]*Math.log(t[i]/e[i]);return n}},function(t,e){t.exports=function(t,e){for(var r=t.length,n=0,i=0;i<r;i++)n+=t[i]*Math.log(2*t[i]/(t[i]+e[i]));return n}},function(t,e){t.exports=function(t,e){for(var r=t.length,n=0,i=0,o=0;o<r;o++)n+=t[o]*Math.log(2*t[o]/(t[o]+e[o])),i+=e[o]*Math.log(2*e[o]/(t[o]+e[o]));return(n+i)/2}},function(t,e){t.exports=function(t,e){for(var r=t.length,n=0,i=0;i<r;i++)n+=(t[i]*Math.log(t[i])+e[i]*Math.log(e[i]))/2-(t[i]+e[i])/2*Math.log((t[i]+e[i])/2);return n}},function(t,e){t.exports=function(t,e){for(var r=t.length,n=0,i=0;i<r;i++)n+=(t[i]-e[i])*Math.log(t[i]/e[i]);return n}},function(t,e){t.exports=function(t,e){for(var r=t.length,n=0,i=0;i<r;i++)n+=t[i]*e[i];return n}},function(t,e){t.exports=function(t,e){for(var r=t.length,n=0,i=0;i<r;i++)n+=Math.sqrt(t[i]*e[i]);return 2*Math.sqrt(1-n)}},function(t,e){t.exports=function(t,e){for(var r=t.length,n=0,i=0;i<r;i++)n+=t[i]*e[i]/(t[i]+e[i]);return 2*n}},function(t,e){t.exports=function(t,e){for(var r=t.length,n=0,i=0;i<r;i++)n+=Math.abs(t[i]-e[i]);return n/r}},function(t,e){t.exports=function(t,e){for(var r=t.length,n=0,i=0;i<r;i++)n+=Math.sqrt(t[i]*e[i]);return n}},function(t,e){t.exports=function(t,e){for(var r=0,n=t.length,i=0;r<n;r++)i+=(t[r]-e[r])*(t[r]-e[r])/((t[r]+e[r])*(t[r]+e[r]));return 2*i}},function(t,e,r){"use strict";const n=r(89);t.exports=function(t,e){return 1-n(t,e)}},function(t,e){t.exports=function(t,e){for(var r=0,n=t.length,i=0;r<n;r++)i+=Math.sqrt((t[r]-e[r])*(t[r]-e[r])/((t[r]+e[r])*(t[r]+e[r])));return 2*i}},function(t,e){t.exports=function(t,e){for(var r=t.length,n=0,i=0,o=0;o<r;o++)n<(i=Math.abs(t[o]-e[o]))&&(n=i);return n}},function(t,e){t.exports=function(t,e){for(var r=t.length,n=0,i=0;i<r;i++)n+=Math.abs(t[i]-e[i])/(t[i]+e[i]);return n}},function(t,e){t.exports=function(t,e){for(var r=t.length,n=0,i=0;i<r;i++)n+=Math.sqrt(t[i]*e[i]);return-Math.log(n)}},function(t,e){t.exports=function(t,e){for(var r=t.length,n=0,i=0,o=0,s=0;s<r;s++)i+=o=Math.abs(t[s]-e[s]),n<o&&(n=o);return(n+i)/2}},function(t,e){t.exports=function(t,e){for(var r=0,n=t.length,i=0;r<n;r++)i+=(t[r]-e[r])*(t[r]-e[r])*(t[r]+e[r])/(t[r]*e[r]);return 2*i}},function(t,e,r){"use strict";e.additiveSymmetric=r(218),e.avg=r(217),e.bhattacharyya=r(216),e.canberra=r(215),e.chebyshev=r(214),e.clark=r(213),e.czekanowski=r(212),e.dice=r(88),e.divergence=r(211),e.euclidean=r(7),e.fidelity=r(210),e.gower=r(209),e.harmonicMean=r(208),e.hellinger=r(207),e.innerProduct=r(206),e.intersection=r(87),e.jaccard=r(86),e.jeffreys=r(205),e.jensenDifference=r(204),e.jensenShannon=r(203),e.kdivergence=r(202),e.kulczynski=r(85),e.kullbackLeibler=r(201),e.kumarHassebrook=r(200),e.kumarJohnson=r(199),e.lorentzian=r(198),e.manhattan=r(197),e.matusita=r(196),e.minkowski=r(195),e.motyka=r(84),e.neyman=r(194),e.pearson=r(193),e.probabilisticSymmetric=r(192),e.ruzicka=r(191),e.soergel=r(190),e.sorensen=r(189),e.squared=r(188),e.squaredChord=r(83),e.squaredEuclidean=r(7).squared,e.taneja=r(187),e.tanimoto=r(186),e.topsoe=r(185),e.tree=r(184),e.waveHedges=r(183)},function(t,e,r){"use strict";t.exports=Number.isNaN||function(t){return t!=t}},function(t,e,r){const n=r(92),i=r(91).asc,o=[2147483647,5,11,23,47,97,197,397,797,1597,3203,6421,12853,25717,51437,102877,205759,411527,823117,1646237,3292489,6584983,13169977,26339969,52679969,105359939,210719881,421439783,842879579,1685759167,433,877,1759,3527,7057,14143,28289,56591,113189,226379,452759,905551,1811107,3622219,7244441,14488931,28977863,57955739,115911563,231823147,463646329,927292699,1854585413,953,1907,3821,7643,15287,30577,61169,122347,244703,489407,978821,1957651,3915341,7830701,15661423,31322867,62645741,125291483,250582987,501165979,1002331963,2004663929,1039,2081,4177,8363,16729,33461,66923,133853,267713,535481,1070981,2141977,4283963,8567929,17135863,34271747,68543509,137087021,274174111,548348231,1096696463,31,67,137,277,557,1117,2237,4481,8963,17929,35863,71741,143483,286973,573953,1147921,2295859,4591721,9183457,18366923,36733847,73467739,146935499,293871013,587742049,1175484103,599,1201,2411,4831,9677,19373,38747,77509,155027,310081,620171,1240361,2480729,4961459,9922933,19845871,39691759,79383533,158767069,317534141,635068283,1270136683,311,631,1277,2557,5119,10243,20507,41017,82037,164089,328213,656429,1312867,2625761,5251529,10503061,21006137,42012281,84024581,168049163,336098327,672196673,1344393353,3,7,17,37,79,163,331,673,1361,2729,5471,10949,21911,43853,87719,175447,350899,701819,1403641,2807303,5614657,11229331,22458671,44917381,89834777,179669557,359339171,718678369,1437356741,43,89,179,359,719,1439,2879,5779,11579,23159,46327,92657,185323,370661,741337,1482707,2965421,5930887,11861791,23723597,47447201,94894427,189788857,379577741,759155483,1518310967,379,761,1523,3049,6101,12203,24407,48817,97649,195311,390647,781301,1562611,3125257,6250537,12501169,25002389,50004791,100009607,200019221,400038451,800076929,1600153859,13,29,59,127,257,521,1049,2099,4201,8419,16843,33703,67409,134837,269683,539389,1078787,2157587,4315183,8630387,17260781,34521589,69043189,138086407,276172823,552345671,1104691373,19,41,83,167,337,677,1361,2729,5471,10949,21911,43853,87719,175447,350899,701819,1403641,2807303,5614657,11229331,22458671,44917381,89834777,179669557,359339171,718678369,1437356741,53,107,223,449,907,1823,3659,7321,14653,29311,58631,117269,234539,469099,938207,1876417,3752839,7505681,15011389,30022781,60045577,120091177,240182359,480364727,960729461,1921458943];o.sort(i),e.nextPrime=function(t){let e=n(o,t,i);return e<0&&(e=~e),o[e]},e.largestPrime=2147483647},function(t,e){t.exports=function(t,e){t=t||0;for(var r=new Array(t),n=0;n<t;n++)r[n]=e;return r}},function(module,__webpack_exports__,__webpack_require__){"use strict";__webpack_require__.r(__webpack_exports__),__webpack_require__.d(__webpack_exports__,"SparseMatrix",function(){return SparseMatrix});var ml_hash_table__WEBPACK_IMPORTED_MODULE_0__=__webpack_require__(60),ml_hash_table__WEBPACK_IMPORTED_MODULE_0___default=__webpack_require__.n(ml_hash_table__WEBPACK_IMPORTED_MODULE_0__);class SparseMatrix{constructor(t,e,r={}){if(t instanceof SparseMatrix){const e=t;this._init(e.rows,e.columns,e.elements.clone(),e.threshold)}else if(Array.isArray(t)){const s=t;t=s.length,r=e||{},e=s[0].length,this._init(t,e,new ml_hash_table__WEBPACK_IMPORTED_MODULE_0___default.a(r),r.threshold);for(var n=0;n<t;n++)for(var i=0;i<e;i++){var o=s[n][i];this.threshold&&Math.abs(o)<this.threshold&&(o=0),0!==o&&this.elements.set(n*e+i,s[n][i])}}else this._init(t,e,new ml_hash_table__WEBPACK_IMPORTED_MODULE_0___default.a(r),r.threshold)}_init(t,e,r,n){this.rows=t,this.columns=e,this.elements=r,this.threshold=n||0}static eye(t=1,e=t){const r=Math.min(t,e),n=new SparseMatrix(t,e,{initialCapacity:r});for(var i=0;i<r;i++)n.set(i,i,1);return n}clone(){return new SparseMatrix(this)}to2DArray(){const t=new Array(this.rows);for(var e=0;e<this.rows;e++){t[e]=new Array(this.columns);for(var r=0;r<this.columns;r++)t[e][r]=this.get(e,r)}return t}isSquare(){return this.rows===this.columns}isSymmetric(){if(!this.isSquare())return!1;var t=!0;return this.forEachNonZero((e,r,n)=>this.get(r,e)!==n?(t=!1,!1):n),t}bandWidth(){let t=this.columns,e=-1;return this.forEachNonZero((r,n,i)=>{let o=r-n;return t=Math.min(t,o),e=Math.max(e,o),i}),e-t}isBanded(t){return this.bandWidth()<=t}get cardinality(){return this.elements.size}get size(){return this.rows*this.columns}get(t,e){return this.elements.get(t*this.columns+e)}set(t,e,r){return this.threshold&&Math.abs(r)<this.threshold&&(r=0),0===r?this.elements.remove(t*this.columns+e):this.elements.set(t*this.columns+e,r),this}mmul(t){this.columns!==t.rows&&console.warn("Number of columns of left matrix are not equal to number of rows of right matrix.");const e=this.rows,r=t.columns,n=new SparseMatrix(e,r);return this.forEachNonZero((e,r,i)=>(t.forEachNonZero((t,o,s)=>(r===t&&n.set(e,o,n.get(e,o)+i*s),s)),i)),n}kroneckerProduct(t){const e=this.rows,r=this.columns,n=t.rows,i=t.columns,o=new SparseMatrix(e*n,r*i,{initialCapacity:this.cardinality*t.cardinality});return this.forEachNonZero((e,r,s)=>(t.forEachNonZero((t,a,u)=>(o.set(n*e+t,i*r+a,s*u),u)),s)),o}forEachNonZero(t){return this.elements.forEachPair((e,r)=>{const n=e/this.columns|0,i=e%this.columns;let o=t(n,i,r);return!1!==o&&(this.threshold&&Math.abs(o)<this.threshold&&(o=0),o!==r&&(0===o?this.elements.remove(e,!0):this.elements.set(e,o)),!0)}),this.elements.maybeShrinkCapacity(),this}getNonZeros(){const t=this.cardinality,e=new Array(t),r=new Array(t),n=new Array(t);var i=0;return this.forEachNonZero((t,o,s)=>(e[i]=t,r[i]=o,n[i]=s,i++,s)),{rows:e,columns:r,values:n}}setThreshold(t){return 0!==t&&t!==this.threshold&&(this.threshold=t,this.forEachNonZero((t,e,r)=>r)),this}transpose(){let t=new SparseMatrix(this.columns,this.rows,{initialCapacity:this.cardinality});return this.forEachNonZero((e,r,n)=>(t.set(r,e,n),n)),t}}SparseMatrix.prototype.klass="Matrix",SparseMatrix.identity=SparseMatrix.eye,SparseMatrix.prototype.tensorProduct=SparseMatrix.prototype.kroneckerProduct;var inplaceOperator="\n(function %name%(value) {\n    if (typeof value === 'number') return this.%name%S(value);\n    return this.%name%M(value);\n})\n",inplaceOperatorScalar="\n(function %name%S(value) {\n    this.forEachNonZero((i, j, v) => v %op% value);\n    return this;\n})\n",inplaceOperatorMatrix="\n(function %name%M(matrix) {\n    matrix.forEachNonZero((i, j, v) => {\n        this.set(i, j, this.get(i, j) %op% v);\n        return v;\n    });\n    return this;\n})\n",staticOperator="\n(function %name%(matrix, value) {\n    var newMatrix = new SparseMatrix(matrix);\n    return newMatrix.%name%(value);\n})\n",inplaceMethod="\n(function %name%() {\n    this.forEachNonZero((i, j, v) => %method%(v));\n    return this;\n})\n",staticMethod="\n(function %name%(matrix) {\n    var newMatrix = new SparseMatrix(matrix);\n    return newMatrix.%name%();\n})\n";const operators=[["+","add"],["-","sub","subtract"],["*","mul","multiply"],["/","div","divide"],["%","mod","modulus"],["&","and"],["|","or"],["^","xor"],["<<","leftShift"],[">>","signPropagatingRightShift"],[">>>","rightShift","zeroFillRightShift"]];for(const operator of operators)for(let i=1;i<operator.length;i++)SparseMatrix.prototype[operator[i]]=eval(fillTemplateFunction(inplaceOperator,{name:operator[i],op:operator[0]})),SparseMatrix.prototype[operator[i]+"S"]=eval(fillTemplateFunction(inplaceOperatorScalar,{name:operator[i]+"S",op:operator[0]})),SparseMatrix.prototype[operator[i]+"M"]=eval(fillTemplateFunction(inplaceOperatorMatrix,{name:operator[i]+"M",op:operator[0]})),SparseMatrix[operator[i]]=eval(fillTemplateFunction(staticOperator,{name:operator[i]}));var methods=[["~","not"]];["abs","acos","acosh","asin","asinh","atan","atanh","cbrt","ceil","clz32","cos","cosh","exp","expm1","floor","fround","log","log1p","log10","log2","round","sign","sin","sinh","sqrt","tan","tanh","trunc"].forEach(function(t){methods.push(["Math."+t,t])});for(const method of methods)for(let i=1;i<method.length;i++)SparseMatrix.prototype[method[i]]=eval(fillTemplateFunction(inplaceMethod,{name:method[i],method:method[0]})),SparseMatrix[method[i]]=eval(fillTemplateFunction(staticMethod,{name:method[i]}));function fillTemplateFunction(t,e){for(const r in e)t=t.replace(new RegExp("%"+r+"%","g"),e[r]);return t}},function(t,e,r){"use strict";var n=r(0);function i(t,e,r){var n=0;const i=r(e);for(var o=0;o<t.x.length;o++)n+=Math.abs(t.y[o]-i(t.x[o]));return n}function o(t,e,r,i,o){var s=n.Matrix.eye(e.length).mul(r*i*i),a=t.x.length,u=new Array(a);const h=o(e);for(var c=0;c<a;c++)u[c]=h(t.x[c]);var l=function(t,e,r,i,o){const s=r.length,a=t.x.length;for(var u=new Array(s),h=0;h<s;h++){u[h]=new Array(a);var c=r.concat();c[h]+=i;for(var l=o(c),f=0;f<a;f++)u[h][f]=e[f]-l(t.x[f])}return new n.Matrix(u)}(t,u,e,i,o),f=function(t,e){const r=t.x.length;for(var i=new Array(r),o=0;o<r;o++)i[o]=t.y[o]-e[o];return new n.Matrix([i])}(t,u).transposeView(),p=n.inverse(s.add(l.mmul(l.transposeView())));return(e=(e=new n.Matrix([e])).sub(p.mmul(l).mmul(f).mul(i).transposeView())).to1DArray()}t.exports=function(t,e,r={}){let{maxIterations:n=100,gradientDifference:s=.1,damping:a=0,errorTolerance:u=.01,initialValues:h}=r;if(a<=0)throw new Error("The damping option must be a positive number");if(!t.x||!t.y)throw new Error("The data parameter must have x and y elements");if(!Array.isArray(t.x)||t.x.length<2||!Array.isArray(t.y)||t.y.length<2)throw new Error("The data parameter elements must be an array with more than 2 points");if(t.x.length!==t.y.length)throw new Error("The data parameter elements must have the same size");var c=h||new Array(e.length).fill(1);if(!Array.isArray(c))throw new Error("initialValues must be an array");for(var l=i(t,c,e),f=l<=u,p=0;p<n&&!f;p++)f=(l=i(t,c=o(t,c,a,s,e),e))<=u;return{parameterValues:c,parameterError:l,iterations:p}}},function(t,e,r){var n=r(93);function i(t,e,r,i){n.call(this,t,e,r,i),this.hX=t-Math.floor(e/2),this.z=0-this.hX-e}i.prototype=new n,i.prototype.constructor=i,i.prototype.getDistance=function(t){return Math.max(Math.abs(this.hX-t.hX),Math.abs(this.y-t.y),Math.abs(this.z-t.z))},i.prototype.getDistanceTorus=function(t){var e=Math.abs(this.hX-t.hX),r=Math.abs(this.y-t.y),n=Math.abs(this.z-t.z);return Math.max(Math.min(e,this.som.gridDim.x-e),Math.min(r,this.som.gridDim.y-r),Math.min(n,this.som.gridDim.z-n))},i.prototype.getPosition=function(){throw new Error("Unimplemented : cannot get position of the points for hexagonal grid")},t.exports=i},function(module,exports,__webpack_require__){"use strict";var NodeSquare=__webpack_require__(93),NodeHexagonal=__webpack_require__(225),defaultOptions={fields:3,randomizer:Math.random,distance:squareEuclidean,iterations:10,learningRate:.1,gridType:"rect",torus:!0,method:"random"};function SOM(t,e,r,n){for(var i in this.x=t,this.y=e,r=r||{},this.options={},defaultOptions)r.hasOwnProperty(i)?this.options[i]=r[i]:this.options[i]=defaultOptions[i];if("number"==typeof this.options.fields)this.numWeights=this.options.fields;else{if(!Array.isArray(this.options.fields))throw new Error("Invalid fields definition");this.numWeights=this.options.fields.length;var o=getConverters(this.options.fields);this.extractor=o.extractor,this.creator=o.creator}if("rect"===this.options.gridType)this.nodeType=NodeSquare,this.gridDim={x:t,y:e};else{this.nodeType=NodeHexagonal;var s=this.x-Math.floor(this.y/2);this.gridDim={x:s,y:this.y,z:-(0-s-this.y)}}if(this.torus=this.options.torus,this.distanceMethod=this.torus?"getDistanceTorus":"getDistance",this.distance=this.options.distance,this.maxDistance=getMaxDistance(this.distance,this.numWeights),!0!==n){if(!(t>0&&e>0))throw new Error("x and y must be positive");this.times={findBMU:0,adjust:0},this.randomizer=this.options.randomizer,this.iterationCount=0,this.iterations=this.options.iterations,this.startLearningRate=this.learningRate=this.options.learningRate,this.mapRadius=Math.floor(Math.max(t,e)/2),this.algorithmMethod=this.options.method,this._initNodes(),this.done=!1}else this.done=!0}function getConverters(t){for(var e=t.length,r=new Array(e),n=new Array(e),i=0;i<e;i++)r[i]=getNormalizer(t[i].range),n[i]=getDenormalizer(t[i].range);return{extractor:function(n){for(var i=new Array(e),o=0;o<e;o++)i[o]=r[o](n[t[o].name]);return i},creator:function(r){for(var i={},o=0;o<e;o++)i[t[o].name]=n[o](r[o]);return i}}}function getNormalizer(t){return function(e){return(e-t[0])/(t[1]-t[0])}}function getDenormalizer(t){return function(e){return t[0]+e*(t[1]-t[0])}}function squareEuclidean(t,e){for(var r=0,n=0,i=t.length;n<i;n++)r+=(t[n]-e[n])*(t[n]-e[n]);return r}function getRandomValue(t,e){return t[Math.floor(e()*t.length)]}function getMaxDistance(t,e){for(var r=new Array(e),n=new Array(e),i=0;i<e;i++)r[i]=0,n[i]=1;return t(r,n)}SOM.load=function loadModel(model,distance){if("SOM"===model.name){var x=model.data.length,y=model.data[0].length;distance?model.options.distance=distance:model.options.distance&&(model.options.distance=eval("("+model.options.distance+")"));var som=new SOM(x,y,model.options,!0);som.nodes=new Array(x);for(var i=0;i<x;i++){som.nodes[i]=new Array(y);for(var j=0;j<y;j++)som.nodes[i][j]=new som.nodeType(i,j,model.data[i][j],som)}return som}throw new Error("expecting a SOM model")},SOM.prototype.export=function(t){if(!this.done)throw new Error("model is not ready yet");var e={name:"SOM"};e.options={fields:this.options.fields,gridType:this.options.gridType,torus:this.options.torus},e.data=new Array(this.x);for(var r=0;r<this.x;r++){e.data[r]=new Array(this.y);for(var n=0;n<this.y;n++)e.data[r][n]=this.nodes[r][n].weights}return t&&(e.options.distance=this.distance.toString()),e},SOM.prototype._initNodes=function(){var t,e,r,n=Date.now();for(this.nodes=new Array(this.x),t=0;t<this.x;t++)for(this.nodes[t]=new Array(this.y),e=0;e<this.y;e++){var i=new Array(this.numWeights);for(r=0;r<this.numWeights;r++)i[r]=this.randomizer();this.nodes[t][e]=new this.nodeType(t,e,i,this)}this.times.initNodes=Date.now()-n},SOM.prototype.setTraining=function(t){if(this.trainingSet)throw new Error("training set has already been set");var e,r=Date.now(),n=t,i=t.length;if(this.extractor)for(n=new Array(i),e=0;e<i;e++)n[e]=this.extractor(t[e]);this.numIterations=this.iterations*i,"random"===this.algorithmMethod?this.timeConstant=this.numIterations/Math.log(this.mapRadius):this.timeConstant=i/Math.log(this.mapRadius),this.trainingSet=n,this.times.setTraining=Date.now()-r},SOM.prototype.trainOne=function(){return!this.done&&(this.numIterations-- >0?("random"===this.algorithmMethod?(t=this.mapRadius*Math.exp(-this.iterationCount/this.timeConstant),e=getRandomValue(this.trainingSet,this.randomizer),this._adjust(e,t),this.learningRate=this.startLearningRate*Math.exp(-this.iterationCount/this.numIterations)):(r=-Math.floor(this.iterationCount/this.trainingSet.length),t=this.mapRadius*Math.exp(r/this.timeConstant),e=this.trainingSet[this.iterationCount%this.trainingSet.length],this._adjust(e,t),(this.iterationCount+1)%this.trainingSet.length==0&&(this.learningRate=this.startLearningRate*Math.exp(r/Math.floor(this.numIterations/this.trainingSet.length)))),this.iterationCount++,!0):(this.done=!0,!1));var t,e,r},SOM.prototype._adjust=function(t,e){var r,n,i,o,s=Date.now(),a=this._findBestMatchingUnit(t),u=Date.now();this.times.findBMU+=u-s;var h=Math.floor(e),c=a.x-h,l=a.x+h,f=a.y-h,p=a.y+h;for(r=c;r<=l;r++){var m=r;for(r<0?m+=this.x:r>=this.x&&(m-=this.x),n=f;n<=p;n++){var g=n;n<0?g+=this.y:n>=this.y&&(g-=this.y),(i=a[this.distanceMethod](this.nodes[m][g]))<e&&(o=Math.exp(-i/(2*e)),this.nodes[m][g].adjustWeights(t,this.learningRate,o))}}this.times.adjust+=Date.now()-u},SOM.prototype.train=function(t){if(!this.done)for(this.setTraining(t);this.trainOne(););},SOM.prototype.getConvertedNodes=function(){for(var t=new Array(this.x),e=0;e<this.x;e++){t[e]=new Array(this.y);for(var r=0;r<this.y;r++){var n=this.nodes[e][r];t[e][r]=this.creator?this.creator(n.weights):n.weights}}return t},SOM.prototype._findBestMatchingUnit=function(t){for(var e,r,n=1/0,i=0;i<this.x;i++)for(var o=0;o<this.y;o++)(r=this.distance(this.nodes[i][o].weights,t))<n&&(n=r,e=this.nodes[i][o]);return e},SOM.prototype.predict=function(t,e){if("boolean"==typeof t&&(e=t,t=null),t||(t=this.trainingSet),Array.isArray(t)&&(Array.isArray(t[0])||"object"==typeof t[0])){var r=this;return t.map(function(t){return r._predict(t,e)})}return this._predict(t,e)},SOM.prototype._predict=function(t,e){Array.isArray(t)||(t=this.extractor(t));var r=this._findBestMatchingUnit(t),n=[r.x,r.y];return e&&(n[2]=r.getPosition(t)),n},SOM.prototype.getQuantizationError=function(){for(var t=this.getFit(),e=t.length,r=0,n=0;n<e;n++)r+=t[n];return r/e},SOM.prototype.getFit=function(t){t||(t=this.trainingSet);for(var e,r=t.length,n=new Array(r),i=0;i<r;i++)e=this._findBestMatchingUnit(t[i]),n[i]=Math.sqrt(this.distance(t[i],e.weights));return n},module.exports=SOM},function(t,e,r){"use strict";var n=r(96);class i extends n{constructor(t){super(t),this.activationFunction=function(t,e){this[t][e]=Math.exp(this[t][e])}}static load(t){if("Layer"!==t.model)throw new RangeError("the current model is not a Layer model");return new i(t)}}t.exports=i},function(t,e,r){"use strict";const n=r(0).Matrix,i=r(96),o=r(227),s=r(95),a=r(94);class u{constructor(t){if((t=t||{}).model){this.hiddenLayers=t.hiddenLayers,this.iterations=t.iterations,this.learningRate=t.learningRate,this.regularization=t.regularization,this.dicts=t.dicts,this.activation=t.activation,this.activationParam=t.activationParam,this.model=new Array(t.layers.length);for(var e=0;e<this.model.length-1;++e)this.model[e]=i.load(t.layers[e]);this.model[this.model.length-1]=o.load(t.layers[this.model.length-1])}else this.hiddenLayers=t.hiddenLayers||[10],this.iterations=t.iterations||50,this.learningRate=t.learningRate||.01,this.regularization=t.regularization||.01,this.activation=t.activation||"tanh",this.activationParam=t.activationParam||1,this.activation in Object.keys(a)||(this.activation="tanh")}buildNetwork(t,e){var r=this.hiddenLayers.length-1+2;this.model=new Array(r),this.model[0]=new i({inputSize:t,outputSize:this.hiddenLayers[0],activation:this.activation,activationParam:this.activationParam,regularization:this.regularization,epsilon:this.learningRate});for(var n=1;n<this.hiddenLayers.length;++n)this.model[n]=new i({inputSize:this.hiddenLayers[n-1],outputSize:this.hiddenLayers[n],activation:this.activation,activationParam:this.activationParam,regularization:this.regularization,epsilon:this.learningRate});this.model[r-1]=new o({inputSize:this.hiddenLayers[this.hiddenLayers.length-1],outputSize:e,activation:this.activation,activationParam:this.activationParam,regularization:this.regularization,epsilon:this.learningRate})}train(t,e){t=n.checkMatrix(t),this.dicts=s.dictOutputs(e);var r=t.columns,i=Object.keys(this.dicts.inputs).length;this.buildNetwork(r,i);for(var o=0;o<this.iterations;++o){var a=this.propagate(t);this.backpropagation(t,e,a)}}propagate(t){for(var e=t,r=0;r<this.model.length;++r)e=this.model[r].forward(e);return e.divColumnVector(s.sumRow(e))}backpropagation(t,e,r){for(var n=0;n<r.length;++n)r[n][this.dicts.inputs[e[n]]]-=1;var i=r;for(n=this.model.length-1;n>=0;--n){var o=n>0?this.model[n-1].a:t;i=this.model[n].backpropagation(i,o)}for(n=0;n<this.model.length;++n)this.model[n].update()}predict(t){t=n.checkMatrix(t);for(var e=new Array(t.rows),r=this.propagate(t),i=0;i<t.rows;++i)e[i]=this.dicts.outputs[r.maxRowIndex(i)[1]];return e}toJSON(){for(var t={model:"FNN",hiddenLayers:this.hiddenLayers,iterations:this.iterations,learningRate:this.learningRate,regularization:this.regularization,activation:this.activation,activationParam:this.activationParam,dicts:this.dicts,layers:new Array(this.model.length)},e=0;e<this.model.length;++e)t.layers[e]=this.model[e].toJSON();return t}static load(t){if("FNN"!==t.model)throw new RangeError("the current model is not a feed forward network");return new u(t)}}t.exports=u},function(t,e,r){"use strict";const n={mode:"index"};t.exports=function*(t,e,r){r=Object.assign({},n,r);for(var i,o,s,a=new Array(e),u=new Array(t),h=new Array(e),c=new Array(e+2),l=0;l<e;l++)a[l]=l,h[l]=l<e-t?0:1;for(l=0;l<t;l++)u[l]=e-t+l;for(l=0;l<c.length;l++)c[l]=0===l?e+1:l<=e-t?0:l<=e?l-e+t:-2;function f(){var t,e,r;for(e=1;c[e]<=0;)e++;if(0===c[e-1]){for(t=e-1;1!==t;t--)c[t]=-1;c[e]=0,i=s=0,c[1]=1,o=e-1}else{e>1&&(c[e-1]=0);do{e++}while(c[e]>0);for(r=e-1,t=e;0===c[t];)c[t++]=-1;if(-1===c[t])c[t]=c[r],s=c[r]-1,i=t-1,o=r-1,c[r]=-1;else{if(t===c[0])return 0;c[e]=c[t],s=c[t]-1,c[t]=0,i=e-1,o=t-1}}return 1}if("index"===r.mode)for(yield u.slice();f();)u[s]=a[i],yield u.slice();else{if("mask"!==r.mode)throw new Error("Invalid mode");for(yield h.slice();f();)h[i]=1,h[o]=0,yield h.slice()}}},function(t,e,r){"use strict";const n=r(97),i={},o=r(229);function s(t,e){if(t.length!==e.length)throw new Error("features and labels should have the same length")}function a(t,e){return new Array(t).fill(0).map(()=>new Array(e).fill(0))}function u(t){var e=new Set;for(let r=0;r<t.length;r++)e.add(t[r]);return Array.from(e)}function h(t,e,r,n,i,o,s,a){const{testFeatures:u,trainFeatures:h,testLabels:c,trainLabels:p}=f(e,r,i,o);var m;t.prototype.train?(m=new t(n)).train(h,p):m=new t(h,p,n),l(s,c,m.predict(u),a)}function c(t,e,r,n,i,o,s){const{testFeatures:a,trainFeatures:u,testLabels:h,trainLabels:c}=f(t,e,r,n);l(i,h,s(u,c,a),o)}function l(t,e,r,n){for(var i=0;i<r.length;i++){const o=n.indexOf(e[i]),s=n.indexOf(r[i]);(o<0||s<0)&&console.warn(`ignore unknown predicted label ${r[i]}`),t[o][s]++}}function f(t,e,r,n){return{testFeatures:r.map(function(e){return t[e]}),trainFeatures:n.map(function(e){return t[e]}),testLabels:r.map(function(t){return e[t]}),trainLabels:n.map(function(t){return e[t]})}}i.leaveOneOut=function(t,e,r,n){if("function"==typeof r){var o=r;return r=e,e=t,i.leavePOut(e,r,1,o)}return i.leavePOut(t,e,r,n,1)},i.leavePOut=function(t,e,r,i,l){if("function"==typeof i){var f=i;l=r,r=e,e=t}s(e,r);const p=u(r),m=a(p.length,p.length);var g=e.length,d=o(l,g),v=new Array(g);for(let t=0;t<g;t++)v[t]=t;for(const n of d){var y=v.slice();for(let t=n.length-1;t>=0;t--)y.splice(n[t],1);f?c(e,r,n,y,m,p,f):h(t,e,r,i,n,y,m,p)}return new n(m,p)},i.kFold=function(t,e,r,i,o){if("function"==typeof i){var l=i;o=r,r=e,e=t}s(e,r);const f=u(r),p=a(f.length,f.length);for(var m=e.length,g=new Array(m),d=0;d<m;d++)g[d]=d;for(var v=Math.floor(m/o),y=[],w=[];g.length;){var b=Math.floor(Math.random()*g.length);y.push(g[b]),g.splice(b,1),y.length===v&&(w.push(y),y=[])}for(y.length&&w.push(y),w=w.slice(0,o),d=0;d<w.length;d++){for(var x=w[d],M=[],S=0;S<w.length;S++)S!==d&&(M=M.concat(w[S]));l?c(e,r,x,M,p,f,l):h(t,e,r,i,x,M,p,f)}return new n(p,f)},t.exports=i},function(t,e,r){"use strict";const n={alpha:.01,constant:-Math.E};t.exports=class{constructor(t){t=Object.assign({},n,t),this.alpha=t.alpha,this.constant=t.constant}compute(t,e){for(var r=0,n=0;n<t.length;n++)r+=t[n]*e[n];return Math.tanh(this.alpha*r+this.constant)}}},function(t,e,r){"use strict";const n=r(7).squared,i={constant:1};t.exports=class{constructor(t){t=Object.assign({},i,t),this.constant=t.constant}compute(t,e){const r=n(t,e);return 1-r/(r+this.constant)}}},function(t,e,r){"use strict";const n=r(7).squared,i={constant:1};t.exports=class{constructor(t){t=Object.assign({},i,t),this.constant=t.constant}compute(t,e){return Math.sqrt(n(t,e)+this.constant*this.constant)}}},function(t,e,r){"use strict";const n=r(7),i={sigma:1};t.exports=class{constructor(t){t=Object.assign({},i,t),this.sigma=t.sigma}compute(t,e){const r=n(t,e);return Math.exp(-r/this.sigma)}}},function(t,e,r){"use strict";t.exports=class{compute(t,e){for(var r=Math.min(t.length,e.length),n=0,i=0;i<r;++i)n+=Math.min(t[i],e[i]);return n}}},function(t,e,r){"use strict";const n=r(7),i={sigma:1};t.exports=class{constructor(t){t=Object.assign({},i,t),this.sigma=t.sigma,this.divisor=2*t.sigma*t.sigma}compute(t,e){const r=n(t,e);return Math.exp(-r/this.divisor)}}},function(t,e,r){"use strict";const n=r(7).squared,i={sigma:1};t.exports=class{constructor(t){t=Object.assign({},i,t),this.sigma=t.sigma}compute(t,e){return 1/(1+n(t,e)/(this.sigma*this.sigma))}}},function(t,e,r){"use strict";const n={sigma:1,degree:1};t.exports=class{constructor(t){t=Object.assign({},n,t),this.sigma=t.sigma,this.degree=t.degree}compute(t,e){for(var r=0,n=Math.min(t.length,e.length),i=1;i<=n;++i)r+=Math.pow(Math.exp(-this.sigma*Math.pow(Math.pow(t[i-1],i)-Math.pow(e[i-1],i),2)),this.degree);return r}}},function(t,e,r){"use strict";const n={degree:1,constant:1,scale:1};t.exports=class{constructor(t){t=Object.assign({},n,t),this.degree=t.degree,this.constant=t.constant,this.scale=t.scale}compute(t,e){for(var r=0,n=0;n<t.length;n++)r+=t[n]*e[n];return Math.pow(this.scale*r+this.constant,this.degree)}}},function(t,e,r){"use strict";const n=r(7).squared,i={sigma:1};t.exports=class{constructor(t){t=Object.assign({},i,t),this.sigma=t.sigma,this.divisor=2*t.sigma*t.sigma}compute(t,e){const r=n(t,e);return Math.exp(-r/this.divisor)}}},function(t,e,r){"use strict";const n=r(40),i=r(15).array;var o={C:1,tol:1e-4,maxPasses:10,maxIterations:1e4,kernel:"linear",alphaTol:1e-6,random:Math.random,whitening:!0};function s(t){this.options=Object.assign({},o,t),this.kernel=new n(this.options.kernel,this.options.kernelOptions),this.b=0}s.prototype.train=function(t,e){if(t.length!==e.length)throw new Error("Features and labels should have the same length");if(t.length<2)throw new Error("Cannot train with less than 2 observations");if(this._trained=!1,this._loaded=!1,this.N=e.length,this.D=t[0].length,this.options.whitening){this.X=new Array(this.N);for(var r=0;r<this.N;r++)this.X[r]=new Array(this.D);this.minMax=new Array(this.D);for(var n=0;n<this.D;n++){var o=new Array(this.N);for(r=0;r<this.N;r++)o[r]=t[r][n];for(this.minMax[n]=i.minMax(o),r=0;r<this.N;r++)this.X[r][n]=(t[r][n]-this.minMax[n].min)/(this.minMax[n].max-this.minMax[n].min)}}else this.X=t;this.Y=e,this.b=0,this.W=void 0;var s=this.kernel.compute(this.X),a=e.length,u=new Array(a).fill(0);this.alphas=u;for(var h=0;h<a;h++)u[h]=0;for(var c=0,l=0,f=0,p=0,m=0,g=0,d=0,v=0,y=0,w=0,b=0;p<this.options.maxPasses&&f<this.options.maxIterations;){var x=0;for(r=0;r<a;r++)if(m=this._marginOnePrecomputed(r,s)-e[r],e[r]*m<-this.options.tol&&u[r]<this.options.C||e[r]*m>this.options.tol&&u[r]>0){for(n=r;n===r;)n=Math.floor(this.options.random()*a);if(g=this._marginOnePrecomputed(n,s)-e[n],d=u[r],v=u[n],e[r]===e[n]?(y=Math.max(0,d+v-this.options.C),w=Math.min(this.options.C,d+v)):(y=Math.max(0,v-d),w=Math.min(this.options.C,this.options.C+v+d)),Math.abs(y-w)<1e-4)continue;if((b=2*s[r][n]-s[r][r]-s[n][n])>=0)continue;var M=u[n]-e[n]*(m-g)/b;if(M>w?M=w:M<y&&(M=y),Math.abs(v-M)<.001)continue;u[n]=M,u[r]=u[r]+e[r]*e[n]*(v-M),c=this.b-m-e[r]*(u[r]-d)*s[r][r]-e[n]*(u[n]-v)*s[r][n],l=this.b-g-e[r]*(u[r]-d)*s[r][n]-e[n]*(u[n]-v)*s[n][n],this.b=(c+l)/2,u[r]<this.options.C&&u[r]>0&&(this.b=c),u[n]<this.options.C&&u[n]>0&&(this.b=l),x+=1}f++,0===x?p+=1:p=0}if(f===this.options.maxIterations)throw new Error("max iterations reached");if(this.iterations=f,"linear"===this.options.kernel){this.W=new Array(this.D);for(var S=0;S<this.D;S++){this.W[S]=0;for(var A=0;A<a;A++)this.W[S]+=e[A]*u[A]*this.X[A][S]}}var E=[],_=[],k=[];for(this._supportVectorIdx=[],r=0;r<this.N;r++)this.alphas[r]>this.options.alphaTol&&(E.push(this.X[r]),_.push(e[r]),k.push(this.alphas[r]),this._supportVectorIdx.push(r));this.X=E,this.Y=_,this.N=E.length,this.alphas=k,this._trained=!0},s.prototype.predictOne=function(t){return this.marginOne(t)>0?1:-1},s.prototype.predict=function(t){if(!this._trained&&!this._loaded)throw new Error("Cannot predict, you need to train the SVM first");return Array.isArray(t)&&Array.isArray(t[0])?t.map(this.predictOne.bind(this)):this.predictOne(t)},s.prototype.marginOne=function(t,e){this.options.whitening&&!e&&(t=this._applyWhitening(t));var r,n=this.b;if("linear"===this.options.kernel&&this.W)for(r=0;r<this.W.length;r++)n+=this.W[r]*t[r];else for(r=0;r<this.N;r++)n+=this.alphas[r]*this.Y[r]*this.kernel.compute([t],[this.X[r]])[0][0];return n},s.prototype._marginOnePrecomputed=function(t,e){var r,n=this.b;for(r=0;r<this.N;r++)n+=this.alphas[r]*this.Y[r]*e[t][r];return n},s.prototype.margin=function(t){return Array.isArray(t)?t.map(this.marginOne.bind(this)):this.marginOne(t)},s.prototype.supportVectors=function(){if(!this._trained&&!this._loaded)throw new Error("Cannot get support vectors, you need to train the SVM first");if(this._loaded&&"linear"===this.options.kernel)throw new Error("Cannot get support vectors from saved linear model, you need to train the SVM to have them");return this._supportVectorIdx},s.load=function(t){this._loaded=!0,this._trained=!1;var e=new s(t.options);return"linear"===t.options.kernel?(e.W=t.W.slice(),e.D=e.W.length):(e.X=t.X.slice(),e.Y=t.Y.slice(),e.alphas=t.alphas.slice(),e.N=e.X.length,e.D=e.X[0].length),e.minMax=t.minMax,e.b=t.b,e._loaded=!0,e._trained=!1,e},s.prototype.toJSON=function(){if(!this._trained&&!this._loaded)throw new Error("Cannot export, you need to train the SVM first");var t={};return t.options=Object.assign({},this.options),t.b=this.b,t.minMax=this.minMax,"linear"===t.options.kernel?t.W=this.W.slice():(t.X=this.X.slice(),t.Y=this.Y.slice(),t.alphas=this.alphas.slice()),t},s.prototype._applyWhitening=function(t){if(!this.minMax)throw new Error("Could not apply whitening");for(var e=new Array(t.length),r=0;r<t.length;r++)e[r]=(t[r]-this.minMax[r].min)/(this.minMax[r].max-this.minMax[r].min);return e},t.exports=s},function(t,e,r){"use strict";const n=r(7),i=r(100),o=r(62);function s(t,e,r){for(var n=1e101,i=0;i<t.length;i++)for(var o=i;o<e.length;o++){var s=r(t[i],e[o]);n=Math.min(s,n)}return n}function a(t,e,r){for(var n=-1,i=0;i<t.length;i++)for(var o=i;o<e.length;o++){var s=r(t[i],e[o]);n=Math.max(s,n)}return n}function u(t,e,r){for(var n=0,i=0;i<t.length;i++)for(var o=0;o<e.length;o++)n+=r(t[i],e[o]);return n/(t.length*e.length)}function h(t,e,r){for(var n=0,i=0,o=0,s=0,a=0;a<t.length;a++)n+=t[a][0],i+=t[a][1];for(var u=0;u<e.length;u++)o+=e[u][0],s+=e[u][1];return r([n/=t.length,i/=t.length],[o/=e.length,s/=e.length])}function c(t,e,r){for(var n=0,i=0,o=0,s=0,a=0;a<t.length;a++)n+=t[a][0],i+=t[a][1];for(var u=0;u<e.length;u++)o+=e[u][0],s+=e[u][1];return r([n/=t.length,i/=t.length],[o/=e.length,s/=e.length])*t.length*e.length/(t.length+e.length)}function l(t,e,r){for(var n={d:0,p:0},i=new Array(t[0].length),o=0;o<t[0].length;o++)i[o]=e[t[0][o]];for(var s,a,u=new Array(t[1].length),h=0;h<t[1].length;h++)u[h]=e[t[1][h]];for(var c=0;c<i.length;c++){s=0;for(var l=0;l<i.length;l++)c!==l&&(s+=r(i[c],i[l]));s/=i.length-1,a=0;for(var f=0;f<u.length;f++)a+=r(i[c],u[f]);s-(a/=u.length)>n.d&&(n.d=s-a,n.p=c)}return n}var f={dist:n,kind:"single"};function p(t,e,r){for(var n=0,i=0,o=0;o<t.length;o++)for(var s=o;s<t.length;s++)n+=r(e[t[o].index],e[t[s].index]),i++;return n/i}t.exports=function(t,e){if("string"==typeof(e=Object.assign({},f,e)).kind)switch(e.kind){case"single":e.kind=s;break;case"complete":e.kind=a;break;case"average":e.kind=u;break;case"centroid":e.kind=h;break;case"ward":e.kind=c;break;default:throw new RangeError("Unknown kind of similarity")}else if("function"!=typeof e.kind)throw new TypeError("Undefined kind of similarity");var r,n,m,g,d,v=new o;v.children=new Array(t.length),v.index=new Array(t.length);for(var y=0;y<t.length;y++)v.children[y]=new i(y),v.index[y]=new i(y);v.distance=p(v.index,t,e.dist);for(var w=[v];w.length>0;){n=0,m=0;for(var b=0;b<w.length;b++){r=0;for(var x=0;x<w[b].length;x++)for(var M=x+1;M<w[b].length;M++)r=Math.max(e.dist(t[w[b].index[x].index],t[w[b].index[M].index]),r);r>n&&(n=r,m=b)}if(n=0,2===w[m].index.length)w[m].children=[w[m].index[0],w[m].index[1]],w[m].distance=e.dist(t[w[m].index[0].index],t[w[m].index[1].index]);else if(3===w[m].index.length){w[m].children=[w[m].index[0],w[m].index[1],w[m].index[2]];var S=[e.dist(t[w[m].index[0].index],t[w[m].index[1].index]),e.dist(t[w[m].index[1].index],t[w[m].index[2].index])];w[m].distance=(S[0]+S[1])/2}else{for(var A=new o,E=new o,_=[new Array(w[m].index.length),[]],k=0;k<_[0].length;k++)_[0][k]=k;for(var R=0;R<_[0].length;R++){g=0;for(var O=0;O<_[0].length;O++)R!==O&&(g+=e.dist(t[w[m].index[_[0][O]].index],t[w[m].index[_[0][R]].index]));(g/=_[0].length-1)>n&&(n=g,d=R)}for(_[1]=[d],_[0].splice(d,1),g=l(_,t,e.dist);g.d>0;)_[1].push(_[0][g.p]),_[0].splice(g.p,1),g=l(_,t,e.dist);var C=new Array(_[0].length);A.index=new Array(_[0].length);for(var F=0;F<C.length;F++)C[F]=t[w[m].index[_[0][F]].index],A.index[F]=w[m].index[_[0][F]],A.children[F]=w[m].index[_[0][F]];var T=new Array(_[1].length);E.index=new Array(_[1].length);for(var D=0;D<T.length;D++)T[D]=t[w[m].index[_[1][D]].index],E.index[D]=w[m].index[_[1][D]],E.children[D]=w[m].index[_[1][D]];A.distance=p(A.index,t,e.dist),E.distance=p(E.index,t,e.dist),w.push(A),w.push(E),w[m].children=[A,E]}w.splice(m,1)}return v}},function(t,e){"function"==typeof Object.create?t.exports=function(t,e){t.super_=e,t.prototype=Object.create(e.prototype,{constructor:{value:t,enumerable:!1,writable:!0,configurable:!0}})}:t.exports=function(t,e){t.super_=e;var r=function(){};r.prototype=e.prototype,t.prototype=new r,t.prototype.constructor=t}},function(t,e){t.exports=function(t){return t&&"object"==typeof t&&"function"==typeof t.copy&&"function"==typeof t.fill&&"function"==typeof t.readUInt8}},function(t,e,r){(function(t,n){var i=/%[sdj%]/g;e.format=function(t){if(!v(t)){for(var e=[],r=0;r<arguments.length;r++)e.push(a(arguments[r]));return e.join(" ")}r=1;for(var n=arguments,o=n.length,s=String(t).replace(i,function(t){if("%%"===t)return"%";if(r>=o)return t;switch(t){case"%s":return String(n[r++]);case"%d":return Number(n[r++]);case"%j":try{return JSON.stringify(n[r++])}catch(t){return"[Circular]"}default:return t}}),u=n[r];r<o;u=n[++r])g(u)||!b(u)?s+=" "+u:s+=" "+a(u);return s},e.deprecate=function(r,i){if(y(t.process))return function(){return e.deprecate(r,i).apply(this,arguments)};if(!0===n.noDeprecation)return r;var o=!1;return function(){if(!o){if(n.throwDeprecation)throw new Error(i);n.traceDeprecation?console.trace(i):console.error(i),o=!0}return r.apply(this,arguments)}};var o,s={};function a(t,r){var n={seen:[],stylize:h};return arguments.length>=3&&(n.depth=arguments[2]),arguments.length>=4&&(n.colors=arguments[3]),m(r)?n.showHidden=r:r&&e._extend(n,r),y(n.showHidden)&&(n.showHidden=!1),y(n.depth)&&(n.depth=2),y(n.colors)&&(n.colors=!1),y(n.customInspect)&&(n.customInspect=!0),n.colors&&(n.stylize=u),c(n,t,n.depth)}function u(t,e){var r=a.styles[e];return r?"["+a.colors[r][0]+"m"+t+"["+a.colors[r][1]+"m":t}function h(t,e){return t}function c(t,r,n){if(t.customInspect&&r&&S(r.inspect)&&r.inspect!==e.inspect&&(!r.constructor||r.constructor.prototype!==r)){var i=r.inspect(n,t);return v(i)||(i=c(t,i,n)),i}var o=function(t,e){if(y(e))return t.stylize("undefined","undefined");if(v(e)){var r="'"+JSON.stringify(e).replace(/^"|"$/g,"").replace(/'/g,"\\'").replace(/\\"/g,'"')+"'";return t.stylize(r,"string")}if(d(e))return t.stylize(""+e,"number");if(m(e))return t.stylize(""+e,"boolean");if(g(e))return t.stylize("null","null")}(t,r);if(o)return o;var s=Object.keys(r),a=function(t){var e={};return t.forEach(function(t,r){e[t]=!0}),e}(s);if(t.showHidden&&(s=Object.getOwnPropertyNames(r)),M(r)&&(s.indexOf("message")>=0||s.indexOf("description")>=0))return l(r);if(0===s.length){if(S(r)){var u=r.name?": "+r.name:"";return t.stylize("[Function"+u+"]","special")}if(w(r))return t.stylize(RegExp.prototype.toString.call(r),"regexp");if(x(r))return t.stylize(Date.prototype.toString.call(r),"date");if(M(r))return l(r)}var h,b="",A=!1,E=["{","}"];(p(r)&&(A=!0,E=["[","]"]),S(r))&&(b=" [Function"+(r.name?": "+r.name:"")+"]");return w(r)&&(b=" "+RegExp.prototype.toString.call(r)),x(r)&&(b=" "+Date.prototype.toUTCString.call(r)),M(r)&&(b=" "+l(r)),0!==s.length||A&&0!=r.length?n<0?w(r)?t.stylize(RegExp.prototype.toString.call(r),"regexp"):t.stylize("[Object]","special"):(t.seen.push(r),h=A?function(t,e,r,n,i){for(var o=[],s=0,a=e.length;s<a;++s)k(e,String(s))?o.push(f(t,e,r,n,String(s),!0)):o.push("");return i.forEach(function(i){i.match(/^\d+$/)||o.push(f(t,e,r,n,i,!0))}),o}(t,r,n,a,s):s.map(function(e){return f(t,r,n,a,e,A)}),t.seen.pop(),function(t,e,r){if(t.reduce(function(t,e){return 0,e.indexOf("\n")>=0&&0,t+e.replace(/\u001b\[\d\d?m/g,"").length+1},0)>60)return r[0]+(""===e?"":e+"\n ")+" "+t.join(",\n  ")+" "+r[1];return r[0]+e+" "+t.join(", ")+" "+r[1]}(h,b,E)):E[0]+b+E[1]}function l(t){return"["+Error.prototype.toString.call(t)+"]"}function f(t,e,r,n,i,o){var s,a,u;if((u=Object.getOwnPropertyDescriptor(e,i)||{value:e[i]}).get?a=u.set?t.stylize("[Getter/Setter]","special"):t.stylize("[Getter]","special"):u.set&&(a=t.stylize("[Setter]","special")),k(n,i)||(s="["+i+"]"),a||(t.seen.indexOf(u.value)<0?(a=g(r)?c(t,u.value,null):c(t,u.value,r-1)).indexOf("\n")>-1&&(a=o?a.split("\n").map(function(t){return"  "+t}).join("\n").substr(2):"\n"+a.split("\n").map(function(t){return"   "+t}).join("\n")):a=t.stylize("[Circular]","special")),y(s)){if(o&&i.match(/^\d+$/))return a;(s=JSON.stringify(""+i)).match(/^"([a-zA-Z_][a-zA-Z_0-9]*)"$/)?(s=s.substr(1,s.length-2),s=t.stylize(s,"name")):(s=s.replace(/'/g,"\\'").replace(/\\"/g,'"').replace(/(^"|"$)/g,"'"),s=t.stylize(s,"string"))}return s+": "+a}function p(t){return Array.isArray(t)}function m(t){return"boolean"==typeof t}function g(t){return null===t}function d(t){return"number"==typeof t}function v(t){return"string"==typeof t}function y(t){return void 0===t}function w(t){return b(t)&&"[object RegExp]"===A(t)}function b(t){return"object"==typeof t&&null!==t}function x(t){return b(t)&&"[object Date]"===A(t)}function M(t){return b(t)&&("[object Error]"===A(t)||t instanceof Error)}function S(t){return"function"==typeof t}function A(t){return Object.prototype.toString.call(t)}function E(t){return t<10?"0"+t.toString(10):t.toString(10)}e.debuglog=function(t){if(y(o)&&(o=n.env.NODE_DEBUG||""),t=t.toUpperCase(),!s[t])if(new RegExp("\\b"+t+"\\b","i").test(o)){var r=n.pid;s[t]=function(){var n=e.format.apply(e,arguments);console.error("%s %d: %s",t,r,n)}}else s[t]=function(){};return s[t]},e.inspect=a,a.colors={bold:[1,22],italic:[3,23],underline:[4,24],inverse:[7,27],white:[37,39],grey:[90,39],black:[30,39],blue:[34,39],cyan:[36,39],green:[32,39],magenta:[35,39],red:[31,39],yellow:[33,39]},a.styles={special:"cyan",number:"yellow",boolean:"yellow",undefined:"grey",null:"bold",string:"green",date:"magenta",regexp:"red"},e.isArray=p,e.isBoolean=m,e.isNull=g,e.isNullOrUndefined=function(t){return null==t},e.isNumber=d,e.isString=v,e.isSymbol=function(t){return"symbol"==typeof t},e.isUndefined=y,e.isRegExp=w,e.isObject=b,e.isDate=x,e.isError=M,e.isFunction=S,e.isPrimitive=function(t){return null===t||"boolean"==typeof t||"number"==typeof t||"string"==typeof t||"symbol"==typeof t||void 0===t},e.isBuffer=r(244);var _=["Jan","Feb","Mar","Apr","May","Jun","Jul","Aug","Sep","Oct","Nov","Dec"];function k(t,e){return Object.prototype.hasOwnProperty.call(t,e)}e.log=function(){var t,r;console.log("%s - %s",(t=new Date,r=[E(t.getHours()),E(t.getMinutes()),E(t.getSeconds())].join(":"),[t.getDate(),_[t.getMonth()],r].join(" ")),e.format.apply(e,arguments))},e.inherits=r(243),e._extend=function(t,e){if(!e||!b(e))return t;for(var r=Object.keys(e),n=r.length;n--;)t[r[n]]=e[r[n]];return t}}).call(this,r(37),r(53))},function(t,e,r){var n,i,o;(function(){var r,s,a,u,h,c,l,f,p,m,g,d,v,y,w;a=Math.floor,m=Math.min,s=function(t,e){return t<e?-1:t>e?1:0},p=function(t,e,r,n,i){var o;if(null==r&&(r=0),null==i&&(i=s),r<0)throw new Error("lo must be non-negative");for(null==n&&(n=t.length);r<n;)i(e,t[o=a((r+n)/2)])<0?n=o:r=o+1;return[].splice.apply(t,[r,r-r].concat(e)),e},c=function(t,e,r){return null==r&&(r=s),t.push(e),y(t,0,t.length-1,r)},h=function(t,e){var r,n;return null==e&&(e=s),r=t.pop(),t.length?(n=t[0],t[0]=r,w(t,0,e)):n=r,n},f=function(t,e,r){var n;return null==r&&(r=s),n=t[0],t[0]=e,w(t,0,r),n},l=function(t,e,r){var n;return null==r&&(r=s),t.length&&r(t[0],e)<0&&(e=(n=[t[0],e])[0],t[0]=n[1],w(t,0,r)),e},u=function(t,e){var r,n,i,o,u,h;for(null==e&&(e=s),u=[],n=0,i=(o=function(){h=[];for(var e=0,r=a(t.length/2);0<=r?e<r:e>r;0<=r?e++:e--)h.push(e);return h}.apply(this).reverse()).length;n<i;n++)r=o[n],u.push(w(t,r,e));return u},v=function(t,e,r){var n;if(null==r&&(r=s),-1!==(n=t.indexOf(e)))return y(t,0,n,r),w(t,n,r)},g=function(t,e,r){var n,i,o,a,h;if(null==r&&(r=s),!(i=t.slice(0,e)).length)return i;for(u(i,r),o=0,a=(h=t.slice(e)).length;o<a;o++)n=h[o],l(i,n,r);return i.sort(r).reverse()},d=function(t,e,r){var n,i,o,a,c,l,f,g,d;if(null==r&&(r=s),10*e<=t.length){if(!(o=t.slice(0,e).sort(r)).length)return o;for(i=o[o.length-1],a=0,l=(f=t.slice(e)).length;a<l;a++)r(n=f[a],i)<0&&(p(o,n,0,null,r),o.pop(),i=o[o.length-1]);return o}for(u(t,r),d=[],c=0,g=m(e,t.length);0<=g?c<g:c>g;0<=g?++c:--c)d.push(h(t,r));return d},y=function(t,e,r,n){var i,o,a;for(null==n&&(n=s),i=t[r];r>e&&n(i,o=t[a=r-1>>1])<0;)t[r]=o,r=a;return t[r]=i},w=function(t,e,r){var n,i,o,a,u;for(null==r&&(r=s),i=t.length,u=e,o=t[e],n=2*e+1;n<i;)(a=n+1)<i&&!(r(t[n],t[a])<0)&&(n=a),t[e]=t[n],n=2*(e=n)+1;return t[e]=o,y(t,u,e,r)},r=function(){function t(t){this.cmp=null!=t?t:s,this.nodes=[]}return t.push=c,t.pop=h,t.replace=f,t.pushpop=l,t.heapify=u,t.updateItem=v,t.nlargest=g,t.nsmallest=d,t.prototype.push=function(t){return c(this.nodes,t,this.cmp)},t.prototype.pop=function(){return h(this.nodes,this.cmp)},t.prototype.peek=function(){return this.nodes[0]},t.prototype.contains=function(t){return-1!==this.nodes.indexOf(t)},t.prototype.replace=function(t){return f(this.nodes,t,this.cmp)},t.prototype.pushpop=function(t){return l(this.nodes,t,this.cmp)},t.prototype.heapify=function(){return u(this.nodes,this.cmp)},t.prototype.updateItem=function(t){return v(this.nodes,t,this.cmp)},t.prototype.clear=function(){return this.nodes=[]},t.prototype.empty=function(){return 0===this.nodes.length},t.prototype.size=function(){return this.nodes.length},t.prototype.clone=function(){var e;return(e=new t).nodes=this.nodes.slice(0),e},t.prototype.toArray=function(){return this.nodes.slice(0)},t.prototype.insert=t.prototype.push,t.prototype.top=t.prototype.peek,t.prototype.front=t.prototype.peek,t.prototype.has=t.prototype.contains,t.prototype.copy=t.prototype.clone,t}(),i=[],void 0===(o="function"==typeof(n=function(){return r})?n.apply(e,i):n)||(t.exports=o)}).call(this)},function(t,e,r){t.exports=r(246)},function(t,e,r){"use strict";const n=r(7),i=r(100),o=r(62),s=r(99);function a(t,e,r){for(var n=1e101,i=0;i<t.length;i++)for(var o=0;o<e.length;o++){var s=r[t[i]][e[o]];n=Math.min(s,n)}return n}function u(t,e,r){for(var n=-1,i=0;i<t.length;i++)for(var o=0;o<e.length;o++){var s=r[t[i]][e[o]];n=Math.max(s,n)}return n}function h(t,e,r){for(var n=0,i=0;i<t.length;i++)for(var o=0;o<e.length;o++)n+=r[t[i]][e[o]];return n/(t.length*e.length)}function c(t,e,r){for(var n=new Array(t.length*e.length),i=0;i<t.length;i++)for(var o=0;o<e.length;o++)n[i*e.length+o]=r[t[i]][e[o]];return function(t,e){void 0===e&&(e=!1);e||(t=[].concat(t).sort(f));var r=t.length,n=Math.floor(r/2);return r%2==0?.5*(t[n-1]+t[n]):t[n]}(n)}function l(t,e,r){return c(t,e,r)*t.length*e.length/(t.length+e.length)}function f(t,e){return t-e}var p={disFunc:n,kind:"single",isDistanceMatrix:!1};t.exports=function(t,e){e=Object.assign({},p,e);var r=t.length,n=t;if(e.isDistanceMatrix||(n=s(t,e.disFunc)),"string"==typeof e.kind)switch(e.kind){case"single":e.kind=a;break;case"complete":e.kind=u;break;case"average":e.kind=h;break;case"centroid":e.kind=c;break;case"ward":e.kind=l;break;default:throw new RangeError("Unknown kind of similarity")}else if("function"!=typeof e.kind)throw new TypeError("Undefined kind of similarity");for(var f=new Array(r),m=0;m<n.length;m++)f[m]=new i(m);for(var g=1e6,d={},v=0;f.length>1;){d={},g=1e6;for(var y=0;y<f.length;y++)for(var w=y+1;w<f.length;w++){var b,x;if(f[y]instanceof i)b=[f[y].index];else{b=new Array(f[y].index.length);for(var M=0;M<b.length;M++)b[M]=f[y].index[M].index}if(f[w]instanceof i)x=[f[w].index];else{x=new Array(f[w].index.length);for(var S=0;S<x.length;S++)x[S]=f[w].index[S].index}(v=e.kind(b,x,n).toFixed(4))in d?d[v].push([f[y],f[w]]):d[v]=[[f[y],f[w]]],g=Math.min(v,g)}for(var A,E=d[g.toFixed(4)],_=new Array(E.length),k=0;E.length>0;){A=E.shift();for(var R=0;R<E.length;R++)if(E[R].filter(function(t){return-1!==A.indexOf(t)}).length>0){var O=E[R].filter(function(t){return-1===A.indexOf(t)});A=A.concat(O),E.splice(R--,1)}_[k++]=A}_.length=k;for(var C=0;C<_.length;C++){var F=new o;F.children=_[C].concat(),F.distance=g,F.index=new Array(r);for(var T=0,D=0;D<_[C].length;D++)_[C][D]instanceof i?F.index[T++]=_[C][D]:(T+=_[C][D].index.length,F.index=_[C][D].index.concat(F.index)),f.splice(f.indexOf(_[C][D]),1);F.index.length=T,f.push(F)}}return f[0]}},function(t,e,r){"use strict";e.agnes=r(248),e.diana=r(242)},function(t,e,r){"use strict";const n=r(0),i=n.Matrix,o=n.EVD,s=n.SVD,a=r(20),u=a.mean,h=a.standardDeviation,c={isCovarianceMatrix:!1,center:!0,scale:!1};class l{constructor(t,e){if(!0===t){const t=e;return this.center=t.center,this.scale=t.scale,this.means=t.means,this.stdevs=t.stdevs,this.U=i.checkMatrix(t.U),void(this.S=t.S)}if(e=Object.assign({},c,e),this.center=!1,this.scale=!1,this.means=null,this.stdevs=null,e.isCovarianceMatrix)this._computeFromCovarianceMatrix(t);else if("boolean"==typeof e.useCovarianceMatrix?e.useCovarianceMatrix:t.length>t[0].length){const r=(t=this._adjust(t,e)).transposeView().mmul(t).div(t.rows-1);this._computeFromCovarianceMatrix(r)}else{t=this._adjust(t,e);var r=new s(t,{computeLeftSingularVectors:!1,computeRightSingularVectors:!0,autoTranspose:!0});this.U=r.rightSingularVectors;const i=r.diagonal,o=new Array(i.length);for(var n=0;n<i.length;n++)o[n]=i[n]*i[n]/(t.length-1);this.S=o}}static load(t){if("PCA"!==t.name)throw new RangeError("Invalid model: "+t.name);return new l(!0,t)}predict(t,e={}){const{nComponents:r=this.U.columns}=e;t=new i(t),this.center&&(t.subRowVector(this.means),this.scale&&t.divRowVector(this.stdevs));var n=t.mmul(this.U);return n.subMatrix(0,n.rows-1,0,r-1)}getExplainedVariance(){for(var t=0,e=0;e<this.S.length;e++)t+=this.S[e];return this.S.map(e=>e/t)}getCumulativeVariance(){for(var t=this.getExplainedVariance(),e=1;e<t.length;e++)t[e]+=t[e-1];return t}getEigenvectors(){return this.U}getEigenvalues(){return this.S}getStandardDeviations(){return this.S.map(t=>Math.sqrt(t))}getLoadings(){return this.U.transpose()}toJSON(){return{name:"PCA",center:this.center,scale:this.scale,means:this.means,stdevs:this.stdevs,U:this.U,S:this.S}}_adjust(t,e){if(this.center=!!e.center,this.scale=!!e.scale,t=new i(t),this.center){const e=u(t),n=this.scale?h(t,e,!0):null;if(this.means=e,t.subRowVector(e),this.scale){for(var r=0;r<n.length;r++)if(0===n[r])throw new RangeError("Cannot scale the dataset (standard deviation is zero at index "+r);this.stdevs=n,t.divRowVector(n)}}return t}_computeFromCovarianceMatrix(t){const e=new o(t,{assumeSymmetric:!0});this.U=e.eigenvectorMatrix;for(var r=0;r<this.U.length;r++)this.U[r].reverse();this.S=e.realEigenvalues.reverse()}}t.exports=l},function(t,e,r){"use strict";Object.defineProperty(e,"__esModule",{value:!0});var n=r(21),i=r(102),o=function(){function t(){this.qualityMetric=new s}return t.prototype.computeDistances=function(t,e){var r=[];e=e||0;for(var i=0;i<t.length;i++){for(var o=t[i].getFeatureVector(),s=[],a=0;a<t.length;a++){var u=0;if(a!=i){var h=t[a].getFeatureVector();u=1-n.Utils.cosineSimilarity(o,h)}s.push(u)}r.push(s)}return r},t.prototype.buildClusters=function(t,e,r){for(var i=[],o=r[e],s=o.slice();s.length>0;){var a=[],u=n.Utils.rangeOf(s).min,h=o.indexOf(u);a.push(h),h=s.indexOf(u),s.splice(h,1);for(var c=s.length-1;c>=0;c--)s[c]-u<t&&(h=o.indexOf(s[c]),a.push(h),s.splice(c,1));i.push(a)}return i},t.prototype.buildClustersClassic=function(t,e){t<1&&(t=1-t/.25,t=.25*(1-(t=Math.cbrt(t))));for(var r=[],i=e[0],o=i.slice();o.length>0;){var s=[],a=n.Utils.rangeOf(o).min,u=i.indexOf(a);s.push(u),u=o.indexOf(a),o.splice(u,1);for(var h=o.length-1;h>=0;h--)o[h]-a<t&&(u=i.indexOf(o[h]),s.push(u),o.splice(h,1));r.push(s)}return r},t.prototype.optimalClustering=function(t,e){for(var r=.03,n=t.length,i=[],o=[];r>=.001;){for(var s=0;s<n;s++){var a=this.buildClusters(r,s,e),u=this.qualityMetric.score(t,a,e,"median");i.push(a),o.push(u)}r-=.001}var h=0,c=0,l=i.length;for(s=0;s<l;s++)o[s]>h&&(h=o[s],c=s);return i[c]},t.prototype.optimalKMeans=function(t,e,r,n){for(var i=[],o=[],s=0,a=0,u=5,h=t.length,c=r&&r<=h?r:Math.min(h,n);u>0;){for(var l=r||1;l<=c;l++){var f=this.kMeans(l,t),p=this.qualityMetric.score(t,f.clusters,e,"mean");i.push(f),o.push(p)}u--}for(var m=i.length,g=0;g<m;g++)o[g]>s&&(s=o[g],a=g);return i[a]},t.prototype.kMeans=function(t,e){var r=[],n=[],o=[];//!?
e.forEach(function(t){o.push(t.getFeatureVector())});for(var s,a=o.slice(),u=[],h=0;h<t;h++){var c=Math.floor(Math.random()*a.length),l=a.slice(c,c+1)[0];u.push(l),r.push([])}try{s=i.KMeans.default(o,t,{initialization:u})}catch(r){console.log(t,e,r)}for(var f=0;f<s.clusters.length;f++){r[p=s.clusters[f]].push(f)}for(var p=0;p<s.centroids.length;p++)n.push(s.centroids[p].centroid);return{clusters:r,centroids:n}},t}();e.Clusterizer=o;var s=function(){function t(){}return t.prototype.score=function(t,e,r,i){for(var o=t.length,s=[],a=0;a<o;a++)s.push(0);for(var u=e.length,h=0;h<u;h++){var c=e[h],l=c.length;for(a=0;a<l;a++){for(var f=c[a],p=0,m=0;m<l;m++)a!=m&&(p+=r[f][c[m]]);p/=l;var g=[],d=Number.MAX_VALUE;for(m=0;m<u;m++)if(m!=h){for(var v=e[m],y=v.length,w=0,b=0;b<y;b++)w+=r[f][v[b]];var x=w/=y;x<d&&(d=x),g.push(x)}d==Number.MAX_VALUE&&(d=0),s[f]=(d-p)/Math.max(p,d)}}var M=0;return"mean"==i?M=n.Utils.mean(s):"median"==i&&(M=n.Utils.median(s)),M},t}()},function(t,e,r){"use strict";Object.defineProperty(e,"__esModule",{value:!0});var n=r(21),i=r(103),o=function(){function t(t,e,r){this.SR=t,this.fex=e,this.config=r}return t.prototype.slice=function(t,e,r){var o;if(r=r||this.config.sliceMinLevelCoarse,t.candidates)o=t.candidates;else{var s=this.fex.extract("mfcc",t,this.config.sliceWinLengthCoarse),a=n.Utils.standardize(n.Utils.column(s,e));(o=this.fex.extract("thresholdCrossings",a,0,0)).N=s.N;for(var u=0;u<o.length;u++)o[u]*=s.N;if(0!=(1&o.length))(t.length-o[o.length-1])/this.SR>=this.config.sliceMinDuration?o.push(t.length-1):o.splice(-1);t.candidates=o}var h=t.noiseFloor;if(t.slice)t=t.slice();else{var c=new ArrayBuffer(t.byteLength),l=new Float32Array(c);l.set(t),t=l}var f=[],p=this.config.sliceMinDuration*this.SR;for(u=0;u<o.length;u+=2){var m=o[u],g=o[u+1];if(!(g-m<p)){var d=t.subarray(m,g);if(!(this.fex.extract("rms",d)<r)){var v=f.length;if(v>0){var y=f[v-1];if(m-y.n2<p){y.n2=g,y.signal=t.subarray(y.n1,g);continue}}f.push({n1:m,n2:g,signal:d})}}}var w=[];for(u=0;u<f.length;u++){var b=f[u],x=n.Utils.mean(b.signal);n.Utils.offset(b.signal,-x);var M=new i.Slice(b.n1,b.n2,this.fex);M.trim(b.signal,h),w.push(M)}return w},t}();e.AudioSlicer=o},function(t,e,r){"use strict";Object.defineProperty(e,"__esModule",{value:!0});var n=r(21),i=function(){function t(t){this.settings={filterSize:220,filterGain:3,sampleOffset:220,windowSize:2048,hopSize:512,tolerance:.15,minFreq:40,maxFreq:1200,sampleRate:NaN,unvoicedConfidence:.75,voicedConfidence:.95,primaryMedianFilterWidth:3,secondaryMedianFilterWidth:7,maxMergeThresholdCents:250,outlierStdDeviations:2.5},this.yindata=[],this.useConfidence=!1,this.noteStrings=["C","C#","D","D#","E","F","F#","G","G#","A","A#","B"],this.primaryMedianFilterData=[],this.secondaryMedianFilterData=[],this.pitchConfidence=[],this.pitchSmoothed=[],this.pitchFinal=[],this.envelope=[],this.velocity=0,this.notes=[],this.mergedNotes=[],this.silenceThreshold=0,this.settings.sampleRate=t}return t.prototype.createNoteEvent=function(t,e){var r=this.settings.hopSize;t<0&&(t=0);var i=t*r,s=e*r,a=n.Utils.medianOf(n.Utils.nonZerosOf(this.pitchFinal.slice(t,e)),!1),u=o(a);return{startFrame:t,endFrame:e,startSample:i,endSample:s,durationSamples:s-i,frequency:a,velocity:this.velocity,confidence:n.Utils.medianOf(this.pitchConfidence.slice(t,e),!1),noteNumber:u,noteName:this.noteStrings[u%12]}},t.prototype.init=function(t,e){if(this.yindata=new Array(t/2),this.yindata.fill)this.yindata=this.yindata.fill(1);else for(var r=0;r<this.yindata.length;r++)this.yindata[r]=1;if(this.primaryMedianFilterData=new Array(this.settings.primaryMedianFilterWidth),this.primaryMedianFilterData.fill)this.primaryMedianFilterData=this.primaryMedianFilterData.fill(0);else for(r=0;r<this.primaryMedianFilterData.length;r++)this.primaryMedianFilterData[r]=0;if(this.secondaryMedianFilterData=new Array(this.settings.secondaryMedianFilterWidth),this.secondaryMedianFilterData.fill)this.secondaryMedianFilterData=this.secondaryMedianFilterData.fill(0);else for(r=0;r<this.secondaryMedianFilterData.length;r++)this.secondaryMedianFilterData[r]=0;this.pitchConfidence=[],this.pitchSmoothed=[],this.pitchFinal=[],this.envelope=[],this.notes=[],this.tol=e},t.prototype.pitchyin=function(t){var e,r,i=0,o=0,s=0;for(this.yindata[0]=1,i=1;i<this.yindata.length;i++){for(this.yindata[i]=0,e=0;e<this.yindata.length;e++)o=t[e]-t[e+i],this.yindata[i]+=o*o;if(0!==(s+=this.yindata[i])?this.yindata[i]*=i/s:this.yindata[i]=1,r=i-3,i>4&&this.yindata[r]<this.tol&&this.yindata[r]<this.yindata[r+1])return n.Utils.quadraticPeakPos(this.yindata,r)}return n.Utils.quadraticPeakPos(this.yindata,n.Utils.minIdxOf(this.yindata))},t.prototype.postProcess=function(){var t=0,e=0,r=0,i=0,o=n.Utils.nonZerosOf(this.pitchSmoothed),s=o.length;s>0&&(t=n.Utils.meanOf(o));for(var a=0;a<s;a++){var u=o[a]-t;e+=u*u}s>0&&(e/=s,e=Math.sqrt(e),r=this.settings.outlierStdDeviations*e),s=this.pitchSmoothed.length;for(a=0;a<s;a++){var h=this.pitchSmoothed[a];if(h>0&&Math.abs(h-t)>r?h=i:i=h,h>0)this.pitchFinal.push(n.Utils.medianFilter(h,this.secondaryMedianFilterData));else{if(this.secondaryMedianFilterData.fill)this.secondaryMedianFilterData=this.secondaryMedianFilterData.fill(0);else for(var c=0;c<this.secondaryMedianFilterData.length;c++)this.secondaryMedianFilterData[c]=0;this.pitchFinal.push(0)}}},t.prototype.getPitchTrack=function(t){var e=this.settings.windowSize,r=0,i=this.settings.hopSize;this.init(e,this.settings.tolerance);for(var o,s=t.length/i|0,a=0,u=Number.MAX_VALUE,h=0;h<s;h++){var c=h*i,l=n.sliceFloat32Array(t,c,c+e),f=n.Utils.levelLinOf(l);this.envelope.push(n.Utils.linToDb(f)),f>a&&(a=f),f<u&&(u=f)}this.silenceThreshold=n.Utils.linToDb(.01*(a-u));for(h=0;h<s;h++){c=h*i,l=n.sliceFloat32Array(t,c,c+e);var p=this.pitchyin(l),m=(o=this.yindata,1-n.Utils.minOf(o));isNaN(p)&&(p=0),isNaN(m)&&(m=0),(this.envelope[h]<this.silenceThreshold||m<this.settings.unvoicedConfidence)&&(p=0),p>0&&(p=p<this.settings.minFreq||p>this.settings.maxFreq||m<this.settings.voicedConfidence?r:this.settings.sampleRate/(p+0)),this.pitchSmoothed.push(n.Utils.medianFilter(p,this.primaryMedianFilterData)),this.pitchConfidence.push(m),r=p}this.postProcess(),this.pitchSmoothed=[]},t.prototype.getNoteEvents=function(t,e){this.velocity=e,this.getPitchTrack(t);for(var r=-1,i=0,s=-1,a=(this.settings.hopSize,this.pitchFinal.length),u=0;u<a;u++){var h=this.pitchFinal[u];if(i=h>0?o(n.Utils.roundOff(h)):0,r>-1&&(s!=i||u==a-1)){var c=0;this.notes.length>0&&(c=this.notes[this.notes.length-1].endFrame);for(var l=r;l>c&&this.envelope[l]>this.silenceThreshold&&this.pitchConfidence[l]>this.settings.unvoicedConfidence&&this.pitchConfidence[l]<this.settings.voicedConfidence;)l--;l<r&&(r=l),this.notes.push(this.createNoteEvent(r,u)),r=-1}i>0&&s!=i&&-1==r&&(r=u),s=i}for(u=0;u<this.notes.length;u++){var f=this.notes[u],p=l=f.endFrame,m=a;if(u+1<this.notes.length){var g=this.notes[u+1];if(!(g.startFrame>f.endFrame))continue;m=g.startFrame}for(;l<m&&this.envelope[l]>this.silenceThreshold&&this.pitchConfidence[l]<this.settings.unvoicedConfidence;)l++;l>p&&(this.notes[u]=this.createNoteEvent(f.startFrame,l))}return this.notes},t.prototype.mergeNotes=function(t,e){this.mergedNotes=[];for(var r,n,i=t*this.settings.maxMergeThresholdCents,o=e*this.settings.sampleRate,s=o/2,a=0;a<this.notes.length;){for(var u=this.notes[a],h=u.frequency,c=[],l=1;a+l<this.notes.length;l++){var f=this.notes[a+l-1],p=this.notes[a+l];if(!(p.startSample-f.endSample<s)||!(Math.abs((r=h,n=p.frequency,1200*Math.log2(r/n)))<i||p.durationSamples<o||1==l&&u.durationSamples<o))break;c.push(p)}var m=this.settings.primaryMedianFilterWidth;c.length>0?this.mergedNotes.push(this.createNoteEvent(u.startFrame-m,c[c.length-1].endFrame-m)):u.durationSamples>=o&&this.mergedNotes.push(this.createNoteEvent(u.startFrame-m,u.endFrame-m)),a+=l}return this.mergedNotes},t}();function o(t){var e=Math.log(t/440)/Math.log(2)*12;return e=Math.round(e)+69}e.PitchAnalyzer=i},function(t,e,r){"use strict";Object.defineProperty(e,"__esModule",{value:!0});var n=r(21),i=function(){function t(t){this.featureExtractor=t}return t.prototype.process=function(t){var e=n.Utils.normalize(t);return e.noiseFloor=this.estimateNoiseFloor(e),e},t.prototype.estimateNoiseFloor=function(t){for(var e=this.featureExtractor.extract("rms",t,4096),r=0;r<e.length;r++)e[r]=n.Utils.linToDb(e[r]);return e.splice(-1),n.Utils.rangeOf(e).min},t}();e.Preprocessor=i},function(t,e,r){"use strict";Object.defineProperty(e,"__esModule",{value:!0});var n=r(104),i=r(254),o=r(253),s=r(252),a=r(251),u=r(164),h=r(21),c=r(103),l=r(102),f=function(){function t(t){this.config={sliceMinLevelCoarse:-52,sliceMinLevelTrim:-48,sliceMinDuration:.005,sliceWinLengthCoarse:1024,sliceWinLengthFine:16,sliceDuplicate:1,maxClusters:12,maxPredetects:12},this.maxClusters=4,this.fex=new n.FeatureExtractor,this.preprocessor=new i.Preprocessor(this.fex),this.clusterizer=new a.Clusterizer,this.predetectsToGo=0,this.predetects=new Array(this.config.maxClusters),this.storage=new u.FeatureStorage(this.config),this.IS_IOS=/iphone|ipad/i.test(navigator.userAgent),this.sampleRate=t,this.pitchTracker=new o.PitchAnalyzer(t),this.audioSlicer=new s.AudioSlicer(t,this.fex,this.config),this.storage.load().then(this.load.bind(this))}return t.prototype.preprocess=function(t){return this.preprocessor.process(t)},t.prototype.extractSlices=function(t,e,r){return r=r||1024,this.config.sliceWinLengthCoarse=r,this.audioSlicer.slice(t,0,e)},t.prototype.extractFeatures=function(t){return t.extractFeatures()},t.prototype.buildClusters=function(t,e){if(e&&(e.predetects=this.predetects),t.length){if(t.length<2)return[[0]];var r=this.clusterizer.computeDistances(t,0);if("custom"==e.alg)return this.clusterizer.optimalClustering(t,r);if("kmeans"==e.alg){var n=[],i=[],o=void 0,s={},a=e.k||0,u=this.maxClusters,h=void 0,c=this.predetects.some(function(t){return Array.isArray(t)&&t.length>0});if(c){for(var f=0,p=1;p<this.predetects.length;p++)if(void 0!=this.predetects[p]){for(var m=this.predetects[p],g=0;g<m.length;g++)n.push(m[g].getFeatureVector()),i.push(f);s[f++]=p-1}h=new l.SL.KNN.default(n,i,{k:Math.min(7,i.length)})}var d=this.clusterizer.optimalKMeans(t,r,a,u);if(!d)return!1;var v=d.clusters,y=d.centroids;if(c){var w=h.predict(y);o=[];for(p=0;p<w.length;p++)o.push(s[w[p]])}return{clusters:v,labels:o}}return"classic"==e.alg?this.clusterizer.buildClustersClassic(e.v,r):(console.log("invalid buildClusters args"),!1)}return!1},t.prototype.extractNotes=function(t,e){return this.pitchTracker.getNoteEvents(t,e)},t.prototype.adjustNotes=function(t,e){return this.pitchTracker.mergeNotes(t,e)},t.prototype.load=function(t){var e=this;this.predetects=new Array(this.config.maxClusters),Promise.all(t.map(function(t){return new Promise(function(r){if(e.IS_IOS){var n=t.signal,i=new c.Slice(0,n.length-1,e.fex);i.cluster=t.cluster,i.pos=0,i.signal=n,i.extractFeatures(),e.predetects[t.cluster]||(e.predetects[t.cluster]=[]),e.predetects[t.cluster].push(i),r()}else{var o=new FileReader;o.onload=function(){var n=new Float32Array(o.result),i=new c.Slice(0,n.length-1,e.fex);i.cluster=t.cluster,i.pos=0,i.signal=n,i.extractFeatures(),e.predetects[t.cluster]||(e.predetects[t.cluster]=[]),e.predetects[t.cluster].push(i),r()},o.readAsArrayBuffer(t.signal)}})})).then(function(){h.EventHub.teachDataUpdated.dispatch(e.predetects)})},t.prototype.train=function(t){var e=this;t.length>0&&this.storage.save(t).then(function(){console.log("trained"),e.storage.load().then(function(t){return e.load(t)})}).catch(function(){return console.log("training failed")})},t.prototype.untrain=function(t){var e=this;"all"===t?(this.storage.clear(),this.predetects=[],h.EventHub.teachDataUpdated.dispatch(this.predetects)):this.storage.remove(t).then(function(){console.log("untrained"),e.storage.load().then(function(t){return e.load(t)})})},t}();e.AudioAnalyzer=f},function(t,e,r){"use strict";Object.defineProperty(e,"__esModule",{value:!0});var n=function(){function t(t,e){for(var r=0;r<e.length;r++){var n=e[r];n.enumerable=n.enumerable||!1,n.configurable=!0,"value"in n&&(n.writable=!0),Object.defineProperty(t,n.key,n)}}return function(e,r,n){return r&&t(e.prototype,r),n&&t(e,n),e}}();var i=function(){function t(e){var r=arguments.length>1&&void 0!==arguments[1]?arguments[1]:Float32Array;!function(t,e){if(!(t instanceof e))throw new TypeError("Cannot call a class as a function")}(this,t),e instanceof t?(this.ArrayType=e.ArrayType,this.real=new this.ArrayType(e.real),this.imag=new this.ArrayType(e.imag)):(this.ArrayType=r,this.real=new this.ArrayType(e),this.imag=new this.ArrayType(this.real.length)),this.length=this.real.length}return n(t,[{key:"toString",value:function(){var t=[];return this.forEach(function(e,r){t.push("("+e.real.toFixed(2)+", "+e.imag.toFixed(2)+")")}),"["+t.join(", ")+"]"}},{key:"forEach",value:function(t){for(var e=this.length,r=Object.seal(Object.defineProperties({},{real:{writable:!0},imag:{writable:!0}})),n=0;n<e;n++)r.real=this.real[n],r.imag=this.imag[n],t(r,n,e)}},{key:"map",value:function(t){var e=this;return this.forEach(function(r,n,i){t(r,n,i),e.real[n]=r.real,e.imag[n]=r.imag}),this}},{key:"conjugate",value:function(){return new t(this).map(function(t){t.imag*=-1})}},{key:"magnitude",value:function(){var t=new this.ArrayType(this.length);return this.forEach(function(e,r){t[r]=Math.sqrt(e.real*e.real+e.imag*e.imag)}),t}}]),t}();e.default=i},function(t,e,r){"use strict";Object.defineProperty(e,"__esModule",{value:!0}),e.ComplexArray=void 0;var n=function(){function t(t,e){for(var r=0;r<e.length;r++){var n=e[r];n.enumerable=n.enumerable||!1,n.configurable=!0,"value"in n&&(n.writable=!0),Object.defineProperty(t,n.key,n)}}return function(e,r,n){return r&&t(e.prototype,r),n&&t(e,n),e}}();e.FFT=function(t){return c(t).FFT()},e.InvFFT=function(t){return c(t).InvFFT()},e.frequencyMap=function(t,e){return c(t).frequencyMap(e)};var i,o=r(256),s=(i=o)&&i.__esModule?i:{default:i};var a=Math.PI,u=Math.SQRT1_2;var h=e.ComplexArray=function(t){function e(){return function(t,e){if(!(t instanceof e))throw new TypeError("Cannot call a class as a function")}(this,e),function(t,e){if(!t)throw new ReferenceError("this hasn't been initialised - super() hasn't been called");return!e||"object"!=typeof e&&"function"!=typeof e?t:e}(this,(e.__proto__||Object.getPrototypeOf(e)).apply(this,arguments))}return function(t,e){if("function"!=typeof e&&null!==e)throw new TypeError("Super expression must either be null or a function, not "+typeof e);t.prototype=Object.create(e&&e.prototype,{constructor:{value:t,enumerable:!1,writable:!0,configurable:!0}}),e&&(Object.setPrototypeOf?Object.setPrototypeOf(t,e):t.__proto__=e)}(e,s.default),n(e,[{key:"FFT",value:function(){return l(this,!1)}},{key:"InvFFT",value:function(){return l(this,!0)}},{key:"frequencyMap",value:function(t){return this.FFT().map(t).InvFFT()}}]),e}();function c(t){return t instanceof h&&t||new h(t)}function l(t,e){var r=t.length;return r&r-1?function(t,e){var r=t.length;if(1===r)return t;for(var n=new h(r,t.ArrayType),i=function(t){var e=Math.sqrt(t),r=3;for(;r<=e;){if(t%r==0)return r;r+=2}return t}(r),o=r/i,s=1/Math.sqrt(i),u=new h(o,t.ArrayType),c=0;c<i;c++){for(var f=0;f<o;f++)u.real[f]=t.real[f*i+c],u.imag[f]=t.imag[f*i+c];o>1&&(u=l(u,e));for(var p=Math.cos(2*a*c/r),m=(e?-1:1)*Math.sin(2*a*c/r),g=1,d=0,v=0;v<r;v++){var y=u.real[v%o],w=u.imag[v%o];n.real[v]+=g*y-d*w,n.imag[v]+=g*w+d*y;var b=[g*p-d*m,d=g*m+d*p];g=b[0],d=b[1]}}for(var x=0;x<r;x++)t.real[x]=s*n.real[x],t.imag[x]=s*n.imag[x];return t}(t,e):function(t,e){var r=t.length,n=function(t){for(var e=t.length,r=new Set,n=0;n<e;n++){var i=f(n,e);if(!r.has(n)){var o=[t.real[i],t.real[n]];t.real[n]=o[0],t.real[i]=o[1];var s=[t.imag[i],t.imag[n]];t.imag[n]=s[0],t.imag[i]=s[1],r.add(i)}}return t}(t),i=n.real,o=n.imag,s=1;for(;s<r;){for(var h=Math.cos(a/s),c=(e?-1:1)*Math.sin(a/s),l=0;l<r/(2*s);l++)for(var p=1,m=0,g=0;g<s;g++){var d=2*l*s+g,v=d+s,y=i[d],w=o[d],b=p*i[v]-m*o[v],x=m*i[v]+p*o[v];i[d]=u*(y+b),o[d]=u*(w+x),i[v]=u*(y-b),o[v]=u*(w-x);var M=[p*h-m*c,p*c+m*h];p=M[0],m=M[1]}s<<=1}return n}(t,e)}function f(t,e){for(var r=0;e>1;)r<<=1,r+=1&t,t>>=1,e>>=1;return r}},function(t,e,r){t.exports=function(t){function e(n){if(r[n])return r[n].exports;var i=r[n]={i:n,l:!1,exports:{}};return t[n].call(i.exports,i,i.exports,e),i.l=!0,i.exports}var r={};return e.m=t,e.c=r,e.i=function(t){return t},e.d=function(t,r,n){e.o(t,r)||Object.defineProperty(t,r,{configurable:!1,enumerable:!0,get:n})},e.n=function(t){var r=t&&t.__esModule?function(){return t.default}:function(){return t};return e.d(r,"a",r),r},e.o=function(t,e){return Object.prototype.hasOwnProperty.call(t,e)},e.p="",e(e.s=23)}([function(t,e,r){"use strict";function n(t){if(Array.isArray(t)){for(var e=0,r=Array(t.length);e<t.length;e++)r[e]=t[e];return r}return Array.from(t)}function i(t){return 700*(Math.exp(t/1125)-1)}function o(t){return 1125*Math.log(1+t/700)}e.b=function(t){for(;t%2==0&&t>1;)t/=2;return 1===t},e.a=function(t,e){if("rect"!==e){if(""!==e&&e||(e="hanning"),a[e]||(a[e]={}),!a[e][t.length])try{a[e][t.length]=s[e](t.length)}catch(t){throw new Error("Invalid windowing function")}t=function(t,e){for(var r=[],n=0;n<Math.min(t.length,e.length);n++)r[n]=t[n]*e[n];return r}(t,a[e][t.length])}return t},e.c=function(t,e,r){for(var n=new Float32Array(t),i=0;i<n.length;i++)n[i]=i*e/r,n[i]=13*Math.atan(n[i]/1315.8)+3.5*Math.atan(Math.pow(n[i]/7518,2));return n},e.f=function(t){return Float32Array.from(t)},e.d=function(t,e,r){for(var n=new Float32Array(t+2),s=new Float32Array(t+2),a=e/2,u=o(0),h=(o(a)-u)/(t+1),c=Array(t+2),l=0;l<n.length;l++)n[l]=l*h,s[l]=i(n[l]),c[l]=Math.floor((r+1)*s[l]/e);for(var f=Array(t),p=0;p<f.length;p++){f[p]=Array.apply(null,new Array(r/2+1)).map(Number.prototype.valueOf,0);for(var m=c[p];m<c[p+1];m++)f[p][m]=(m-c[p])/(c[p+1]-c[p]);for(var g=c[p+1];g<c[p+2];g++)f[p][g]=(c[p+2]-g)/(c[p+2]-c[p+1])}return f},e.e=function(t,e,r){var i=arguments.length>3&&void 0!==arguments[3]?arguments[3]:5,o=arguments.length>4&&void 0!==arguments[4]?arguments[4]:2,s=!(arguments.length>5&&void 0!==arguments[5])||arguments[5],a=arguments.length>6&&void 0!==arguments[6]?arguments[6]:440,u=Math.floor(r/2)+1,h=new Array(r).fill(0).map(function(n,i){return t*function(t,e){return Math.log2(16*t/e)}(e*i/r,a)});h[0]=h[1]-1.5*t;var c=h.slice(1).map(function(t,e){return Math.max(t-h[e])},1).concat([1]),l=Math.round(t/2),f=new Array(t).fill(0).map(function(e,r){return h.map(function(e){return(10*t+l+e-r)%t-l})}),p=f.map(function(t,e){return t.map(function(t,r){return Math.exp(-.5*Math.pow(2*f[e][r]/c[r],2))})});if(p=function(t){var e=t[0].map(function(){return 0}),r=t.reduce(function(t,e){return e.forEach(function(e,r){t[r]+=Math.pow(e,2)}),t},e).map(Math.sqrt);return t.map(function(t,e){return t.map(function(t,e){return t/(r[e]||1)})})}(p),o){var m=h.map(function(e){return Math.exp(-.5*Math.pow((e/t-i)/o,2))});p=p.map(function(t){return t.map(function(t,e){return t*m[e]})})}return s&&(p=[].concat(n(p.slice(3)),n(p.slice(0,3)))),p.map(function(t){return t.slice(0,u)})},e.g=function(t,e,r){if(t.length<e)throw new Error("Buffer is too short for frame length");if(r<1)throw new Error("Hop length cannot be less that 1");if(e<1)throw new Error("Frame length cannot be less that 1");var n=1+Math.floor((t.length-e)/r);return new Array(n).fill(0).map(function(n,i){return t.slice(i*r,i*r+e)})};var s=r(25),a={}},function(t,e,r){"use strict";e.a=function(t,e){for(var r=0,n=0,i=0;i<e.length;i++)r+=Math.pow(i,t)*Math.abs(e[i]),n+=e[i];return r/n}},function(t,e,r){"use strict";var n="function"==typeof Symbol&&"symbol"==typeof Symbol.iterator?function(t){return typeof t}:function(t){return t&&"function"==typeof Symbol&&t.constructor===Symbol&&t!==Symbol.prototype?"symbol":typeof t};e.a=function(t){if("object"!==n(t.ampSpectrum)||"object"!==n(t.barkScale))throw new TypeError;var e=new Float32Array(24),r=0,i=t.ampSpectrum,o=new Int32Array(25);o[0]=0;for(var s=t.barkScale[i.length-1]/24,a=1,u=0;u<i.length;u++)for(;t.barkScale[u]>s;)o[a++]=u,s=a*t.barkScale[i.length-1]/24;o[24]=i.length-1;for(var h=0;h<24;h++){for(var c=0,l=o[h];l<o[h+1];l++)c+=i[l];e[h]=Math.pow(c,.23)}for(var f=0;f<e.length;f++)r+=e[f];return{specific:e,total:r}}},function(t,e,r){"use strict";var n="function"==typeof Symbol&&"symbol"==typeof Symbol.iterator?function(t){return typeof t}:function(t){return t&&"function"==typeof Symbol&&t.constructor===Symbol&&t!==Symbol.prototype?"symbol":typeof t};e.a=function(){if("object"!==n(arguments[0].ampSpectrum))throw new TypeError;for(var t=new Float32Array(arguments[0].ampSpectrum.length),e=0;e<t.length;e++)t[e]=Math.pow(arguments[0].ampSpectrum[e],2);return t}},function(t,e,r){"use strict";Object.defineProperty(e,"__esModule",{value:!0}),r.d(e,"buffer",function(){return b}),r.d(e,"complexSpectrum",function(){return x}),r.d(e,"amplitudeSpectrum",function(){return M});var n=r(13),i=r(9),o=r(20),s=r(14),a=r(18),u=r(15),h=r(21),c=r(19),l=r(17),f=r(22),p=r(2),m=r(12),g=r(11),d=r(10),v=r(8),y=r(3),w=r(16);r.d(e,"rms",function(){return n.a}),r.d(e,"energy",function(){return i.a}),r.d(e,"spectralSlope",function(){return o.a}),r.d(e,"spectralCentroid",function(){return s.a}),r.d(e,"spectralRolloff",function(){return a.a}),r.d(e,"spectralFlatness",function(){return u.a}),r.d(e,"spectralSpread",function(){return h.a}),r.d(e,"spectralSkewness",function(){return c.a}),r.d(e,"spectralKurtosis",function(){return l.a}),r.d(e,"zcr",function(){return f.a}),r.d(e,"loudness",function(){return p.a}),r.d(e,"perceptualSpread",function(){return m.a}),r.d(e,"perceptualSharpness",function(){return g.a}),r.d(e,"powerSpectrum",function(){return y.a}),r.d(e,"mfcc",function(){return d.a}),r.d(e,"chroma",function(){return v.a}),r.d(e,"spectralFlux",function(){return w.a});var b=function(t){return t.signal},x=function(t){return t.complexSpectrum},M=function(t){return t.ampSpectrum}},function(t,e){var r;r=function(){return this}();try{r=r||Function("return this")()||(0,eval)("this")}catch(t){"object"==typeof window&&(r=window)}t.exports=r},function(t,e,r){"use strict";Object.defineProperty(e,"__esModule",{value:!0});var n=r(0),i=r(4),o=r(28),s=(r.n(o),r(24)),a="function"==typeof Symbol&&"symbol"==typeof Symbol.iterator?function(t){return typeof t}:function(t){return t&&"function"==typeof Symbol&&t.constructor===Symbol&&t!==Symbol.prototype?"symbol":typeof t},u={audioContext:null,spn:null,bufferSize:512,sampleRate:44100,melBands:26,chromaBands:12,callback:null,windowingFunction:"hanning",featureExtractors:i,EXTRACTION_STARTED:!1,_featuresToExtract:[],windowing:n.a,_errors:{notPow2:new Error("Meyda: Buffer size must be a power of 2, e.g. 64 or 512"),featureUndef:new Error("Meyda: No features defined."),invalidFeatureFmt:new Error("Meyda: Invalid feature format"),invalidInput:new Error("Meyda: Invalid input."),noAC:new Error("Meyda: No AudioContext specified."),noSource:new Error("Meyda: No source node specified.")},createMeydaAnalyzer:function(t){return new s.a(t,u)},extract:function(t,e,r){if(!e)throw this._errors.invalidInput;if("object"!=(void 0===e?"undefined":a(e)))throw this._errors.invalidInput;if(!t)throw this._errors.featureUndef;if(!n.b(e.length))throw this._errors.notPow2;void 0!==this.barkScale&&this.barkScale.length==this.bufferSize||(this.barkScale=n.c(this.bufferSize,this.sampleRate,this.bufferSize)),void 0!==this.melFilterBank&&this.barkScale.length==this.bufferSize&&this.melFilterBank.length==this.melBands||(this.melFilterBank=n.d(this.melBands,this.sampleRate,this.bufferSize)),void 0!==this.chromaFilterBank&&this.chromaFilterBank.length==this.chromaBands||(this.chromaFilterBank=n.e(this.chromaBands,this.sampleRate,this.bufferSize)),void 0===e.buffer?this.signal=n.f(e):this.signal=e;var i=h(e,this.windowingFunction,this.bufferSize);if(this.signal=i.windowedSignal,this.complexSpectrum=i.complexSpectrum,this.ampSpectrum=i.ampSpectrum,r){var o=h(r,this.windowingFunction,this.bufferSize);this.previousSignal=o.windowedSignal,this.previousComplexSpectrum=o.complexSpectrum,this.previousAmpSpectrum=o.ampSpectrum}if("object"===(void 0===t?"undefined":a(t))){for(var s={},u=0;u<t.length;u++)s[t[u]]=this.featureExtractors[t[u]]({ampSpectrum:this.ampSpectrum,chromaFilterBank:this.chromaFilterBank,complexSpectrum:this.complexSpectrum,signal:this.signal,bufferSize:this.bufferSize,sampleRate:this.sampleRate,barkScale:this.barkScale,melFilterBank:this.melFilterBank,previousSignal:this.previousSignal,previousAmpSpectrum:this.previousAmpSpectrum,previousComplexSpectrum:this.previousComplexSpectrum});return s}if("string"==typeof t)return this.featureExtractors[t]({ampSpectrum:this.ampSpectrum,chromaFilterBank:this.chromaFilterBank,complexSpectrum:this.complexSpectrum,signal:this.signal,bufferSize:this.bufferSize,sampleRate:this.sampleRate,barkScale:this.barkScale,melFilterBank:this.melFilterBank,previousSignal:this.previousSignal,previousAmpSpectrum:this.previousAmpSpectrum,previousComplexSpectrum:this.previousComplexSpectrum});throw this._errors.invalidFeatureFmt}},h=function(t,e,i){var s={};void 0===t.buffer?s.signal=n.f(t):s.signal=t,s.windowedSignal=n.a(s.signal,e),s.complexSpectrum=r.i(o.fft)(s.windowedSignal),s.ampSpectrum=new Float32Array(i/2);for(var a=0;a<i/2;a++)s.ampSpectrum[a]=Math.sqrt(Math.pow(s.complexSpectrum.real[a],2)+Math.pow(s.complexSpectrum.imag[a],2));return s};e.default=u,"undefined"!=typeof window&&(window.Meyda=u)},function(t,e,r){"use strict";(function(e){
/*!
 * The buffer module from node.js, for the browser.
 *
 * @author   Feross Aboukhadijeh <feross@feross.org> <http://feross.org>
 * @license  MIT
 */
function n(t,e){if(t===e)return 0;for(var r=t.length,n=e.length,i=0,o=Math.min(r,n);i<o;++i)if(t[i]!==e[i]){r=t[i],n=e[i];break}return r<n?-1:n<r?1:0}function i(t){return e.Buffer&&"function"==typeof e.Buffer.isBuffer?e.Buffer.isBuffer(t):!(null==t||!t._isBuffer)}function o(t){return Object.prototype.toString.call(t)}function s(t){return!i(t)&&"function"==typeof e.ArrayBuffer&&("function"==typeof ArrayBuffer.isView?ArrayBuffer.isView(t):!!t&&(t instanceof DataView||!!(t.buffer&&t.buffer instanceof ArrayBuffer)))}function a(t){if(d.isFunction(t)){if(w)return t.name;var e=t.toString(),r=e.match(x);return r&&r[1]}}function u(t,e){return"string"==typeof t?t.length<e?t:t.slice(0,e):t}function h(t){if(w||!d.isFunction(t))return d.inspect(t);var e=a(t);return"[Function"+(e?": "+e:"")+"]"}function c(t,e,r,n,i){throw new b.AssertionError({message:r,actual:t,expected:e,operator:n,stackStartFunction:i})}function l(t,e){t||c(t,!0,e,"==",b.ok)}function f(t,e,r,a){if(t===e)return!0;if(i(t)&&i(e))return 0===n(t,e);if(d.isDate(t)&&d.isDate(e))return t.getTime()===e.getTime();if(d.isRegExp(t)&&d.isRegExp(e))return t.source===e.source&&t.global===e.global&&t.multiline===e.multiline&&t.lastIndex===e.lastIndex&&t.ignoreCase===e.ignoreCase;if(null!==t&&"object"==typeof t||null!==e&&"object"==typeof e){if(s(t)&&s(e)&&o(t)===o(e)&&!(t instanceof Float32Array||t instanceof Float64Array))return 0===n(new Uint8Array(t.buffer),new Uint8Array(e.buffer));if(i(t)!==i(e))return!1;var u=(a=a||{actual:[],expected:[]}).actual.indexOf(t);return-1!==u&&u===a.expected.indexOf(e)||(a.actual.push(t),a.expected.push(e),function(t,e,r,n){if(null===t||void 0===t||null===e||void 0===e)return!1;if(d.isPrimitive(t)||d.isPrimitive(e))return t===e;if(r&&Object.getPrototypeOf(t)!==Object.getPrototypeOf(e))return!1;var i=p(t),o=p(e);if(i&&!o||!i&&o)return!1;if(i)return t=y.call(t),e=y.call(e),f(t,e,r);var s,a,u=M(t),h=M(e);if(u.length!==h.length)return!1;for(u.sort(),h.sort(),a=u.length-1;a>=0;a--)if(u[a]!==h[a])return!1;for(a=u.length-1;a>=0;a--)if(s=u[a],!f(t[s],e[s],r,n))return!1;return!0}(t,e,r,a))}return r?t===e:t==e}function p(t){return"[object Arguments]"==Object.prototype.toString.call(t)}function m(t,e){if(!t||!e)return!1;if("[object RegExp]"==Object.prototype.toString.call(e))return e.test(t);try{if(t instanceof e)return!0}catch(t){}return!Error.isPrototypeOf(e)&&!0===e.call({},t)}function g(t,e,r,n){var i;if("function"!=typeof e)throw new TypeError('"block" argument must be a function');"string"==typeof r&&(n=r,r=null),i=function(t){var e;try{t()}catch(t){e=t}return e}(e),n=(r&&r.name?" ("+r.name+").":".")+(n?" "+n:"."),t&&!i&&c(i,r,"Missing expected exception"+n);var o="string"==typeof n,s=!t&&d.isError(i),a=!t&&i&&!r;if((s&&o&&m(i,r)||a)&&c(i,r,"Got unwanted exception"+n),t&&i&&r&&!m(i,r)||!t&&i)throw i}var d=r(33),v=Object.prototype.hasOwnProperty,y=Array.prototype.slice,w="foo"===function(){}.name,b=t.exports=l,x=/\s*function\s+([^\(\s]*)\s*/;b.AssertionError=function(t){this.name="AssertionError",this.actual=t.actual,this.expected=t.expected,this.operator=t.operator,t.message?(this.message=t.message,this.generatedMessage=!1):(this.message=function(t){return u(h(t.actual),128)+" "+t.operator+" "+u(h(t.expected),128)}(this),this.generatedMessage=!0);var e=t.stackStartFunction||c;if(Error.captureStackTrace)Error.captureStackTrace(this,e);else{var r=new Error;if(r.stack){var n=r.stack,i=a(e),o=n.indexOf("\n"+i);if(o>=0){var s=n.indexOf("\n",o+1);n=n.substring(s+1)}this.stack=n}}},d.inherits(b.AssertionError,Error),b.fail=c,b.ok=l,b.equal=function(t,e,r){t!=e&&c(t,e,r,"==",b.equal)},b.notEqual=function(t,e,r){t==e&&c(t,e,r,"!=",b.notEqual)},b.deepEqual=function(t,e,r){f(t,e,!1)||c(t,e,r,"deepEqual",b.deepEqual)},b.deepStrictEqual=function(t,e,r){f(t,e,!0)||c(t,e,r,"deepStrictEqual",b.deepStrictEqual)},b.notDeepEqual=function(t,e,r){f(t,e,!1)&&c(t,e,r,"notDeepEqual",b.notDeepEqual)},b.notDeepStrictEqual=function t(e,r,n){f(e,r,!0)&&c(e,r,n,"notDeepStrictEqual",t)},b.strictEqual=function(t,e,r){t!==e&&c(t,e,r,"===",b.strictEqual)},b.notStrictEqual=function(t,e,r){t===e&&c(t,e,r,"!==",b.notStrictEqual)},b.throws=function(t,e,r){g(!0,t,e,r)},b.doesNotThrow=function(t,e,r){g(!1,t,e,r)},b.ifError=function(t){if(t)throw t};var M=Object.keys||function(t){var e=[];for(var r in t)v.call(t,r)&&e.push(r);return e}}).call(e,r(5))},function(t,e,r){"use strict";var n=(r(0),"function"==typeof Symbol&&"symbol"==typeof Symbol.iterator?function(t){return typeof t}:function(t){return t&&"function"==typeof Symbol&&t.constructor===Symbol&&t!==Symbol.prototype?"symbol":typeof t});e.a=function(t){if("object"!==n(t.ampSpectrum))throw new TypeError("Valid ampSpectrum is required to generate chroma");if("object"!==n(t.chromaFilterBank))throw new TypeError("Valid chromaFilterBank is required to generate chroma");var e=t.chromaFilterBank.map(function(e,r){return t.ampSpectrum.reduce(function(t,r,n){return t+r*e[n]},0)}),r=Math.max.apply(Math,function(t){if(Array.isArray(t)){for(var e=0,r=Array(t.length);e<t.length;e++)r[e]=t[e];return r}return Array.from(t)}(e));return r?e.map(function(t){return t/r}):e}},function(t,e,r){"use strict";var n=r(7),i=(r.n(n),"function"==typeof Symbol&&"symbol"==typeof Symbol.iterator?function(t){return typeof t}:function(t){return t&&"function"==typeof Symbol&&t.constructor===Symbol&&t!==Symbol.prototype?"symbol":typeof t});e.a=function(){if("object"!==i(arguments[0].signal))throw new TypeError;for(var t=0,e=0;e<arguments[0].signal.length;e++)t+=Math.pow(Math.abs(arguments[0].signal[e]),2);return t}},function(t,e,r){"use strict";var n=r(3),i=(r(0),"function"==typeof Symbol&&"symbol"==typeof Symbol.iterator?function(t){return typeof t}:function(t){return t&&"function"==typeof Symbol&&t.constructor===Symbol&&t!==Symbol.prototype?"symbol":typeof t}),o=r(26);e.a=function(t){if("object"!==i(t.ampSpectrum))throw new TypeError("Valid ampSpectrum is required to generate MFCC");if("object"!==i(t.melFilterBank))throw new TypeError("Valid melFilterBank is required to generate MFCC");for(var e=r.i(n.a)(t),s=t.melFilterBank.length,a=Array(s),u=new Float32Array(s),h=0;h<u.length;h++){a[h]=new Float32Array(t.bufferSize/2),u[h]=0;for(var c=0;c<t.bufferSize/2;c++)a[h][c]=t.melFilterBank[h][c]*e[c],u[h]+=a[h][c];u[h]=Math.log(u[h]+1)}var l=Array.prototype.slice.call(u);return o(l).slice(0,13)}},function(t,e,r){"use strict";var n=r(2),i="function"==typeof Symbol&&"symbol"==typeof Symbol.iterator?function(t){return typeof t}:function(t){return t&&"function"==typeof Symbol&&t.constructor===Symbol&&t!==Symbol.prototype?"symbol":typeof t};e.a=function(){if("object"!==i(arguments[0].signal))throw new TypeError;for(var t=r.i(n.a)(arguments[0]),e=t.specific,o=0,s=0;s<e.length;s++)o+=s<15?(s+1)*e[s+1]:.066*Math.exp(.171*(s+1));return o*=.11/t.total}},function(t,e,r){"use strict";var n=r(2),i="function"==typeof Symbol&&"symbol"==typeof Symbol.iterator?function(t){return typeof t}:function(t){return t&&"function"==typeof Symbol&&t.constructor===Symbol&&t!==Symbol.prototype?"symbol":typeof t};e.a=function(){if("object"!==i(arguments[0].signal))throw new TypeError;for(var t=r.i(n.a)(arguments[0]),e=0,o=0;o<t.specific.length;o++)t.specific[o]>e&&(e=t.specific[o]);return Math.pow((t.total-e)/t.total,2)}},function(t,e,r){"use strict";var n="function"==typeof Symbol&&"symbol"==typeof Symbol.iterator?function(t){return typeof t}:function(t){return t&&"function"==typeof Symbol&&t.constructor===Symbol&&t!==Symbol.prototype?"symbol":typeof t};e.a=function(t){if("object"!==n(t.signal))throw new TypeError;for(var e=0,r=0;r<t.signal.length;r++)e+=Math.pow(t.signal[r],2);return e/=t.signal.length,e=Math.sqrt(e)}},function(t,e,r){"use strict";var n=r(1),i="function"==typeof Symbol&&"symbol"==typeof Symbol.iterator?function(t){return typeof t}:function(t){return t&&"function"==typeof Symbol&&t.constructor===Symbol&&t!==Symbol.prototype?"symbol":typeof t};e.a=function(){if("object"!==i(arguments[0].ampSpectrum))throw new TypeError;return r.i(n.a)(1,arguments[0].ampSpectrum)}},function(t,e,r){"use strict";var n="function"==typeof Symbol&&"symbol"==typeof Symbol.iterator?function(t){return typeof t}:function(t){return t&&"function"==typeof Symbol&&t.constructor===Symbol&&t!==Symbol.prototype?"symbol":typeof t};e.a=function(){if("object"!==n(arguments[0].ampSpectrum))throw new TypeError;for(var t=0,e=0,r=0;r<arguments[0].ampSpectrum.length;r++)t+=Math.log(arguments[0].ampSpectrum[r]),e+=arguments[0].ampSpectrum[r];return Math.exp(t/arguments[0].ampSpectrum.length)*arguments[0].ampSpectrum.length/e}},function(t,e,r){"use strict";var n="function"==typeof Symbol&&"symbol"==typeof Symbol.iterator?function(t){return typeof t}:function(t){return t&&"function"==typeof Symbol&&t.constructor===Symbol&&t!==Symbol.prototype?"symbol":typeof t};e.a=function(t){if("object"!==n(t.signal)||"object"!=n(t.previousSignal))throw new TypeError;for(var e=0,r=-t.bufferSize/2;r<signal.length/2-1;r++)x=Math.abs(t.signal[r])-Math.abs(t.previousSignal[r]),e+=(x+Math.abs(x))/2;return e}},function(t,e,r){"use strict";var n=r(1),i="function"==typeof Symbol&&"symbol"==typeof Symbol.iterator?function(t){return typeof t}:function(t){return t&&"function"==typeof Symbol&&t.constructor===Symbol&&t!==Symbol.prototype?"symbol":typeof t};e.a=function(){if("object"!==i(arguments[0].ampSpectrum))throw new TypeError;var t=arguments[0].ampSpectrum,e=r.i(n.a)(1,t),o=r.i(n.a)(2,t),s=r.i(n.a)(3,t),a=r.i(n.a)(4,t);return(-3*Math.pow(e,4)+6*e*o-4*e*s+a)/Math.pow(Math.sqrt(o-Math.pow(e,2)),4)}},function(t,e,r){"use strict";var n="function"==typeof Symbol&&"symbol"==typeof Symbol.iterator?function(t){return typeof t}:function(t){return t&&"function"==typeof Symbol&&t.constructor===Symbol&&t!==Symbol.prototype?"symbol":typeof t};e.a=function(){if("object"!==n(arguments[0].ampSpectrum))throw new TypeError;for(var t=arguments[0].ampSpectrum,e=arguments[0].sampleRate/(2*(t.length-1)),r=0,i=0;i<t.length;i++)r+=t[i];for(var o=.99*r,s=t.length-1;r>o&&s>=0;)r-=t[s],--s;return(s+1)*e}},function(t,e,r){"use strict";var n=r(1),i="function"==typeof Symbol&&"symbol"==typeof Symbol.iterator?function(t){return typeof t}:function(t){return t&&"function"==typeof Symbol&&t.constructor===Symbol&&t!==Symbol.prototype?"symbol":typeof t};e.a=function(t){if("object"!==i(t.ampSpectrum))throw new TypeError;var e=r.i(n.a)(1,t.ampSpectrum),o=r.i(n.a)(2,t.ampSpectrum),s=r.i(n.a)(3,t.ampSpectrum);return(2*Math.pow(e,3)-3*e*o+s)/Math.pow(Math.sqrt(o-Math.pow(e,2)),3)}},function(t,e,r){"use strict";var n="function"==typeof Symbol&&"symbol"==typeof Symbol.iterator?function(t){return typeof t}:function(t){return t&&"function"==typeof Symbol&&t.constructor===Symbol&&t!==Symbol.prototype?"symbol":typeof t};e.a=function(t){if("object"!==n(t.ampSpectrum))throw new TypeError;for(var e=0,r=0,i=new Float32Array(t.ampSpectrum.length),o=0,s=0,a=0;a<t.ampSpectrum.length;a++){e+=t.ampSpectrum[a];var u=a*t.sampleRate/t.bufferSize;i[a]=u,o+=u*u,r+=u,s+=u*t.ampSpectrum[a]}return(t.ampSpectrum.length*s-r*e)/(e*(o-Math.pow(r,2)))}},function(t,e,r){"use strict";var n=r(1),i="function"==typeof Symbol&&"symbol"==typeof Symbol.iterator?function(t){return typeof t}:function(t){return t&&"function"==typeof Symbol&&t.constructor===Symbol&&t!==Symbol.prototype?"symbol":typeof t};e.a=function(t){if("object"!==i(t.ampSpectrum))throw new TypeError;return Math.sqrt(r.i(n.a)(2,t.ampSpectrum)-Math.pow(r.i(n.a)(1,t.ampSpectrum),2))}},function(t,e,r){"use strict";var n="function"==typeof Symbol&&"symbol"==typeof Symbol.iterator?function(t){return typeof t}:function(t){return t&&"function"==typeof Symbol&&t.constructor===Symbol&&t!==Symbol.prototype?"symbol":typeof t};e.a=function(){if("object"!==n(arguments[0].signal))throw new TypeError;for(var t=0,e=0;e<arguments[0].signal.length;e++)(arguments[0].signal[e]>=0&&arguments[0].signal[e+1]<0||arguments[0].signal[e]<0&&arguments[0].signal[e+1]>=0)&&t++;return t}},function(t,e,r){t.exports=r(6).default},function(t,e,r){"use strict";r.d(e,"a",function(){return s});var n=r(0),i=r(4),o=function(){function t(t,e){for(var r=0;r<e.length;r++){var n=e[r];n.enumerable=n.enumerable||!1,n.configurable=!0,"value"in n&&(n.writable=!0),Object.defineProperty(t,n.key,n)}}return function(e,r,n){return r&&t(e.prototype,r),n&&t(e,n),e}}(),s=function(){function t(e,r){var o=this;if(function(t,e){if(!(t instanceof e))throw new TypeError("Cannot call a class as a function")}(this,t),this._m=r,!e.audioContext)throw this._m.errors.noAC;if(e.bufferSize&&!n.b(e.bufferSize))throw this._m._errors.notPow2;if(!e.source)throw this._m._errors.noSource;this._m.audioContext=e.audioContext,this._m.bufferSize=e.bufferSize||this._m.bufferSize||256,this._m.hopSize=e.hopSize||this._m.hopSize||this._m.bufferSize,this._m.sampleRate=e.sampleRate||this._m.audioContext.sampleRate||44100,this._m.callback=e.callback,this._m.windowingFunction=e.windowingFunction||"hanning",this._m.featureExtractors=i,this._m.EXTRACTION_STARTED=e.startImmediately||!1,this._m.spn=this._m.audioContext.createScriptProcessor(this._m.bufferSize,1,1),this._m.spn.connect(this._m.audioContext.destination),this._m._featuresToExtract=e.featureExtractors||[],this._m.barkScale=n.c(this._m.bufferSize,this._m.sampleRate,this._m.bufferSize),this._m.melFilterBank=n.d(this._m.melBands,this._m.sampleRate,this._m.bufferSize),this._m.inputData=null,this._m.previousInputData=null,this._m.frame=null,this._m.previousFrame=null,this.setSource(e.source),this._m.spn.onaudioprocess=function(t){if(null!==o._m.inputData&&(o._m.previousInputData=o._m.inputData),o._m.inputData=t.inputBuffer.getChannelData(0),o._m.previousInputData){var e=new Float32Array(o._m.previousInputData.length+o._m.inputData.length-o._m.hopSize);e.set(o._m.previousInputData.slice(o._m.hopSize)),e.set(o._m.inputData,o._m.previousInputData.length-o._m.hopSize)}else var e=o._m.inputData;n.g(e,o._m.bufferSize,o._m.hopSize).forEach(function(t){o._m.frame=t;var e=o._m.extract(o._m._featuresToExtract,o._m.frame,o._m.previousFrame);"function"==typeof o._m.callback&&o._m.EXTRACTION_STARTED&&o._m.callback(e),o._m.previousFrame=o._m.frame})}}return o(t,[{key:"start",value:function(t){this._m._featuresToExtract=t||this._m._featuresToExtract,this._m.EXTRACTION_STARTED=!0}},{key:"stop",value:function(){this._m.EXTRACTION_STARTED=!1}},{key:"setSource",value:function(t){t.connect(this._m.spn)}},{key:"get",value:function(t){return this._m.inputData?this._m.extract(t||this._m._featuresToExtract,this._m.inputData,this._m.previousInputData):null}}]),t}()},function(t,e,r){"use strict";Object.defineProperty(e,"__esModule",{value:!0}),e.blackman=function(t){for(var e=new Float32Array(t),r=2*Math.PI/(t-1),n=2*r,i=0;i<t/2;i++)e[i]=.42-.5*Math.cos(i*r)+.08*Math.cos(i*n);for(var o=t/2;o>0;o--)e[t-o]=e[o-1];return e},e.sine=function(t){for(var e=Math.PI/(t-1),r=new Float32Array(t),n=0;n<t;n++)r[n]=Math.sin(e*n);return r},e.hanning=function(t){for(var e=new Float32Array(t),r=0;r<t;r++)e[r]=.5-.5*Math.cos(2*Math.PI*r/(t-1));return e},e.hamming=function(t){for(var e=new Float32Array(t),r=0;r<t;r++)e[r]=.54-.46*Math.cos(2*Math.PI*(r/t-1));return e}},function(t,e,r){t.exports=r(27)},function(t,e){cosMap=null;var r=function(t){cosMap=cosMap||{},cosMap[t]=new Array(t*t);for(var e=Math.PI/t,r=0;r<t;r++)for(var n=0;n<t;n++)cosMap[t][n+r*t]=Math.cos(e*(n+.5)*r)};t.exports=function(t,e){var n=t.length;return e=e||2,cosMap&&cosMap[n]||r(n),t.map(function(){return 0}).map(function(r,i){return e*t.reduce(function(t,e,r,o){return t+e*cosMap[n][r+i*n]},0)})}},function(t,e,r){"use strict";var n=r(29),i=function(t){var e={};void 0===t.real||void 0===t.imag?e=n.constructComplexArray(t):(e.real=t.real.slice(),e.imag=t.imag.slice());var r=e.real.length,i=Math.log2(r);if(Math.round(i)!=i)throw new Error("Input size must be a power of 2.");if(e.real.length!=e.imag.length)throw new Error("Real and imaginary components must have the same length.");for(var o=n.bitReverseArray(r),s={real:[],imag:[]},a=0;a<r;a++)s.real[o[a]]=e.real[a],s.imag[o[a]]=e.imag[a];for(var u=0;u<r;u++)e.real[u]=s.real[u],e.imag[u]=s.imag[u];for(var h=1;h<=i;h++)for(var c=Math.pow(2,h),l=0;l<c/2;l++)for(var f=n.euler(l,c),p=0;p<r/c;p++){var m=c*p+l,g=c*p+l+c/2,d={real:e.real[m],imag:e.imag[m]},v={real:e.real[g],imag:e.imag[g]},y=n.multiply(f,v),w=n.subtract(d,y);e.real[g]=w.real,e.imag[g]=w.imag;var b=n.add(y,d);e.real[m]=b.real,e.imag[m]=b.imag}return e};t.exports={fft:i,ifft:function(t){if(void 0===t.real||void 0===t.imag)throw new Error("IFFT only accepts a complex input.");for(var e=t.real.length,r={real:[],imag:[]},o=0;o<e;o++){var s={real:t.real[o],imag:t.imag[o]},a=n.conj(s);r.real[o]=a.real,r.imag[o]=a.imag}var u=i(r);return r.real=u.real.map(function(t){return t/e}),r.imag=u.imag.map(function(t){return t/e}),r}}},function(t,e,r){"use strict";function n(t){if(Array.isArray(t)){for(var e=0,r=Array(t.length);e<t.length;e++)r[e]=t[e];return r}return Array.from(t)}var i={},o={};t.exports={bitReverseArray:function(t){if(void 0===i[t]){for(var e=(t-1).toString(2).length,r="0".repeat(e),o={},s=0;s<t;s++){var a=s.toString(2);a=r.substr(a.length)+a,a=[].concat(n(a)).reverse().join(""),o[s]=parseInt(a,2)}i[t]=o}return i[t]},multiply:function(t,e){return{real:t.real*e.real-t.imag*e.imag,imag:t.real*e.imag+t.imag*e.real}},add:function(t,e){return{real:t.real+e.real,imag:t.imag+e.imag}},subtract:function(t,e){return{real:t.real-e.real,imag:t.imag-e.imag}},euler:function(t,e){var r=-2*Math.PI*t/e;return{real:Math.cos(r),imag:Math.sin(r)}},conj:function(t){return t.imag*=-1,t},constructComplexArray:function(t){var e={};e.real=void 0===t.real?t.slice():t.real.slice();var r=e.real.length;return void 0===o[r]&&(o[r]=Array.apply(null,Array(r)).map(Number.prototype.valueOf,0)),e.imag=o[r].slice(),e}}},function(t,e){function r(){throw new Error("setTimeout has not been defined")}function n(){throw new Error("clearTimeout has not been defined")}function i(t){if(h===setTimeout)return setTimeout(t,0);if((h===r||!h)&&setTimeout)return h=setTimeout,setTimeout(t,0);try{return h(t,0)}catch(e){try{return h.call(null,t,0)}catch(e){return h.call(this,t,0)}}}function o(){m&&f&&(m=!1,f.length?p=f.concat(p):g=-1,p.length&&s())}function s(){if(!m){var t=i(o);m=!0;for(var e=p.length;e;){for(f=p,p=[];++g<e;)f&&f[g].run();g=-1,e=p.length}f=null,m=!1,function(t){if(c===clearTimeout)return clearTimeout(t);if((c===n||!c)&&clearTimeout)return c=clearTimeout,clearTimeout(t);try{c(t)}catch(e){try{return c.call(null,t)}catch(e){return c.call(this,t)}}}(t)}}function a(t,e){this.fun=t,this.array=e}function u(){}var h,c,l=t.exports={};!function(){try{h="function"==typeof setTimeout?setTimeout:r}catch(t){h=r}try{c="function"==typeof clearTimeout?clearTimeout:n}catch(t){c=n}}();var f,p=[],m=!1,g=-1;l.nextTick=function(t){var e=new Array(arguments.length-1);if(arguments.length>1)for(var r=1;r<arguments.length;r++)e[r-1]=arguments[r];p.push(new a(t,e)),1!==p.length||m||i(s)},a.prototype.run=function(){this.fun.apply(null,this.array)},l.title="browser",l.browser=!0,l.env={},l.argv=[],l.version="",l.versions={},l.on=u,l.addListener=u,l.once=u,l.off=u,l.removeListener=u,l.removeAllListeners=u,l.emit=u,l.prependListener=u,l.prependOnceListener=u,l.listeners=function(t){return[]},l.binding=function(t){throw new Error("process.binding is not supported")},l.cwd=function(){return"/"},l.chdir=function(t){throw new Error("process.chdir is not supported")},l.umask=function(){return 0}},function(t,e){"function"==typeof Object.create?t.exports=function(t,e){t.super_=e,t.prototype=Object.create(e.prototype,{constructor:{value:t,enumerable:!1,writable:!0,configurable:!0}})}:t.exports=function(t,e){t.super_=e;var r=function(){};r.prototype=e.prototype,t.prototype=new r,t.prototype.constructor=t}},function(t,e){t.exports=function(t){return t&&"object"==typeof t&&"function"==typeof t.copy&&"function"==typeof t.fill&&"function"==typeof t.readUInt8}},function(t,e,r){(function(t,n){function i(t,r){var n={seen:[],stylize:s};return arguments.length>=3&&(n.depth=arguments[2]),arguments.length>=4&&(n.colors=arguments[3]),f(r)?n.showHidden=r:r&&e._extend(n,r),d(n.showHidden)&&(n.showHidden=!1),d(n.depth)&&(n.depth=2),d(n.colors)&&(n.colors=!1),d(n.customInspect)&&(n.customInspect=!0),n.colors&&(n.stylize=o),a(n,t,n.depth)}function o(t,e){var r=i.styles[e];return r?"["+i.colors[r][0]+"m"+t+"["+i.colors[r][1]+"m":t}function s(t,e){return t}function a(t,r,n){if(t.customInspect&&r&&x(r.inspect)&&r.inspect!==e.inspect&&(!r.constructor||r.constructor.prototype!==r)){var i=r.inspect(n,t);return g(i)||(i=a(t,i,n)),i}var o=u(t,r);if(o)return o;var s=Object.keys(r),f=function(t){var e={};return t.forEach(function(t,r){e[t]=!0}),e}(s);if(t.showHidden&&(s=Object.getOwnPropertyNames(r)),b(r)&&(s.indexOf("message")>=0||s.indexOf("description")>=0))return h(r);if(0===s.length){if(x(r)){var p=r.name?": "+r.name:"";return t.stylize("[Function"+p+"]","special")}if(v(r))return t.stylize(RegExp.prototype.toString.call(r),"regexp");if(w(r))return t.stylize(Date.prototype.toString.call(r),"date");if(b(r))return h(r)}var m,d="",y=!1,M=["{","}"];return l(r)&&(y=!0,M=["[","]"]),x(r)&&(d=" [Function"+(r.name?": "+r.name:"")+"]"),v(r)&&(d=" "+RegExp.prototype.toString.call(r)),w(r)&&(d=" "+Date.prototype.toUTCString.call(r)),b(r)&&(d=" "+h(r)),0!==s.length||y&&0!=r.length?n<0?v(r)?t.stylize(RegExp.prototype.toString.call(r),"regexp"):t.stylize("[Object]","special"):(t.seen.push(r),m=y?function(t,e,r,n,i){for(var o=[],s=0,a=e.length;s<a;++s)A(e,String(s))?o.push(c(t,e,r,n,String(s),!0)):o.push("");return i.forEach(function(i){i.match(/^\d+$/)||o.push(c(t,e,r,n,i,!0))}),o}(t,r,n,f,s):s.map(function(e){return c(t,r,n,f,e,y)}),t.seen.pop(),function(t,e,r){return t.reduce(function(t,e){return e.indexOf("\n"),t+e.replace(/\u001b\[\d\d?m/g,"").length+1},0)>60?r[0]+(""===e?"":e+"\n ")+" "+t.join(",\n  ")+" "+r[1]:r[0]+e+" "+t.join(", ")+" "+r[1]}(m,d,M)):M[0]+d+M[1]}function u(t,e){if(d(e))return t.stylize("undefined","undefined");if(g(e)){var r="'"+JSON.stringify(e).replace(/^"|"$/g,"").replace(/'/g,"\\'").replace(/\\"/g,'"')+"'";return t.stylize(r,"string")}return m(e)?t.stylize(""+e,"number"):f(e)?t.stylize(""+e,"boolean"):p(e)?t.stylize("null","null"):void 0}function h(t){return"["+Error.prototype.toString.call(t)+"]"}function c(t,e,r,n,i,o){var s,u,h;if((h=Object.getOwnPropertyDescriptor(e,i)||{value:e[i]}).get?u=h.set?t.stylize("[Getter/Setter]","special"):t.stylize("[Getter]","special"):h.set&&(u=t.stylize("[Setter]","special")),A(n,i)||(s="["+i+"]"),u||(t.seen.indexOf(h.value)<0?(u=p(r)?a(t,h.value,null):a(t,h.value,r-1)).indexOf("\n")>-1&&(u=o?u.split("\n").map(function(t){return"  "+t}).join("\n").substr(2):"\n"+u.split("\n").map(function(t){return"   "+t}).join("\n")):u=t.stylize("[Circular]","special")),d(s)){if(o&&i.match(/^\d+$/))return u;(s=JSON.stringify(""+i)).match(/^"([a-zA-Z_][a-zA-Z_0-9]*)"$/)?(s=s.substr(1,s.length-2),s=t.stylize(s,"name")):(s=s.replace(/'/g,"\\'").replace(/\\"/g,'"').replace(/(^"|"$)/g,"'"),s=t.stylize(s,"string"))}return s+": "+u}function l(t){return Array.isArray(t)}function f(t){return"boolean"==typeof t}function p(t){return null===t}function m(t){return"number"==typeof t}function g(t){return"string"==typeof t}function d(t){return void 0===t}function v(t){return y(t)&&"[object RegExp]"===M(t)}function y(t){return"object"==typeof t&&null!==t}function w(t){return y(t)&&"[object Date]"===M(t)}function b(t){return y(t)&&("[object Error]"===M(t)||t instanceof Error)}function x(t){return"function"==typeof t}function M(t){return Object.prototype.toString.call(t)}function S(t){return t<10?"0"+t.toString(10):t.toString(10)}function A(t,e){return Object.prototype.hasOwnProperty.call(t,e)}var E=/%[sdj%]/g;e.format=function(t){if(!g(t)){for(var e=[],r=0;r<arguments.length;r++)e.push(i(arguments[r]));return e.join(" ")}for(var r=1,n=arguments,o=n.length,s=String(t).replace(E,function(t){if("%%"===t)return"%";if(r>=o)return t;switch(t){case"%s":return String(n[r++]);case"%d":return Number(n[r++]);case"%j":try{return JSON.stringify(n[r++])}catch(t){return"[Circular]"}default:return t}}),a=n[r];r<o;a=n[++r])p(a)||!y(a)?s+=" "+a:s+=" "+i(a);return s},e.deprecate=function(r,i){if(d(t.process))return function(){return e.deprecate(r,i).apply(this,arguments)};if(!0===n.noDeprecation)return r;var o=!1;return function(){if(!o){if(n.throwDeprecation)throw new Error(i);n.traceDeprecation?console.trace(i):console.error(i),o=!0}return r.apply(this,arguments)}};var _,k={};e.debuglog=function(t){if(d(_)&&(_=n.env.NODE_DEBUG||""),t=t.toUpperCase(),!k[t])if(new RegExp("\\b"+t+"\\b","i").test(_)){var r=n.pid;k[t]=function(){var n=e.format.apply(e,arguments);console.error("%s %d: %s",t,r,n)}}else k[t]=function(){};return k[t]},e.inspect=i,i.colors={bold:[1,22],italic:[3,23],underline:[4,24],inverse:[7,27],white:[37,39],grey:[90,39],black:[30,39],blue:[34,39],cyan:[36,39],green:[32,39],magenta:[35,39],red:[31,39],yellow:[33,39]},i.styles={special:"cyan",number:"yellow",boolean:"yellow",undefined:"grey",null:"bold",string:"green",date:"magenta",regexp:"red"},e.isArray=l,e.isBoolean=f,e.isNull=p,e.isNullOrUndefined=function(t){return null==t},e.isNumber=m,e.isString=g,e.isSymbol=function(t){return"symbol"==typeof t},e.isUndefined=d,e.isRegExp=v,e.isObject=y,e.isDate=w,e.isError=b,e.isFunction=x,e.isPrimitive=function(t){return null===t||"boolean"==typeof t||"number"==typeof t||"string"==typeof t||"symbol"==typeof t||void 0===t},e.isBuffer=r(32);var R=["Jan","Feb","Mar","Apr","May","Jun","Jul","Aug","Sep","Oct","Nov","Dec"];e.log=function(){console.log("%s - %s",function(){var t=new Date,e=[S(t.getHours()),S(t.getMinutes()),S(t.getSeconds())].join(":");return[t.getDate(),R[t.getMonth()],e].join(" ")}(),e.format.apply(e,arguments))},e.inherits=r(31),e._extend=function(t,e){if(!e||!y(e))return t;for(var r=Object.keys(e),n=r.length;n--;)t[r[n]]=e[r[n]];return t}}).call(e,r(5),r(30))}])},function(t,e,r){"use strict";Object.defineProperty(e,"__esModule",{value:!0});var n,i=r(21),o=r(255),s=.4,a=.4,u=0,h=100,c=36,l=1/8;e.analyze=//!? should take smaller value
function(t,e,r,f){if(n&&n.sampleRate==f||(n=new o.AudioAnalyzer(f)),"beatbox"==e){void 0===r&&(r=i.Utils.linToDb(a/4));var p=function(t,e,r,i){var o="beatbox"==e?256:1024,s=n.extractSlices(t,r,o);return s.forEach(function(t){t.pos=(t.a1+t.n1)/i}),s}(t,e,r,f);return p.forEach(function(t){return n.extractFeatures(t)}),function(t,e){var r=n.buildClusters(e,{alg:"kmeans",k:t}),i=r.clusters,o=r.labels;if(i){var s=[];if(o){for(var a=0;a<i.length;a++){var u=i[a];s[a]=[];for(var h=0;h<u.length;h++){var c=e[u[h]];c.cluster=o[a],s[a][h]=c}u.icluster=o[a]}console.log("using trained model")}else{i=function(t,e){function r(e){for(var r=0;r<t.length;r++)for(var n=t[r],i=0;i<n.length;i++)if(n[i]==e)return r;return-1}if(e.length>0){var n=[],i=r(0),o=r(1);if(i>=0){n.push(t[i]),o>=0&&o!=i&&n.push(t[o]);for(var s=0;s<t.length;s++)s!=i&&s!=o&&n.push(t[s]);return n}}return t}(i,e);for(var a=0;a<i.length;a++){var u=i[a];s[a]=[];for(var h=0;h<u.length;h++){var c=e[u[h]];c.cluster=5*a%12,s[a][h]=c}u.icluster=5*a%12}}}}(u,p),p.map(function(t){return{position:t.pos,length:.25,key:t.cluster+c,velocity:h}})}if("hum"==e)return n.extractNotes(t,h),function(t){return n.adjustNotes(s,l).map(function(e){return{position:e.startSample/t,length:e.durationSamples/t,key:e.noteNumber,velocity:e.velocity}})}(f);throw"unknown mode"}},function(t,e,r){"use strict";var n=this&&this.__awaiter||function(t,e,r,n){return new(r||(r=Promise))(function(i,o){function s(t){try{u(n.next(t))}catch(t){o(t)}}function a(t){try{u(n.throw(t))}catch(t){o(t)}}function u(t){t.done?i(t.value):new r(function(e){e(t.value)}).then(s,a)}u((n=n.apply(t,e||[])).next())})},i=this&&this.__generator||function(t,e){var r,n,i,o,s={label:0,sent:function(){if(1&i[0])throw i[1];return i[1]},trys:[],ops:[]};return o={next:a(0),throw:a(1),return:a(2)},"function"==typeof Symbol&&(o[Symbol.iterator]=function(){return this}),o;function a(o){return function(a){return function(o){if(r)throw new TypeError("Generator is already executing.");for(;s;)try{if(r=1,n&&(i=2&o[0]?n.return:o[0]?n.throw||((i=n.return)&&i.call(n),0):n.next)&&!(i=i.call(n,o[1])).done)return i;switch(n=0,i&&(o=[2&o[0],i.value]),o[0]){case 0:case 1:i=o;break;case 4:return s.label++,{value:o[1],done:!1};case 5:s.label++,n=o[1],o=[0];continue;case 7:o=s.ops.pop(),s.trys.pop();continue;default:if(!(i=(i=s.trys).length>0&&i[i.length-1])&&(6===o[0]||2===o[0])){s=0;continue}if(3===o[0]&&(!i||o[1]>i[0]&&o[1]<i[3])){s.label=o[1];break}if(6===o[0]&&s.label<i[1]){s.label=i[1],i=o;break}if(i&&s.label<i[2]){s.label=i[2],s.ops.push(o);break}i[2]&&s.ops.pop(),s.trys.pop();continue}o=e.call(t,s)}catch(t){o=[6,t],n=0}finally{r=i=0}if(5&o[0])throw o[1];return{value:o[0]?o[1]:void 0,done:!0}}([o,a])}}};Object.defineProperty(e,"__esModule",{value:!0});var o=r(259),s=r(64);r(63).initWorker("midi-detection",function(t){return n(this,void 0,void 0,function(){return i(this,function(e){switch(e.label){case 0:switch(t.command){case"detect-midi":return[3,1];case"cancel-task":return[3,3]}return[3,4];case 1:return[4,a.defer(function(){return e=t.settings,r=t.audioData,o.analyze(function(t,e,r){var n=r.sharedChannels,i=Math.round(t*r.sampleRate),o=Math.min(Math.round(e*r.sampleRate),n[0].length),s=o-i;if(1==n.length&&n[0].length==s)return n[0];for(var a=new Float32Array(s),u=function(t){var e=0;n.forEach(function(r){return e+=r[t]}),e/=n.length,a[t-i]=e},h=i;h<o;h++)u(h);return a}(e.start,e.end,r),e.mode,e.threshold,r.sampleRate);var e,r},t.taskId)];case 2:return[2,[{notes:e.sent()},[]]];case 3:return a.remove(t.taskId),[2];case 4:return[2]}})})});var a=new s.TaskQueue}]);